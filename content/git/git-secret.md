[ğŸ  é¦–é¡µ](../_index.md) / [Git](_index.md) / ä½¿ç”¨ git-secret ä¿æŠ¤ä»“åº“æ•æ„Ÿæ•°æ®

# ä½¿ç”¨ git-secret ä¿æŠ¤ä»“åº“æ•æ„Ÿæ•°æ®

å¦‚ä½•ä¿æŠ¤ git ä»“åº“ä¸­çš„æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œè´¦å·å¯†ç ç­‰ï¼Ÿ

é¦–å…ˆï¼Œæœ€å¥½å…ˆå°†ä»“åº“è®¾ç½®æˆç§æœ‰ä»“åº“ï¼ç„¶åï¼Œ

* ç¬¬ä¸€ç§æ–¹å¼ï¼šå¸¦æœ‰æ•æ„Ÿæ•°æ®çš„æ–‡ä»¶åŠ å…¥åˆ°. gitignoreï¼Œä¸æäº¤åˆ°ä»“åº“ä¸­ï¼›
* ç¬¬äºŒç§æ–¹å¼ï¼šæ•æ„Ÿæ•°æ®åº“æ–‡ä»¶åŠ å¯†åå†æäº¤åˆ°ä»“åº“ä¸­ï¼Œè¿™ä¸ªå°±æ˜¯ä»Šå¤©è¦è¯´çš„ **git-secret**ã€‚

è¿™ä¸¤ç§æ–¹å¼éƒ½æœ‰ä¼˜ç¼ºç‚¹ï¼š

ç¬¬ä¸€ç§æ–¹å¼ï¼Œè¾ƒä¸ºé è°±ï¼Œæ•æ„Ÿæ–‡ä»¶åœ¨ git ä»“åº“ä¹‹å¤–ï¼Œæ ¹æœ¬ä¸Šé¿å…ä»“åº“æ•æ„Ÿæ•°æ®çš„æ³„éœ²ï¼Œä½†æ˜¯æ•æ„Ÿæ–‡ä»¶ä¸å—ç‰ˆæœ¬æ§åˆ¶äº†ï¼Œå¼€å‘äººå‘˜éœ€è¦åœ¨å…¶ä»–é¢‘é“åŒæ­¥æ•æ„Ÿæ–‡ä»¶çš„æ›´æ–°ï¼Œè€Œä¸”ä½¿ç”¨åˆ°è‡ªåŠ¨éƒ¨ç½²æ—¶éœ€è¦å¦å¤–å»æ‹‰å–æ•æ„Ÿæ•°æ®ï¼Œæœ€å¥½æ˜¯æœ‰è‡ªå·±çš„æ•æ„Ÿæ•°æ®é…ç½®ä¸­å¿ƒç»Ÿä¸€ç®¡ç†ï¼›

ç¬¬äºŒç§æ–¹å¼ï¼Œä½¿ç”¨ git-secret åŠ å¯†æ•æ„Ÿæ–‡ä»¶ï¼Œè¿™æ ·æ•æ„Ÿæ–‡ä»¶è¢«ä»“åº“ ignore æ‰ï¼Œè½¬è€Œæäº¤åŠ å¯†åçš„æ–‡ä»¶ï¼Œä½†æ˜¯æ•æ„Ÿæ–‡ä»¶å¦‚æœæ›´æ–°äº†å¼€å‘äººå‘˜è¦è®°å¾—å†æ¬¡åŠ å¯†ã€‚

## **git-secret ç®€ä»‹**

git-secret æ˜¯ä¸€ä¸ªåœ¨ git ä»“åº“ä¸­åŠ å¯†æ–‡ä»¶çš„å·¥å…·ï¼Œå°†æ•æ„Ÿæ–‡ä»¶åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†æ–‡ä»¶ï¼Œå°†æ–‡ä»¶ä¿å­˜åˆ°ä»“åº“ä¸­ï¼Œè¿™æ ·æ•æ„Ÿæ–‡ä»¶ä¹Ÿæ˜¯ç‰ˆæœ¬æ§åˆ¶ï¼Œä½ å¯ä»¥è·å–åˆ°è¯¥æ–‡ä»¶çš„æ‰€æœ‰æäº¤è®°å½•ã€‚

ä½¿ç”¨ gpg å’Œæ‰€æœ‰ä¿¡ä»»ç”¨æˆ·çš„å…¬é’¥åŠ å¯†æ–‡ä»¶ï¼Œæ¯ä¸ªä¿¡ä»»ç”¨æˆ·å¯ä»¥ä½¿ç”¨ä¸ªäººå¯†é’¥è§£å¯†æ–‡ä»¶ï¼Œå¦‚æœç”¨æˆ·ç¦»å¼€å›¢é˜Ÿï¼Œå°†åˆ é™¤ç”¨æˆ·çš„å…¬é’¥å³å¯ï¼Œä»–ä¹Ÿå°±ä¸èƒ½å†è§£å¯†æ–‡ä»¶äº†ã€‚

## **git-secret ä½¿ç”¨**

å‡è®¾æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªä»“åº“ git-secret-demoï¼Œä»“åº“ä¸‹æœ‰ä¸€ä¸ªåŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ–‡ä»¶ secret.jsonï¼š

![202305160835285](https://fs.poneding.com/images/202305160835285.png)

æˆ‘ç°åœ¨æƒ³åšçš„æ˜¯ä½¿ç”¨ git-secret å°† secret.json æ–‡ä»¶åŠ å¯†ã€‚

* é¦–å…ˆå¾—å®‰è£… gpg å·¥å…·

```bash
# Debian & Ubuntu
sudo apt install gnupg -y
â€‹
# Macos
brew install gnupg
```

* æœ¬åœ°åˆ›å»º gpg RSA å¯†é’¥å¯¹

```bash
gpg --gen-key
```

åœ¨åˆ›å»ºæ—¶éœ€è¦è¾“å…¥è‡ªå·±çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼Œå¹¶ä¸”éœ€è¦è¾“å…¥ä½ çš„åŠ å¯†å¯†ç ã€‚

![202305160835334](https://fs.poneding.com/images/202305160835334.png)

å¯¼å‡ºä½ çš„å…¬é’¥æ–‡ä»¶ï¼Œä½ å¯ä»¥æ‹¿åˆ°è¿™ä¸ªå…¬é’¥æ–‡ä»¶äº¤ç»™ git ä»“åº“ç®¡ç†å‘˜ï¼Œè®©ä»–æŠŠä½ åŠ å…¥åˆ°ä»“åº“çš„ä¿¡ä»»ç”¨æˆ·åˆ—è¡¨ï¼š

```bash
gpg --armor --export ding.peng@email.cn > dp-public-key.gpg
```

![202305160835376](https://fs.poneding.com/images/202305160835376.png)

å¯¼å…¥å…¬é’¥æ–‡ä»¶ï¼Œgit ä»“åº“ç®¡ç†å‘˜å°†å…¬é’¥æ–‡ä»¶å¯¼å…¥æœ¬åœ°ç¯å¢ƒï¼Œä¹‹åå¯ä»¥å°†æœ¬åœ°ç¯å¢ƒä¸­çš„å…¬é’¥åŠ å…¥åˆ° git-secret ä¿¡ä»»ç”¨æˆ·åˆ—è¡¨ï¼š

```bash
gpg --import other-pulic-key.gpg
```

æŸ¥çœ‹æœ¬åœ°å¯†é’¥å¯¹åˆ—è¡¨

```bash
gpg --list-key
```

![202305160835439](https://fs.poneding.com/images/202305160835439.png)

* å®‰è£… git-secret

```bash
# Debian & Ubuntu
sudo apt install git-secret -y
â€‹
# Macos
brew install git-secret
```

* ä½¿ç”¨ `git secret init` åˆå§‹åŒ–ï¼Œåœ¨ä»“åº“æ ¹ç›®å½•ä¸‹æ‰§è¡Œ

```bash
git secret init
```

![202305160835464](https://fs.poneding.com/images/202305160835464.png)

é»˜è®¤ä¼šåœ¨ä»“åº“ä¸‹ç”Ÿæˆ .gitsecret ç›®å½•å’Œ .gitignore æ–‡ä»¶ã€‚

* å°†ç”¨æˆ·åŠ å…¥åˆ° git-secret ä¿¡ä»»ç”¨æˆ·åˆ—è¡¨

```bash
git secret tell ding.peng@email.cn
```

![202305160835521](https://fs.poneding.com/images/202305160835521.png)

* æ·»åŠ åŠ å¯†æ–‡ä»¶åˆ° git-secret

```bash
git secret add -i secret.json
```

![202305160835620](https://fs.poneding.com/images/202305160835620.png)

è¿™é‡Œ `-i` è‡ªåŠ¨å°†è¦åŠ å¯†çš„æ–‡ä»¶æ·»åŠ åˆ° `.gitignore`

æ­¤æ—¶ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯ä»¥åœ¨ç›®å½•ä¸‹çœ‹åˆ°ç”Ÿæˆçš„ `secret.json.secret` çš„åŠ å¯†åæ–‡ä»¶

```bash
git secret hide
```

![202305160835909](https://fs.poneding.com/images/202305160835909.png)

åˆ°è¿™æ—¶ï¼Œä½ çš„åŠ å¯†æ–‡ä»¶ä¸ä¼šæäº¤åˆ°ä»“åº“ä¸­ï¼Œä» git ä»“åº“æ–°å…‹éš†ä¸‹æ¥çš„æ—¶å€™æ˜¯æ²¡æœ‰åŠ å¯†æ–‡ä»¶çš„ï¼Œä½ éœ€è¦è§£å¯†æ–‡ä»¶æ‰èƒ½å¾—åˆ°æ–‡ä»¶ï¼Œä¾‹å¦‚æˆ‘ç°åœ¨åˆ é™¤åŠ å¯†æ–‡ä»¶ï¼Œç„¶åå†é€šè¿‡è§£å¯†åŠ å¯†è¿‡çš„æ–‡ä»¶é‡æ–°å¾—åˆ°æ•æ„Ÿæ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤:

```bash
git secret reveal # ç¬¬ä¸€æ¬¡ä½¿ç”¨è¯¥å‘½ä»¤éœ€è¦è¾“å…¥ä¿¡ä»»ç”¨æˆ·çš„å¯†ç 
```

![202305160835973](https://fs.poneding.com/images/202305160835973.png)

ä»ä»¥ä¸Šæˆªå›¾ï¼Œä½ å¯ä»¥çœ‹åˆ°æ•æ„Ÿæ–‡ä»¶ `secret.json` å¤±è€Œå¤å¾—çš„æ•´ä¸ªè¿‡ç¨‹ã€‚

## **git-secret å¸¸ç”¨å‘½ä»¤**

é™¤äº†ä¸Šé¢ä½¿ç”¨è¿‡çš„å‘½ä»¤ï¼Œä½ å¯èƒ½è¿˜ä¼šç”¨åˆ°ä»¥ä¸‹å‘½ä»¤ï¼š

![202305160835992](https://fs.poneding.com/images/202305160835992.png)

* **git secret usageï¼š**åˆ—å‡º git secret å¯ç”¨å‘½ä»¤ã€‚
* **git secret whoknowsï¼š**æŸ¥çœ‹å½“å‰ git ä»“åº“å…è®¸è®¿é—®ç§å¯†æ–‡ä»¶çš„ç”¨æˆ·é‚®ç®±åˆ—è¡¨ã€‚
* **git secret add**ï¼šæ·»åŠ åŠ å¯†æ–‡ä»¶ã€‚
* **git secret removeï¼š**ç§»é™¤åŠ å¯†æ–‡ä»¶ã€‚
* **git secret listï¼š**åˆ—å‡ºåŠ å¯†æ–‡ä»¶ã€‚
* **git secret changesï¼š**æŸ¥çœ‹åŠ å¯†æ–‡ä»¶çš„æ›´æ”¹è®°å½•ã€‚
* **git secret cleanï¼š**æ¸…é™¤æ‰€æœ‰åŠ å¯†æ–‡ä»¶ã€‚
* **git secret removepersonï¼š**ç§»é™¤ä¿¡ä»»ç”¨æˆ·ã€‚

---
[Â« Git å¸¸ç”¨](common-usage.md)

[Â» Github Action ä½¿ç”¨æœ€ä½³å®è·µ](github-action-best-practice.md)
