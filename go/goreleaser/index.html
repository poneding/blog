<!doctype html><html lang=cn dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Goreleaser
Goreleaser # Go ç¨‹åºé¡¹ç›®çš„è‡ªåŠ¨åŒ–å‘å¸ƒå·¥å…·ï¼Œç®€å•çš„å‘å¸ƒå‘½ä»¤å¸®åŠ©æˆ‘ä»¬çœå»å¤§é‡çš„é‡å¤å·¥ä½œã€‚
å®‰è£… # MacOsï¼š
brew install goreleaser/tap/goreleaser æºç ç¼–è¯‘ï¼š
git clone https://github.com/goreleaser/goreleaser cd goreleaser go get ./... go build -o goreleaser . ./goreleaser --version åˆå§‹åŒ– # åœ¨goé¡¹ç›®ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆ.goreleaser.ymlæ–‡ä»¶ï¼š
goreleaser init ç”Ÿæˆæ–‡ä»¶åï¼Œè‡ªè¡Œé…ç½®ï¼Œç›¸ä¿¡ä½ èƒ½çœ‹çš„æ‡‚ã€‚
éªŒè¯ .goreleaser.yml # goreleaser check ä½¿ç”¨æœ¬åœ°ç¯å¢ƒæ„å»º
goreleaser build --single-target é…ç½® github token # token å¿…é¡»è‡³å°‘åŒ…å« write:package æƒé™ï¼Œæ‰èƒ½ä¸Šä¼ åˆ°å‘å¸ƒèµ„æºä¸­ã€‚
ä»githubç”Ÿæˆtokenï¼Œå†™å…¥æ–‡ä»¶ï¼š
mkdir ~/.config/goreleaser vim ~/.config/goreleaser/github_token æˆ–è€…ç›´æ¥åœ¨ç»ˆç«¯å¯¼å…¥ç¯å¢ƒé…ç½®ï¼š
export GITHUB_TOKEN="YOUR_GITHUB_TOKEN" ä¸ºé¡¹ç›®æ‰“ä¸Š tag # git tag v0.'><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://blog.poneding.com/go/goreleaser/"><meta property="og:site_name" content="ç§‹æ²³è½å¶"><meta property="og:title" content="ç§‹æ²³è½å¶"><meta property="og:description" content='ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Goreleaser
Goreleaser # Go ç¨‹åºé¡¹ç›®çš„è‡ªåŠ¨åŒ–å‘å¸ƒå·¥å…·ï¼Œç®€å•çš„å‘å¸ƒå‘½ä»¤å¸®åŠ©æˆ‘ä»¬çœå»å¤§é‡çš„é‡å¤å·¥ä½œã€‚
å®‰è£… # MacOsï¼š
brew install goreleaser/tap/goreleaser æºç ç¼–è¯‘ï¼š
git clone https://github.com/goreleaser/goreleaser cd goreleaser go get ./... go build -o goreleaser . ./goreleaser --version åˆå§‹åŒ– # åœ¨goé¡¹ç›®ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆ.goreleaser.ymlæ–‡ä»¶ï¼š
goreleaser init ç”Ÿæˆæ–‡ä»¶åï¼Œè‡ªè¡Œé…ç½®ï¼Œç›¸ä¿¡ä½ èƒ½çœ‹çš„æ‡‚ã€‚
éªŒè¯ .goreleaser.yml # goreleaser check ä½¿ç”¨æœ¬åœ°ç¯å¢ƒæ„å»º
goreleaser build --single-target é…ç½® github token # token å¿…é¡»è‡³å°‘åŒ…å« write:package æƒé™ï¼Œæ‰èƒ½ä¸Šä¼ åˆ°å‘å¸ƒèµ„æºä¸­ã€‚
ä»githubç”Ÿæˆtokenï¼Œå†™å…¥æ–‡ä»¶ï¼š
mkdir ~/.config/goreleaser vim ~/.config/goreleaser/github_token æˆ–è€…ç›´æ¥åœ¨ç»ˆç«¯å¯¼å…¥ç¯å¢ƒé…ç½®ï¼š
export GITHUB_TOKEN="YOUR_GITHUB_TOKEN" ä¸ºé¡¹ç›®æ‰“ä¸Š tag # git tag v0.'><meta property="og:locale" content="cn"><meta property="og:type" content="article"><meta property="article:section" content="go"><meta property="article:modified_time" content="2024-06-13T15:37:18+08:00"><title>Goreleaser | ç§‹æ²³è½å¶</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/logo.png><link rel=canonical href=https://blog.poneding.com/go/goreleaser/><link rel=stylesheet href=/book.min.4964903a822a7acb10dac6d1ab524833c97fb5f99b141976bcb8a47d539be9c0.css integrity="sha256-SWSQOoIqessQ2sbRq1JIM8l/tfmbFBl2vLikfVOb6cA=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/cn.search.min.a4898d10c6cfdc36ae4d635f188afb447967af569ddd5f310cafeefcad2816f3.js integrity="sha256-pImNEMbP3DauTWNfGIr7RHlnr1ad3V8xDK/u/K0oFvM=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script><link rel=stylesheet href=/css/syntax.css></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo><span>ç§‹æ²³è½å¶</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=æœç´¢ aria-label=æœç´¢ maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><p>ğŸ¦‰ é›†ä¸­èµ·æ¥çš„æ„å¿—å¯ä»¥å‡»ç©¿é¡½çŸ³ã€‚</p><hr><ul><li><p><a href=/><strong>ğŸ  é¦–é¡µ</strong></a></p></li><li><p><strong>ğŸ“Œ ç½®é¡¶æ–‡ç« </strong></p><ul><li><a href=/git/common-usage/>Git å¸¸ç”¨</a></li><li><a href=/kubernetes/kubeadm-install-k8s-docker/>å®‰è£… Kubernetes (Docker)</a></li></ul></li><li><p><strong>ğŸ“Œ ç½®é¡¶åˆ†ç±»</strong></p><ul><li><a href=/go/>Golang ç¼–ç¨‹</a></li><li><a href=/kubernetes/>Kubernetes</a></li><li><a href=/rust/>Rust ç¼–ç¨‹</a></li><li><a href=/git/>Git</a></li></ul></li></ul><hr><ul><li><strong>ğŸ—ƒï¸ å¼€æºé¡¹ç›®</strong><ul><li><a href=https://github.com/ketches/registry-proxy>registry-proxy</a></li><li><a href=https://github.com/poneding/mdi>mdi</a></li></ul></li></ul><hr><ul><li><a href=https://github.com/poneding target=_blank rel=noopener>ğŸ™ GitHub</a></li><li><a href=mailto:poneding@gmail.com target=_blank rel=noopener>ğŸ“¬ é‚®ç®±</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Goreleaser</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#å®‰è£…>å®‰è£…</a></li><li><a href=#åˆå§‹åŒ–>åˆå§‹åŒ–</a><ul><li><a href=#éªŒè¯-goreleaseryml>éªŒè¯ .goreleaser.yml</a></li></ul></li><li><a href=#é…ç½®-github-token>é…ç½® github token</a></li><li><a href=#ä¸ºé¡¹ç›®æ‰“ä¸Š-tag>ä¸ºé¡¹ç›®æ‰“ä¸Š tag</a></li><li><a href=#æ‰§è¡Œ-goreleaser>æ‰§è¡Œ goreleaser</a></li><li><a href=#dry-run>Dry run</a><ul><li><a href=#build-only-æ¨¡å¼>Build only æ¨¡å¼</a></li><li><a href=#release-æ ‡è¯†>Release æ ‡è¯†</a></li></ul></li><li><a href=#å·¥ä½œåŸç†>å·¥ä½œåŸç†</a></li><li><a href=#cgo>CGO</a></li></ul></nav></aside></header><article class="markdown book-article"><p><a href=/>ğŸ  é¦–é¡µ</a> /
<a href=/go/>Golang ç¼–ç¨‹</a> / Goreleaser</p><h1 id=goreleaser>Goreleaser
<a class=anchor href=#goreleaser>#</a></h1><p>Go ç¨‹åºé¡¹ç›®çš„è‡ªåŠ¨åŒ–å‘å¸ƒå·¥å…·ï¼Œç®€å•çš„å‘å¸ƒå‘½ä»¤å¸®åŠ©æˆ‘ä»¬çœå»å¤§é‡çš„é‡å¤å·¥ä½œã€‚</p><h2 id=å®‰è£…>å®‰è£…
<a class=anchor href=#%e5%ae%89%e8%a3%85>#</a></h2><p><strong>MacOs</strong>ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>brew install goreleaser/tap/goreleaser
</span></span></code></pre></div><p><strong>æºç ç¼–è¯‘</strong>ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/goreleaser/goreleaser
</span></span><span class=line><span class=cl><span class=nb>cd</span> goreleaser
</span></span><span class=line><span class=cl>go get ./...
</span></span><span class=line><span class=cl>go build -o goreleaser .
</span></span><span class=line><span class=cl>./goreleaser --version
</span></span></code></pre></div><h2 id=åˆå§‹åŒ–>åˆå§‹åŒ–
<a class=anchor href=#%e5%88%9d%e5%a7%8b%e5%8c%96>#</a></h2><p>åœ¨goé¡¹ç›®ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆ<code>.goreleaser.yml</code>æ–‡ä»¶ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>goreleaser init
</span></span></code></pre></div><p>ç”Ÿæˆæ–‡ä»¶åï¼Œè‡ªè¡Œé…ç½®ï¼Œç›¸ä¿¡ä½ èƒ½çœ‹çš„æ‡‚ã€‚</p><h3 id=éªŒè¯-goreleaseryml>éªŒè¯ .goreleaser.yml
<a class=anchor href=#%e9%aa%8c%e8%af%81-goreleaseryml>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>goreleaser check
</span></span></code></pre></div><p>ä½¿ç”¨æœ¬åœ°ç¯å¢ƒæ„å»º</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>goreleaser build --single-target
</span></span></code></pre></div><h2 id=é…ç½®-github-token>é…ç½® github token
<a class=anchor href=#%e9%85%8d%e7%bd%ae-github-token>#</a></h2><p><code>token</code> å¿…é¡»è‡³å°‘åŒ…å« <code>write:package</code> æƒé™ï¼Œæ‰èƒ½ä¸Šä¼ åˆ°å‘å¸ƒèµ„æºä¸­ã€‚</p><p>ä»githubç”Ÿæˆtokenï¼Œå†™å…¥æ–‡ä»¶ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir ~/.config/goreleaser
</span></span><span class=line><span class=cl>vim ~/.config/goreleaser/github_token
</span></span></code></pre></div><p>æˆ–è€…ç›´æ¥åœ¨ç»ˆç«¯å¯¼å…¥ç¯å¢ƒé…ç½®ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GITHUB_TOKEN</span><span class=o>=</span><span class=s2>&#34;YOUR_GITHUB_TOKEN&#34;</span>
</span></span></code></pre></div><h2 id=ä¸ºé¡¹ç›®æ‰“ä¸Š-tag>ä¸ºé¡¹ç›®æ‰“ä¸Š tag
<a class=anchor href=#%e4%b8%ba%e9%a1%b9%e7%9b%ae%e6%89%93%e4%b8%8a-tag>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git tag v0.1.0 -m <span class=s2>&#34;release v0.1.0&#34;</span>
</span></span><span class=line><span class=cl>git push origin v0.1.0
</span></span></code></pre></div><h2 id=æ‰§è¡Œ-goreleaser>æ‰§è¡Œ goreleaser
<a class=anchor href=#%e6%89%a7%e8%a1%8c-goreleaser>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>goreleaser --clean
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è·³è¿‡ git ä¿®æ”¹éªŒè¯</span>
</span></span><span class=line><span class=cl>goreleaser build --skip-validate --clean
</span></span></code></pre></div><p>å¦‚æœç›®å‰è¿˜ä¸æƒ³æ‰“ tagï¼Œå¯ä»¥åŸºäºæœ€è¿‘çš„ä¸€æ¬¡æäº¤ ç›´æ¥ä½¿ç”¨ä¸€ä¸‹ <code>gorelease</code> å‘½ä»¤ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>goreleaser build --snapshot
</span></span></code></pre></div><h2 id=dry-run>Dry run
<a class=anchor href=#dry-run>#</a></h2><p>å¦‚æœä½ æƒ³åœ¨çœŸå®çš„å‘å¸ƒä¹‹å‰åšå‘å¸ƒæµ‹è¯•ï¼Œä½ å¯ä»¥å°è¯• <code>dry run</code> ã€‚</p><h3 id=build-only-æ¨¡å¼>Build only æ¨¡å¼
<a class=anchor href=#build-only-%e6%a8%a1%e5%bc%8f>#</a></h3><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼Œåªä¼šç¼–è¯‘å½“å‰é¡¹ç›®ï¼Œå¯ä»¥éªŒè¯é¡¹ç›®æ˜¯å¦å­˜å‚¨ç¼–è¯‘é”™è¯¯ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>goreleaser build
</span></span></code></pre></div><h3 id=release-æ ‡è¯†>Release æ ‡è¯†
<a class=anchor href=#release-%e6%a0%87%e8%af%86>#</a></h3><p>ä½¿ç”¨ <code>--skip-publish</code> å‘½ä»¤æ ‡è¯†æ¥è·³è¿‡å‘å¸ƒåˆ°è¿œç«¯ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>goreleaser release --skip-publish
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>goreleaser release --snapshot --skip-publish --clean
</span></span></code></pre></div><h2 id=å·¥ä½œåŸç†>å·¥ä½œåŸç†
<a class=anchor href=#%e5%b7%a5%e4%bd%9c%e5%8e%9f%e7%90%86>#</a></h2><p>æ¡ä»¶ï¼š</p><ul><li>é¡¹ç›®ä¸‹æœ‰ä¸€ä¸ªè§„èŒƒçš„ <code>Â·goreleaser.yml</code> æ–‡ä»¶</li><li>å¹²å‡€çš„ <code>git</code> ç›®å½•</li><li>ç¬¦åˆ <code>SemVer-compatible</code> çš„ç‰ˆæœ¬å‘½å</li></ul><p>æ­¥éª¤ï¼š</p><ol><li>defaultingï¼šä¸ºæ¯ä¸ªæ­¥éª¤é…ç½®åˆç†çš„é»˜è®¤å€¼</li><li>buildingï¼šæ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆbinariesï¼‰ï¼Œå½’æ¡£æ–‡ä»¶ï¼ˆarchivesï¼‰ï¼ŒåŒ…æ–‡ä»¶ï¼ˆpackagesï¼‰ï¼ŒDockeré•œåƒç­‰</li><li>publishingï¼šå°†æ„å»ºçš„æ–‡ä»¶å‘å¸ƒåˆ°é…ç½®çš„ GitHub Release èµ„æºï¼ŒDocker Hub ç­‰</li><li>annoucingï¼šå‘å¸ƒå®Œæˆåï¼Œé…ç½®é€šçŸ¥</li></ol><p>æ­¥éª¤å¯ä»¥é€šè¿‡å‘½ä»¤æ ‡è¯† <code>--skip-{step_name}</code> æ¥è·³è¿‡ï¼Œå¦‚æœå½“ä¸­æŸæ­¥éª¤å¤±è´¥ï¼Œä¹‹åçš„æ­¥éª¤å°†ä¸ä¼šè¿è¡Œã€‚</p><h2 id=cgo>CGO
<a class=anchor href=#cgo>#</a></h2><p>å¾ˆé—æ†¾ï¼Œå¦‚æœä½ çš„ Go ç¨‹åºé¡¹ç›®éœ€è¦ä½¿ç”¨åˆ° CGO çš„è·¨å¹³å°ç¼–è¯‘ï¼ŒDocker é•œåƒæ˜¯ä¸æ”¯æŒçš„ï¼Œå¹¶ä¸”ä½ çš„é…ç½®å°†ä¸ä¼šçœ‹åˆ° <code>clean</code> ã€‚</p><p>ä¹Ÿè®¸è¿™é‡Œå¯ä»¥å¸®åŠ©åˆ°ä½ ï¼š
<a href=https://goreleaser.com/cookbooks/cgo-and-crosscompiling/>Cross-compiling Go with CGO - GoReleaser</a></p><hr><p><a href=/go/gopkg-errors/>Â« gopkg-errors.md</a></p><p><a href=/go/mac-appl-silicon-cross-compile-cgo/>Â» Mac M1 äº¤å‰ç¼–è¯‘ CGO</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/poneding/blog/commit/5faa4f1be5d4525c49e513962394eae7c15fb6f2 title='æœ€åä¿®æ”¹è€… poneding | 2024/06/13' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt>
<span>2024/06/13</span></a></div><div><a class="flex align-center" href=https://github.com/poneding/blog/edit/master/content/go/goreleaser.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt>
<span>ç¼–è¾‘æœ¬é¡µ</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments><script src=https://giscus.app/client.js data-repo=poneding/blog data-repo-id=R_kgDOMITIHg data-category=General data-category-id=DIC_kwDOMITIHs4CgB4x data-mapping=url data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#å®‰è£…>å®‰è£…</a></li><li><a href=#åˆå§‹åŒ–>åˆå§‹åŒ–</a><ul><li><a href=#éªŒè¯-goreleaseryml>éªŒè¯ .goreleaser.yml</a></li></ul></li><li><a href=#é…ç½®-github-token>é…ç½® github token</a></li><li><a href=#ä¸ºé¡¹ç›®æ‰“ä¸Š-tag>ä¸ºé¡¹ç›®æ‰“ä¸Š tag</a></li><li><a href=#æ‰§è¡Œ-goreleaser>æ‰§è¡Œ goreleaser</a></li><li><a href=#dry-run>Dry run</a><ul><li><a href=#build-only-æ¨¡å¼>Build only æ¨¡å¼</a></li><li><a href=#release-æ ‡è¯†>Release æ ‡è¯†</a></li></ul></li><li><a href=#å·¥ä½œåŸç†>å·¥ä½œåŸç†</a></li><li><a href=#cgo>CGO</a></li></ul></nav></div></aside></main></body></html>