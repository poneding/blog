<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ç§‹æ²³è½å¶</title><link>https://blog.poneding.com/</link><description>Recent content on ç§‹æ²³è½å¶</description><generator>Hugo</generator><language>cn</language><atom:link href="https://blog.poneding.com/index.xml" rel="self" type="application/rss+xml"/><item><title/><link>https://blog.poneding.com/ai/d2l/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/ai/d2l/</guid><description>ğŸ  é¦–é¡µ / AI / åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ 
åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹  # ç¯å¢ƒå‡†å¤‡ # å¤‡æ³¨ï¼šå¼€å‘æœºå™¨ä¸º MacOS M1 Pro
python # https://www.python.org/ftp/python/3.12.4/python-3.12.4-macos11.pkg
miniconda # wget https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-arm64.sh sh Miniconda3-latest-MacOSX-arm64.sh -b jupyter # PyTorch æ¡†æ¶ # pip install torch==1.12.0 pip install torchvision==0.13.0 d2l åŒ… # pip install d2l==0.17.6 D2L Notebook # wget https://zh-v2.d2l.ai/d2l-zh.zip unzip d2l-zh.zip rm d2l-zh.zip cd mxnet å¼€å§‹ # # å‰ææ—¶å®‰è£…äº† zshï¼Œå¦åˆ™ä½¿ç”¨ bash ./miniconda3/bin/conda init zsh source ~/.zshrc conda create --name d2l python3.12.4 -y conda activate d2l Â» llama</description></item><item><title/><link>https://blog.poneding.com/ai/llama/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/ai/llama/</guid><description>ğŸ  é¦–é¡µ / AI / llama
llama # å®‰è£… # MacOSï¼š
brewÂ installÂ ollama Linuxï¼š
curlÂ -sSLÂ https://ollama.com/install.shÂ |Â sh å®‰è£…å®Œæˆä¹‹åï¼ŒæŸ¥çœ‹å®‰è£…ç‰ˆæœ¬ï¼š
ollama -v å¯åŠ¨ # ollamaÂ start # é€šè¿‡æ³¨å…¥ OLLAMA_HOST ç¯å¢ƒå˜é‡è®¾ç½®ç›‘å¬åœ°å€ # OLLAMA_HOST=0.0.0.0Â ollamaÂ start ä¸‹è½½å¹¶è¿è¡Œå¤§æ¨¡å‹ # Llama3 ç›®å‰å¯ä¾›ä¸‹è½½çš„å¤§æ¨¡å‹æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼š8B å’Œ 70Bï¼Œæœ¬åœ°è¿è¡Œå®¹é‡æœ‰é™ï¼Œé€‰æ‹© 8B ç‰ˆæœ¬å³å¯ï¼Œå¤§å°å¤§æ¦‚ 5G å·¦å³ã€‚
# å¦‚æœæ²¡ä¸‹è½½æ¨¡å‹ï¼Œè¿è¡Œä¼šè‡ªåŠ¨å…ˆä¸‹è½½ ollamaÂ runÂ llama3 # ä¸‹è½½å¤§æ¨¡å‹ # ollama pulll llama3 æ‰§è¡Œå®Œæˆåï¼Œä¼šç›´æ¥è¿›å…¥ä¸€ä¸ªäº¤äº’ç•Œé¢ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œå¯¹è¯äº†ã€‚
æ‰§è¡Œç”Ÿæˆå‘½ä»¤ # curl http://localhost:11434/api/generate -d &amp;#39;{ &amp;#34;model&amp;#34;: &amp;#34;llama3&amp;#34;, &amp;#34;prompt&amp;#34;: &amp;#34;Why is the sky blue?</description></item><item><title/><link>https://blog.poneding.com/algo/%E5%A0%86%E6%8E%92%E5%BA%8F/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/algo/%E5%A0%86%E6%8E%92%E5%BA%8F/</guid><description>ğŸ  é¦–é¡µ / æ•°æ®ç»“æ„ä¸ç®—æ³• / å †æ’åº
å †æ’åº # å †æ’åºæ˜¯åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„è€Œè®¾è®¡çš„ä¸€ç§æ’åºç®—æ³•ï¼Œå †æ’åºæ˜¯ä¸€ç§**é€‰æ‹©æ’åºï¼Œ**å®ƒçš„æœ€åï¼Œæœ€å¥½ï¼Œå¹³å‡æ—¶é—´å¤æ‚åº¦å‡ä¸º O(nlogn)ï¼Œå®ƒä¹Ÿæ˜¯ä¸ç¨³å®šæ’åºã€‚é¦–å…ˆç®€å•äº†è§£ä¸‹å †ç»“æ„ã€‚
å † # å †æ˜¯å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„å®Œå…¨äºŒå‰æ ‘ï¼šæ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½å¤§äºæˆ–ç­‰äºå…¶å·¦å³å­©å­ç»“ç‚¹çš„å€¼ï¼Œç§°ä¸ºå¤§é¡¶å †ï¼›æˆ–è€…æ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½å°äºæˆ–ç­‰äºå…¶å·¦å³å­©å­ç»“ç‚¹çš„å€¼ï¼Œç§°ä¸ºå°é¡¶å †ã€‚ï¼š
ç®—æ³•å®ç°ï¼ˆgolangï¼‰ # package main import &amp;#34;fmt&amp;#34; type BinaryTreeNode struct { Value int Left, Right *BinaryTreeNode } func main() { tree := &amp;amp;BinaryTreeNode{ Left: &amp;amp;BinaryTreeNode{ Left: &amp;amp;BinaryTreeNode{ Value: 1, }, Right: &amp;amp;BinaryTreeNode{ Value: 2, }, Value: 3, }, Right: &amp;amp;BinaryTreeNode{ Value: 4, }, Value: 5, } res := HeapSort(tree) fmt.Println(res) } func HeapSort(tree *BinaryTreeNode) []int { var res []int if tree == nil { return []int{} } res = heapSortHelper(tree, res) return res } func heapSortHelper(tree *BinaryTreeNode, res []int) []int { if tree.</description></item><item><title/><link>https://blog.poneding.com/algo/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/algo/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/</guid><description>ğŸ  é¦–é¡µ / æ•°æ®ç»“æ„ä¸ç®—æ³• / å¿«é€Ÿæ’åº
å¿«é€Ÿæ’åº # æ­¥éª¤å¦‚ä¸‹ï¼š
å…ˆä»æ•°åˆ—ä¸­å–å‡ºä¸€ä¸ªæ•°ä½œä¸ºåŸºå‡†æ•°ã€‚ä¸€èˆ¬å–ç¬¬ä¸€ä¸ªæ•°ã€‚ åˆ†åŒºè¿‡ç¨‹ï¼Œå°†æ¯”è¿™ä¸ªæ•°å¤§çš„æ•°å…¨æ”¾åˆ°å®ƒçš„å³è¾¹ï¼Œå°äºæˆ–ç­‰äºå®ƒçš„æ•°å…¨æ”¾åˆ°å®ƒçš„å·¦è¾¹ã€‚ å†å¯¹å·¦å³åŒºé—´é‡å¤ç¬¬äºŒæ­¥ï¼Œç›´åˆ°å„åŒºé—´åªæœ‰ä¸€ä¸ªæ•°ã€‚ ä¸¾ä¸€ä¸ªä¾‹å­ï¼š5 9 1 6 8 14 6 49 25 4 6 3ã€‚
ä¸€èˆ¬å–ç¬¬ä¸€ä¸ªæ•° 5 ä½œä¸ºåŸºå‡†ï¼Œä»å®ƒå·¦è¾¹å’Œæœ€åä¸€ä¸ªæ•°ä½¿ç”¨[]è¿›è¡Œæ ‡å¿—ï¼Œ å¦‚æœå·¦è¾¹çš„æ•°æ¯”åŸºå‡†æ•°å¤§ï¼Œé‚£ä¹ˆè¯¥æ•°è¦å¾€å³è¾¹æ‰”ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ª[]æ•°äº¤æ¢ï¼Œè¿™æ ·å¤§äºå®ƒçš„æ•°å°±åœ¨å³è¾¹äº†ï¼Œç„¶åå³è¾¹[]æ•°å·¦ç§»ï¼Œå¦åˆ™å·¦è¾¹[]æ•°å³ç§»ã€‚ 5 [9] 1 6 8 14 6 49 25 4 6 [3] å› ä¸º 9 &amp;gt; 5ï¼Œä¸¤ä¸ª[]äº¤æ¢ä½ç½®åï¼Œå³è¾¹[]å·¦ç§» 5 [3] 1 6 8 14 6 49 25 4 [6] 9 å› ä¸º 3 !&amp;gt; 5ï¼Œä¸¤ä¸ª[]ä¸éœ€è¦äº¤æ¢ï¼Œå·¦è¾¹[]å³ç§» 5 3 [1] 6 8 14 6 49 25 4 [6] 9 å› ä¸º 1 !</description></item><item><title/><link>https://blog.poneding.com/aws/build-eks-cluster/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/build-eks-cluster/</guid><description>ğŸ  é¦–é¡µ / AWS / æ­å»ºEKSé›†ç¾¤
æ­å»ºEKSé›†ç¾¤ # å®‰è£…awsï¼Œkubectlå’Œeksctlå‘½ä»¤è¡Œå·¥å…· # å¼•è¨€ # å®‰è£…aws cli å®‰è£…kubectl cli å®‰è£…eksctl cli å®‰è£…aws cli # å‚è€ƒ # https://docs.aws.amazon.com/zh_cn/cli/latest/userguide/cli-chap-install.html
å®‰è£…ç¤ºä¾‹ï¼ˆwindowsï¼‰ # ä¸‹è½½å®‰è£…åŒ…ï¼š https://awscli.amazonaws.com/AWSCLIV2.msi è¿è¡Œä¸‹è½½çš„å®‰è£…åŒ… ç¡®å®å®‰è£…æ˜¯å¦æˆåŠŸ aws --version ä½¿ç”¨Security Credentialsé…ç½®aws cli # è®¿é—®awsæ§åˆ¶å°ï¼šService =&amp;gt; IAM é€‰æ‹©IAM Userï¼Œä½¿ç”¨å­ç”¨æˆ·ï¼Œå¼ºçƒˆä¸å»ºè®®ä½¿ç”¨rootç”¨æˆ· è¿›å…¥ç”¨æˆ·è¯¦æƒ…é¡µé¢ï¼ŒSecurity Credentialsé¡µ åˆ›å»ºAccess Key æ‹·è´Access Key IDå’ŒSecret Access Key ä½¿ç”¨awså‘½ä»¤é…ç½® $ aws configure AWS Access Key ID [None]: ABCDEFGHIAZBERTUCNGG (æ›¿æ¢Access Key ID) AWS Secret Access Key [None]: uMe7fumK1IdDB094q2sGFhM5Bqt3HQRw3IHZzBDTm (æ›¿æ¢Secret Access Key) Default region name [None]: us-east-1 Default output format [None]: json æµ‹è¯•é…ç½®æ˜¯å¦ç”Ÿæ•ˆ aws ec2 describe-vpcs å¸è½½ï¼ˆwindowsï¼‰ # æ§åˆ¶é¢æ¿ =&amp;gt; ç¨‹åºå’ŒåŠŸèƒ½ï¼Œæ‰¾åˆ°aws cliï¼Œå¸è½½å³å¯ã€‚ å®‰è£…kubectl cli # å¦‚æœä½ ç¡®å®æ˜¯ä½¿ç”¨EKSçš„Kubernetesï¼Œå»ºè®®ä½¿ç”¨awsæä¾›çš„kubectlå‘½ä»¤å·¥å…·ã€‚</description></item><item><title/><link>https://blog.poneding.com/aws/cluster-autoscaler/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/cluster-autoscaler/</guid><description>ğŸ  é¦–é¡µ / AWS / Cluster AutoScaler
Cluster AutoScaler # æˆ‘å½“å‰å·²ç»æœ‰äº†ä¸€ä¸ªEKSæœåŠ¡æ­å»ºèµ·æ¥çš„K8sé›†ç¾¤ï¼Œæˆ‘ç°åœ¨å¸Œæœ›æˆ‘çš„é›†ç¾¤æ‹¥æœ‰è‡ªåŠ¨ä¼¸ç¼©ï¼ˆä½“ç°åœ¨èŠ‚ç‚¹çš„æ‰©ç¼©ï¼‰çš„èƒ½åŠ›ã€‚
å½“æˆ‘çš„é›†ç¾¤èµ„æºå……è¶³ï¼Œè€Œæˆ‘éƒ¨ç½²åœ¨é›†ç¾¤ä¸­çš„åº”ç”¨åªä½¿ç”¨åˆ°äº†å¾ˆå°‘é‡çš„èµ„æºï¼Œæˆ‘å¸Œæœ›é›†ç¾¤å›æ”¶èµ„æºä»¥èŠ‚çœè´¹ç”¨ï¼›å½“æˆ‘çš„åº”ç”¨æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå½“å‰é›†ç¾¤èµ„æºä¸è¶³æ—¶ï¼Œæˆ‘å¸Œæœ›é›†ç¾¤èƒ½å¢åŠ èŠ‚ç‚¹ï¼Œä»¥æ»¡è¶³åº”ç”¨çš„éƒ¨ç½²æ¡ä»¶ã€‚
é‚£ä¹ˆæœ¬ç¯‡å°±æ˜¯ä»‹ç»å¦‚ä½•é€šè¿‡ä½¿ç”¨Kubernetes Cluster Autoscalerè®©ä½ çš„é›†ç¾¤æ‹¥æœ‰è‡ªåŠ¨ä¼¸ç¼©çš„èƒ½åŠ›ï¼Œè€Œä¸ç”¨ä½ æ—¶åˆ»å…³æ³¨é›†ç¾¤çš„èµ„æºæ˜¯å¦è¿‡äºå®½æ¾æˆ–ç´§å¼ ã€‚
NodeGroupæ·»åŠ Tag # æˆ‘ä»¬åˆ›å»ºEKSæ—¶ï¼Œéœ€è¦å®šä¹‰NodeGroupï¼Œä¸€èˆ¬åœ¨è¿™ä¸ªNodeGroupä¸­å®šä¹‰:
asg_desired_capacityï¼šæœŸæœ›åˆ›å»ºçš„Nodeæ•°é‡ï¼›
asg_max_sizeï¼šæœ€å°Nodeæ•°é‡ï¼Œé»˜è®¤ä¸º1ï¼›
asg_min_sizeï¼šæœ€å¤§Nodeæ•°é‡ã€‚
å®šä¹‰çš„NodeGroupä¼šç”ŸæˆAuto Scaling Groupèµ„æºï¼Œå¹¶ä¸”ç”±Auto Scaling Groupæ¥ç®¡ç†Nodeçš„åˆ›å»ºã€‚
ç°åœ¨éœ€è¦åšçš„å°±æ˜¯ä¸ºä½ çš„Auto Scaling Groupæ·»åŠ Tagã€‚
tagé”®å€¼ï¼š
Tag Key Tag Value k8s.io/cluster-autoscaler/&amp;lt;your_cluster_name&amp;gt; owned k8s.io/cluster-autoscaler/enabled true ç¬¬ä¸€ä¸ªTag Keyä¸­çš„é›†ç¾¤å&amp;lt;your_cluster_name&amp;gt;éœ€è¦æ›¿æ¢ï¼›
Tag Valueçš„å€¼æ˜¯ä»€ä¹ˆä¸é‡è¦ï¼Œä¸»è¦æ˜¯éœ€è¦è¿™ä¸¤ä¸ªTag Keyæ¥è¯†åˆ«æ˜¯å¦å¯¹è¿™ä¸ªé›†ç¾¤å¼€å¯Auto Scalingçš„èƒ½åŠ›ã€‚
æ·»åŠ Policy # åˆ›å»ºIAMç­–ç•¥ï¼Œå°†æ–°åˆ›å»ºçš„ç­–ç•¥Attachåˆ°é›†ç¾¤èŠ‚ç‚¹ç»‘å®šçš„IAM roleä¸Šï¼Œè®©ä½ çš„é›†ç¾¤èŠ‚ç‚¹æ‹¥æœ‰è‡ªåŠ¨ä¼¸ç¼©çš„èƒ½åŠ›ã€‚
IAMç­–ç•¥Jsonå†…å®¹ï¼š
{ &amp;#34;Version&amp;#34;: &amp;#34;2012-10-17&amp;#34;, &amp;#34;Statement&amp;#34;: [ { &amp;#34;Action&amp;#34;: [ &amp;#34;autoscaling:DescribeAutoScalingGroups&amp;#34;, &amp;#34;autoscaling:DescribeAutoScalingInstances&amp;#34;, &amp;#34;autoscaling:DescribeLaunchConfigurations&amp;#34;, &amp;#34;autoscaling:DescribeTags&amp;#34;, &amp;#34;autoscaling:SetDesiredCapacity&amp;#34;, &amp;#34;autoscaling:TerminateInstanceInAutoScalingGroup&amp;#34;, &amp;#34;ec2:DescribeLaunchTemplateVersions&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34;, &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34; } ] } éƒ¨ç½²Cluster AutoScaler # åœ¨é›†ç¾¤ä¸­éƒ¨ç½²Cluster AutoScalerï¼Œå‡†å¤‡èµ„æºæ¸…å•æ–‡ä»¶cluster-autoscaler.</description></item><item><title/><link>https://blog.poneding.com/aws/create-eks-cluster/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/create-eks-cluster/</guid><description>ğŸ  é¦–é¡µ / AWS / åˆ›å»º EKS é›†ç¾¤
åˆ›å»º EKS é›†ç¾¤ # 1. EKSç®€ä»‹ # Amazon Elastic Kubernetes Service (Amazon EKS) æ˜¯ä¸€é¡¹æ‰˜ç®¡æœåŠ¡ï¼Œå¯è®©æ‚¨åœ¨ AWS ä¸Šè½»æ¾è¿è¡Œ Kubernetesï¼Œè€Œæ— éœ€æ”¯æŒæˆ–ç»´æŠ¤æ‚¨è‡ªå·±çš„ Kubernetes æ§åˆ¶å±‚é¢ã€‚Kubernetes æ˜¯ä¸€ä¸ªç”¨äºå®ç°å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„éƒ¨ç½²ã€æ‰©å±•å’Œç®¡ç†çš„è‡ªåŠ¨åŒ–çš„å¼€æºç³»ç»Ÿã€‚ï¼ˆè¯¥æ®µä»‹ç»æ¥è‡ªAmazon EKSæ–‡æ¡£ï¼Œæ›´å¤šäº†è§£ https://docs.aws.amazon.com/zh_cn/eks/latest/userguide/what-is-eks.htmlï¼‰
2. eksctlåˆ›å»ºeksé›†ç¾¤ # 2.1 ä»€ä¹ˆæ˜¯eksctl # eksctlæ˜¯ä¸€ç§ç”¨äºåœ¨ Amazon EKS ä¸Šåˆ›å»ºå’Œç®¡ç† Kubernetes é›†ç¾¤çš„ç®€å•å‘½ä»¤è¡Œå®ç”¨ç¨‹åºã€‚eksctl å‘½ä»¤è¡Œå®ç”¨ç¨‹åºæä¾›äº†ä½¿ç”¨å·¥ä½œçº¿ç¨‹èŠ‚ç‚¹ä¸º Amazon EKS åˆ›å»ºæ–°é›†ç¾¤çš„æœ€å¿«ã€æœ€ç®€å•çš„æ–¹å¼ã€‚
eksctlæ›´å¤šäº†è§£ https://eksctl.io
2.2 ä¸ºä»€ä¹ˆç”¨eksctl # åˆ›å»ºEKSé›†ç¾¤å¯ä»¥åœ¨AWSçš„æ§åˆ¶å°åˆ›å»ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨AWSå¼€å‘çš„eksctlå·¥å…·åˆ›å»ºï¼Œä¸ºä»€ä¹ˆé€‰æ‹©ä½¿ç”¨eksctlåˆ›å»ºeksé›†ç¾¤å‘¢ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹åŸå› ï¼š
ç›´æ¥åœ¨AWSçš„æ§åˆ¶å°åˆ›å»ºé›†ç¾¤ï¼Œéœ€è¦æ‰‹åŠ¨åˆ›å»ºå„ç§Roleï¼Œä»¥åŠé€‰æ‹©åˆé€‚çš„Subnetï¼ŒSecurity Groupç­‰ç¹æ‚æ“ä½œï¼Œä½ éœ€è¦åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å¤šä¸ªé¡µé¢ï¼Œæ“ä½œè¿‡ç¨‹å¯èƒ½ä¹Ÿè¦æ—¶ä¸æ—¶å‚é˜…æ–‡æ¡£ï¼› eksctlåˆ›å»ºEKSé›†ç¾¤åªéœ€è¦ä¸€è¡Œeksctl create cluster &amp;lt;å‚æ•°&amp;gt;å‘½ä»¤å³å¯ï¼Œä¼šè‡ªåŠ¨çš„ç»™ä½ åˆ›å»ºRoleç­‰èµ„æºï¼› eksctlçš„å‘½ä»¤å¯ä»¥è®°å½•åˆ°è„šæœ¬ï¼Œä¾¿äºå¤ç”¨ã€‚ 2.3 å®‰è£…eksctlï¼ˆåŸºäºubuntuï¼‰ # ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸‹è½½å¹¶æå–æœ€æ–°ç‰ˆæœ¬çš„ eksctlã€‚ curl --silent --location &amp;#34;https://github.com/weaveworks/eksctl/releases/download/latest_release/eksctl_$(uname -s)_amd64.tar.gz&amp;#34; | tar xz -C /tmp å°†æå–çš„äºŒè¿›åˆ¶æ–‡ä»¶ç§»è‡³ /usr/local/binã€‚ sudo mv /tmp/eksctl /usr/local/bin ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æµ‹è¯•æ‚¨çš„å®‰è£…æ˜¯å¦æˆåŠŸã€‚ eksctl version æ³¨æ„ï¼š</description></item><item><title/><link>https://blog.poneding.com/aws/eks-config-alb-ingress/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/eks-config-alb-ingress/</guid><description>ğŸ  é¦–é¡µ / AWS / EKSé…ç½® ALB Ingress
EKSé…ç½® ALB Ingress # å®˜æ–¹æ–‡æ¡£ï¼š https://kubernetes-sigs.github.io/aws-load-balancer-controller/latest/guide/controller/installation/
éƒ¨ç½²Alb Ingress Controller # IAMä¸­åˆ›å»ºPolicyï¼Œç»™é›†ç¾¤çš„NodeèŠ‚ç‚¹çš„Roleæ·»åŠ è¯¥Policyã€‚
Policyçš„JSONé…ç½®å¦‚ä¸‹ï¼š
{ &amp;#34;Version&amp;#34;: &amp;#34;2012-10-17&amp;#34;, &amp;#34;Statement&amp;#34;: [ { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;acm:DescribeCertificate&amp;#34;, &amp;#34;acm:ListCertificates&amp;#34;, &amp;#34;acm:GetCertificate&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; }, { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;ec2:AuthorizeSecurityGroupIngress&amp;#34;, &amp;#34;ec2:CreateSecurityGroup&amp;#34;, &amp;#34;ec2:CreateTags&amp;#34;, &amp;#34;ec2:DeleteTags&amp;#34;, &amp;#34;ec2:DeleteSecurityGroup&amp;#34;, &amp;#34;ec2:DescribeAccountAttributes&amp;#34;, &amp;#34;ec2:DescribeAddresses&amp;#34;, &amp;#34;ec2:DescribeInstances&amp;#34;, &amp;#34;ec2:DescribeInstanceStatus&amp;#34;, &amp;#34;ec2:DescribeInternetGateways&amp;#34;, &amp;#34;ec2:DescribeNetworkInterfaces&amp;#34;, &amp;#34;ec2:DescribeSecurityGroups&amp;#34;, &amp;#34;ec2:DescribeSubnets&amp;#34;, &amp;#34;ec2:DescribeTags&amp;#34;, &amp;#34;ec2:DescribeVpcs&amp;#34;, &amp;#34;ec2:ModifyInstanceAttribute&amp;#34;, &amp;#34;ec2:ModifyNetworkInterfaceAttribute&amp;#34;, &amp;#34;ec2:RevokeSecurityGroupIngress&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; }, { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;elasticloadbalancing:AddListenerCertificates&amp;#34;, &amp;#34;elasticloadbalancing:AddTags&amp;#34;, &amp;#34;elasticloadbalancing:CreateListener&amp;#34;, &amp;#34;elasticloadbalancing:CreateLoadBalancer&amp;#34;, &amp;#34;elasticloadbalancing:CreateRule&amp;#34;, &amp;#34;elasticloadbalancing:CreateTargetGroup&amp;#34;, &amp;#34;elasticloadbalancing:DeleteListener&amp;#34;, &amp;#34;elasticloadbalancing:DeleteLoadBalancer&amp;#34;, &amp;#34;elasticloadbalancing:DeleteRule&amp;#34;, &amp;#34;elasticloadbalancing:DeleteTargetGroup&amp;#34;, &amp;#34;elasticloadbalancing:DeregisterTargets&amp;#34;, &amp;#34;elasticloadbalancing:DescribeListenerCertificates&amp;#34;, &amp;#34;elasticloadbalancing:DescribeListeners&amp;#34;, &amp;#34;elasticloadbalancing:DescribeLoadBalancers&amp;#34;, &amp;#34;elasticloadbalancing:DescribeLoadBalancerAttributes&amp;#34;, &amp;#34;elasticloadbalancing:DescribeRules&amp;#34;, &amp;#34;elasticloadbalancing:DescribeSSLPolicies&amp;#34;, &amp;#34;elasticloadbalancing:DescribeTags&amp;#34;, &amp;#34;elasticloadbalancing:DescribeTargetGroups&amp;#34;, &amp;#34;elasticloadbalancing:DescribeTargetGroupAttributes&amp;#34;, &amp;#34;elasticloadbalancing:DescribeTargetHealth&amp;#34;, &amp;#34;elasticloadbalancing:ModifyListener&amp;#34;, &amp;#34;elasticloadbalancing:ModifyLoadBalancerAttributes&amp;#34;, &amp;#34;elasticloadbalancing:ModifyRule&amp;#34;, &amp;#34;elasticloadbalancing:ModifyTargetGroup&amp;#34;, &amp;#34;elasticloadbalancing:ModifyTargetGroupAttributes&amp;#34;, &amp;#34;elasticloadbalancing:RegisterTargets&amp;#34;, &amp;#34;elasticloadbalancing:RemoveListenerCertificates&amp;#34;, &amp;#34;elasticloadbalancing:RemoveTags&amp;#34;, &amp;#34;elasticloadbalancing:SetIpAddressType&amp;#34;, &amp;#34;elasticloadbalancing:SetSecurityGroups&amp;#34;, &amp;#34;elasticloadbalancing:SetSubnets&amp;#34;, &amp;#34;elasticloadbalancing:SetWebACL&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; }, { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;iam:CreateServiceLinkedRole&amp;#34;, &amp;#34;iam:GetServerCertificate&amp;#34;, &amp;#34;iam:ListServerCertificates&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; }, { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;cognito-idp:DescribeUserPoolClient&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; }, { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;waf-regional:GetWebACLForResource&amp;#34;, &amp;#34;waf-regional:GetWebACL&amp;#34;, &amp;#34;waf-regional:AssociateWebACL&amp;#34;, &amp;#34;waf-regional:DisassociateWebACL&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; }, { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;tag:GetResources&amp;#34;, &amp;#34;tag:TagResources&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; }, { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;waf:GetWebACL&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; }, { &amp;#34;Effect&amp;#34;: &amp;#34;Allow&amp;#34;, &amp;#34;Action&amp;#34;: [ &amp;#34;shield:DescribeProtection&amp;#34;, &amp;#34;shield:GetSubscriptionState&amp;#34;, &amp;#34;shield:DeleteProtection&amp;#34;, &amp;#34;shield:CreateProtection&amp;#34;, &amp;#34;shield:DescribeSubscription&amp;#34;, &amp;#34;shield:ListProtections&amp;#34; ], &amp;#34;Resource&amp;#34;: &amp;#34;*&amp;#34; } ] } ä¸‹è½½alb-ingress-controller.</description></item><item><title/><link>https://blog.poneding.com/aws/eks-details/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/eks-details/</guid><description>ğŸ  é¦–é¡µ / AWS / EKSå°ç»†èŠ‚æ±‡æ€»
EKSå°ç»†èŠ‚æ±‡æ€» # å¦‚æœalbçš„ingressä½¿ç”¨äº†è‡ªå®šä¹‰çš„security groupï¼Œé‚£ä¹ˆéœ€è¦å°†è¯¥å®‰å…¨ç»„åŠ å…¥åˆ°worker
Â« EKSé…ç½® ALB Ingress
Â» EKSå®è·µ é›†æˆGitlabè‡ªåŠ¨å‘å¸ƒï¼ˆä¸€ï¼‰</description></item><item><title/><link>https://blog.poneding.com/aws/eks-intergrate-gitlab-auto-release-01/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/eks-intergrate-gitlab-auto-release-01/</guid><description>ğŸ  é¦–é¡µ / AWS / EKSå®è·µ é›†æˆGitlabè‡ªåŠ¨å‘å¸ƒï¼ˆä¸€ï¼‰
EKSå®è·µ é›†æˆGitlabè‡ªåŠ¨å‘å¸ƒï¼ˆä¸€ï¼‰ # ç³»åˆ—ä»‹ç»å¦‚ä½•ä½¿ç”¨Gitlab CI/CDè‡ªåŠ¨éƒ¨ç½²åº”ç”¨åˆ°EKSï¼ˆK8sï¼‰é›†ç¾¤ä¸­ã€‚æœ¬ç¯‡ä»‹ç»å¦‚ä½•åœ¨EKSï¼ˆK8sï¼‰é›†ç¾¤ä¸­ä¸ºGitlabçš„CI/CDåˆ›å»ºGitlab Runnerã€‚
Gitlabæ·»åŠ K8sé›†ç¾¤ # æ·»åŠ æ–¹å¼ # ç¬¬ä¸€ç§æ–¹å¼ï¼ŒåŸºäºå•ä¸ªä»“åº“æ·»åŠ K8sé›†ç¾¤ï¼š
è¿›å…¥Gitlabä»“åº“ï¼Œä¾æ¬¡ä»å·¦è¾¹èœå•æ Operations =&amp;gt; Kubernetesè¿›å…¥æ·»åŠ é¡µé¢ï¼Œç‚¹å‡»Add Kubernetes clusteræŒ‰é’®ã€‚è¿™ç§æ–¹å¼æ·»åŠ çš„K8sé›†ç¾¤åªå¯¹è¯¥é¡¹ç›®ä»“åº“æœ‰æ•ˆã€‚
ç¬¬äºŒç§æ–¹å¼ï¼ŒåŸºäºGroupæ·»åŠ K8sé›†ç¾¤ï¼š
è¿›å…¥Gitlabä¸»é¡µï¼Œä¾æ¬¡ä»ä¸Šè¾¹èœå•æ Groups =&amp;gt; Your groupsï¼Œé€‰æ‹©Groupè¿›å…¥é¡µé¢ï¼Œç„¶åä¾æ¬¡ä»å·¦è¾¹èœå•æ Kuberentesè¿›å…¥æ·»åŠ é¡µé¢ï¼Œç‚¹å‡»Add Kubernetes clusterã€‚è¿™ç§æ–¹å¼æ·»åŠ çš„K8sé›†ç¾¤å¯¹è¯¥Groupä¸‹çš„é¡¹ç›®ä»“åº“æœ‰æ•ˆã€‚
ç¬¬ä¸‰ç§æ–¹å¼ï¼ŒåŸºäºå…¨å±€æ·»åŠ K8sé›†ç¾¤ï¼š
è¿™ç§æ–¹å¼éœ€è¦ç”¨åˆ°gitlabçš„rootæƒé™ã€‚è¿›å…¥Gitlabä¸»é¡µï¼Œä»ä¸Šè¾¹èœå•æ Admin Area(æ‰³æ‰‹å›¾æ ‡) è¿›å…¥é¡µé¢ï¼Œç„¶åä¾æ¬¡ä»å·¦è¾¹èœå•æ Kuberentesè¿›å…¥æ·»åŠ é¡µé¢ï¼Œç‚¹å‡»Add Kubernetes clusterã€‚è¿™ç§æ–¹å¼æ·»åŠ çš„K8sé›†ç¾¤å¯¹æ‰€æœ‰é¡¹ç›®ä»“åº“æœ‰æ•ˆã€‚
æ·»åŠ æ­¥éª¤ # æ·»åŠ å·²æœ‰çš„K8sé›†ç¾¤ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ­¥éª¤è·å–åˆ°å¯¹åº”çš„å€¼å¡«å…¥è¡¨å•å³å¯ã€‚
Cluster Nameï¼š è¿™ä¸ªå¯ä»¥è‡ªå®šä¹‰ï¼Œèƒ½è‡ªè¡ŒåŒºåˆ†å°±è¡Œã€‚
API URLï¼š è¿è¡Œä»¥ä¸‹å‘½ä»¤å¾—åˆ°è¾“å‡ºå€¼ï¼š
kubectl cluster-info | grep &amp;#39;Kubernetes master&amp;#39; | awk &amp;#39;/http/ {print $NF}&amp;#39; CA Certificateï¼š è¿è¡Œä»¥ä¸‹å‘½ä»¤å¾—åˆ°è¾“å‡ºå€¼ï¼š
kubectl get secret $(kubectl get secret | grep default-token | awk &amp;#39;{print $1}&amp;#39;) -o jsonpath=&amp;#34;{[&amp;#39;data&amp;#39;][&amp;#39;ca\.</description></item><item><title/><link>https://blog.poneding.com/aws/eks-intergrate-gitlab-auto-release-02/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/eks-intergrate-gitlab-auto-release-02/</guid><description>ğŸ  é¦–é¡µ / AWS / EKSå®è·µ é›†æˆGitlabè‡ªåŠ¨å‘å¸ƒï¼ˆäºŒï¼‰
EKSå®è·µ é›†æˆGitlabè‡ªåŠ¨å‘å¸ƒï¼ˆäºŒï¼‰ # ç³»åˆ—ä»‹ç»å¦‚ä½•ä½¿ç”¨Gitlab CI/CDè‡ªåŠ¨éƒ¨ç½²åº”ç”¨åˆ°EKSï¼ˆK8sï¼‰é›†ç¾¤ä¸­ã€‚æœ¬ç¯‡ä»‹ç»å¦‚ä½•ä¸ºRunnré•œåƒçš„åˆ¶ä½œã€‚
ä¸Šæ–‡ä¸­åˆ›å»ºçš„Gitlab Runnerä¼šæŒç»­å­˜æ´»åœ¨EKSé›†ç¾¤ä¸­ï¼Œä½†æ˜¯å®ƒä¸åšå…·ä½“çš„Pipelineä»»åŠ¡ï¼Œå½“æœ‰Pipelineä»»åŠ¡æ¥ä¸´æ—¶ï¼Œç”±å®ƒæ¥åˆ›å»ºä¸´æ—¶çš„Runneræ¥æ‰§è¡Œã€‚è€Œä¸´æ—¶æ‹†åŠŸåˆ›å»ºçš„Runnerä½¿ç”¨ä»€ä¹ˆå®¹å™¨ç¯å¢ƒä»¥åŠå…·ä½“æ‰§è¡Œä»€ä¹ˆä»»åŠ¡æ˜¯ç”±ä»“åº“ç›®å½•ä¸‹.gitlab-ci.ymlæ–‡ä»¶å®šä¹‰çš„ã€‚
åˆ¶ä½œTemp Runneré•œåƒ # æˆ‘ä»¬åˆ¶ä½œè¿™ä¸ªé•œåƒçš„ç›®çš„æ˜¯ä¸ºäº†èƒ½è®©é•œåƒè¿è¡Œèµ·æ¥åï¼Œå¯ä»¥å®Œæˆæˆ‘ä»¬çš„è‡ªåŠ¨å‘å¸ƒä»»åŠ¡ã€‚æ¯”å¦‚åœ¨å®¹å™¨temp-runnerå®¹å™¨éœ€è¦å°†æˆ‘ä»¬çš„ä»£ç buildæˆåº”ç”¨é•œåƒï¼Œç„¶åå°†åº”ç”¨é•œåƒå‘å¸ƒåˆ°EKSé›†ç¾¤ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨å®¹å™¨ä¸­æˆ‘ä»¬å°±å¿…é¡»å¯ä»¥ä½¿ç”¨docker buildåŠŸèƒ½ä»¥åŠkubectl applyåŠŸèƒ½ã€‚
æŒ‰ç…§ä»¥ä¸Šçš„éœ€è¦ï¼Œæˆ‘ä»¬åˆ¶ä½œçš„é•œåƒè‡³å°‘éœ€è¦å®‰è£…å¥½docker ä»¥åŠkubectlã€‚
Dockerfileå¦‚ä¸‹ï¼š
FROM docker:18 RUN apk add --no-cache curl jq python3 git tar tree &amp;amp;&amp;amp; \ curl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/linux/amd64/kubectl &amp;amp;&amp;amp; chmod +x ./kubectl &amp;amp;&amp;amp; mv ./kubectl /usr/local/bin/kubectl ç›´æ¥ä½¿ç”¨dockeré•œåƒä½œä¸ºåŸºç¡€é•œåƒï¼Œç„¶åå®‰è£…kubectl
ä½¿ç”¨å‘½ä»¤åˆ¶ä½œå¹¶æ¨é€é•œåƒåˆ°dockerhubï¼ˆå®é™…æˆ‘çš„é•œåƒæ¨åŠ¨åˆ°äº†ECRï¼‰
docker build . -t gitlab-runner-base:latest --rm --no-cache docker push gitlab-runner-base:latest ä»“åº“é…ç½® # é¡¹ç›®ä»“åº“æ ¹ç›®å½•ä¸‹æ–°å¢.gitlab-ci.ymlæ–‡ä»¶ï¼Œç„¶åæ–‡ä»¶å†…å®¹
Â« EKSå®è·µ é›†æˆGitlabè‡ªåŠ¨å‘å¸ƒï¼ˆä¸€ï¼‰
Â» EKS-ä½¿ç”¨EFS</description></item><item><title/><link>https://blog.poneding.com/aws/eks-use-efs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/eks-use-efs/</guid><description>ğŸ  é¦–é¡µ / AWS / EKS-ä½¿ç”¨EFS
EKS-ä½¿ç”¨EFS # åˆ›å»ºEFS
aws efs create-file-system \ --performance-mode generalPurpose \ --throughput-mode bursting \ --encrypted \ --tags Key=Name,Value=&amp;lt;fs-name&amp;gt; Key=creator,Value=dp Key=env:dev,Value=1 # ä¸Šé¢çš„å‘½ä»¤ä¼šå¾—åˆ°fs-id aws efs create-mount-target \ --file-system-id &amp;lt;fs-id&amp;gt; \ --subnet-id subnet-08d7609e614373fb8 \ --security-groups sg-0af0f0e8705380529 aws efs create-mount-target \ --file-system-id &amp;lt;fs-id&amp;gt; \ --subnet-id subnet-09c0707ea8ad281bb \ --security-groups sg-0af0f0e8705380529 aws efs create-mount-target \ --file-system-id &amp;lt;fs-id&amp;gt; \ --subnet-id subnet-063a8f10feb97868d \ --security-groups sg-0af0f0e8705380529 Â« EKSå®è·µ é›†æˆGitlabè‡ªåŠ¨å‘å¸ƒï¼ˆäºŒï¼‰
Â» Gitlab &amp;amp; EKS</description></item><item><title/><link>https://blog.poneding.com/aws/gitlab-eks/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/gitlab-eks/</guid><description>ğŸ  é¦–é¡µ / AWS / Gitlab &amp;amp; EKS
Gitlab &amp;amp; EKS # åˆ›å»ºIAM User&amp;amp;Group # Userï¼šgitlab-ciï¼Œä¿å­˜ç”Ÿæˆçš„Access key IDå’ŒSecret Access Keyï¼Œåé¢ä¼šç”¨åˆ°
Groupï¼šGitlab.CIï¼Œæ·»åŠ Policyå¦‚ä¸‹ï¼š
Policy Name AmazonEKSWorkerNodePolicy AmazonEC2ContainerRegistryFullAccess AmazonEC2ContainerRegistryReadOnly AmazonEC2ContainerServiceFullAccess AmazonEKS_CNI_Policy å°†user gitlab-ciæ·»åŠ åˆ°Group Gitlab.CI
å°†IAM Useræ·»åŠ åˆ°ConfigMap # kubectl edit cm aws-auth -n kube-system åœ¨mapUsersé”®è¿½åŠ ï¼š
- &amp;#34;groups&amp;#34;: - &amp;#34;system:masters&amp;#34; &amp;#34;userarn&amp;#34;: &amp;#34;arn:aws:iam::xxxxxxx:user/gitlab-ci&amp;#34; &amp;#34;username&amp;#34;: &amp;#34;gitlab-ci&amp;#34; Gitlabä»“åº“è®¾ç½® # Setting =&amp;gt; CI/CD =&amp;gt; Variablesï¼Œæ·»åŠ å˜é‡ï¼š
AWS_ACCESS_KEY_IDï¼š&amp;lt;gitlab-ciç”¨æˆ·çš„Access key ID&amp;gt; AWS_SECRET_ACCESS_KEYï¼š&amp;lt;gitlab-ciç”¨æˆ·çš„Secret Access Key&amp;gt; Gitlabä»“åº“.gitlab-ci.yml # Â« EKS-ä½¿ç”¨EFS
Â» K8s éƒ¨ç½² Kong æœåŠ¡</description></item><item><title/><link>https://blog.poneding.com/aws/k8s-deploy-kong/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/k8s-deploy-kong/</guid><description>ğŸ  é¦–é¡µ / AWS / K8s éƒ¨ç½² Kong æœåŠ¡
K8s éƒ¨ç½² Kong æœåŠ¡ # æœ¬ç¯‡åªæ¶‰åŠ Kong æœåŠ¡åœ¨ K8s é›†ç¾¤çš„éƒ¨ç½²æ“ä½œï¼Œä¸æ¶‰åŠæ¦‚å¿µçŸ¥è¯†ã€‚
æå‰å‡†å¤‡ # K8s é›†ç¾¤ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯ AWS EKS é›†ç¾¤æœåŠ¡ ä¸€å°å¯ä»¥è¿æ¥ K8s é›†ç¾¤çš„æœåŠ¡å™¨ï¼Œå·²ç»å®‰è£… kubectl å’Œ docker ç­‰åŸºç¡€åº”ç”¨ï¼Œä¹‹åç§°ä¹‹ä¸ºæ“ä½œæœºå™¨ Postgres æ•°æ®åº“ï¼Œä½œä¸º Kong æœåŠ¡çš„åç«¯æ•°æ®åº“ åˆå§‹åŒ–æ•°æ®åº“ # ä½¿ç”¨ Postgres ä½œä¸º Kong æœåŠ¡çš„åç«¯æ•°æ®åº“ï¼Œæˆ‘ä»¬éœ€è¦æå‰åšæ•°æ®åº“çš„åˆå§‹åŒ–ï¼Œå‡†å¤‡ Kong æœåŠ¡éœ€è¦çš„æ•°æ®è¡¨ç­‰ã€‚è¿™é‡Œä½¿ç”¨ K8s-Job æ¥å®ç°æ•°æ®åº“çš„åˆå§‹åŒ–å·¥ä½œã€‚
kong-migrations-job.yamlï¼š
apiVersion: batch/v1 kind: Job metadata: name: kong-migrations namespace: kong spec: template: metadata: name: kong-migrations spec: containers: - command: - /bin/sh - -c - kong migrations bootstrap env: - name: KONG_PG_PASSWORD value: &amp;#34;kong&amp;#34; - name: KONG_PG_HOST value: &amp;#34;postgres/postgres&amp;#34; - name: KONG_PG_PORT value: &amp;#34;5432&amp;#34; image: kong:1.</description></item><item><title/><link>https://blog.poneding.com/aws/k8s-deploy-konga/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/k8s-deploy-konga/</guid><description>ğŸ  é¦–é¡µ / AWS / K8s éƒ¨ç½² konga
K8s éƒ¨ç½² konga # æœ¬ç¯‡åªæ¶‰åŠ konga çš„éƒ¨ç½²æ“ä½œï¼Œä¸æ¶‰åŠæ¦‚å¿µçŸ¥è¯†ã€‚
æå‰å‡†å¤‡ # K8s é›†ç¾¤ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯ AWS EKS é›†ç¾¤æœåŠ¡ ä¸€å°å¯ä»¥è¿æ¥ K8s é›†ç¾¤çš„æœåŠ¡å™¨ï¼Œå·²ç»å®‰è£… kubectl å’Œ docker ç­‰åŸºç¡€åº”ç”¨ï¼Œä¹‹åç§°ä¹‹ä¸ºæ“ä½œæœºå™¨ Postgresæ•°æ®åº“ ï¼æ³¨æ„ï¼šè¯¥æ•°æ®åº“ä½¿ç”¨ 9.5 ç‰ˆæœ¬ï¼Œå…¶ä»–æœ€æ–°ç‰ˆæœ¬çš„æ•°æ®åº“åœ¨åˆå§‹åŒ– konga æ•°æ®åº“æ—¶ä¼šæŠ¥å¦‚ä¸‹é”™ï¼š
error: Failed to prepare database: error: column r.consrc does not exist è¿™æ˜¯éƒ¨ç½² konga è¸©è¿‡çš„å‘ä¹‹ä¸€ã€‚
ç¡®ä¿ K8s é›†ç¾¤ä¸­å·²ç»åˆ›å»ºäº† nginx-ingressï¼Œnginx-ingress ç”¨äºæ ¹æ®å®šåˆ¶çš„ Ruleï¼ˆå¦‚åæ–‡ kong-ingress çš„é…ç½®ï¼‰å°†æµé‡è½¬å‘è‡³ K8s é›†ç¾¤çš„ Service ä¸­å»ã€‚ åˆ›å»º nginx-ingress æŒ‡ä»¤ï¼ˆå¯å‚ç…§ https://kubernetes.github.io/ingress-nginx/deploy/ï¼‰æ­¥éª¤å¦‚ä¸‹ï¼š
Step 1. æ‰§è¡Œä»¥ä¸‹å¼ºåˆ¶å‘½ä»¤
kubectl apply -f https://raw.</description></item><item><title/><link>https://blog.poneding.com/aws/k8s-deploy-postgres/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/k8s-deploy-postgres/</guid><description>ğŸ  é¦–é¡µ / AWS / K8s éƒ¨ç½² Postgres
K8s éƒ¨ç½² Postgres # æœ¬ç¯‡åªæ¶‰åŠ Postgres çš„éƒ¨ç½²æ“ä½œï¼Œä¸æ¶‰åŠæ¦‚å¿µçŸ¥è¯†ã€‚
ç‰¹åˆ«è¯´æ˜ï¼šPostgres ç›¸å¯¹äºæ™®é€šçš„ç¨‹åºåº”ç”¨è€Œè¨€ï¼Œå±äºæœ‰çŠ¶æ€çš„æœåŠ¡ï¼Œå› ä¸ºå®ƒå­˜å‚¨çš„æ•°æ®æ˜¯éœ€è¦æŒä¹…ä¿å­˜çš„ï¼Œè¿™ç‚¹å†³å®šäº†æˆ‘ä»¬é€‰æ‹© K8s-StatefulSet çš„éƒ¨ç½²è€Œé K8s-Deploymentã€‚
æå‰å‡†å¤‡ # K8s é›†ç¾¤ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯AWS EKSé›†ç¾¤æœåŠ¡ ä¸€å°å¯ä»¥è¿æ¥ K8s é›†ç¾¤çš„æœåŠ¡å™¨ï¼Œå·²ç»å®‰è£… kubectl å’Œ docker ç­‰åŸºç¡€åº”ç”¨ K8sèµ„æºæ–‡ä»¶ # postgres-namespace.yamlï¼š
apiVersion: v1 kind: Namespace metadata: name: postgres postgres-config.yamlï¼š
apiVersion: v1 kind: ConfigMap metadata: name: postgres-config namespace: postgres labels: app: postgres data: POSTGRES_DB: master POSTGRES_USER: dba POSTGRES_PASSWORD: pg_pass è¿™é‡Œçš„æ•°æ®åº“å¯†ç æ¶‰åŠåˆ°ä¿¡æ¯æ•æ„Ÿï¼Œæ›´å»ºè®®ä½¿ç”¨ Secret èµ„æºè€Œé ConfigMapï¼Œè¿™é‡Œå°±å·æ‡’äº†ã€‚
postgres-statefulset.yamlï¼š
apiVersion: apps/v1 kind: StatefulSet metadata: name: postgres namespace: postgres spec: serviceName: &amp;#34;postgres&amp;#34; replicas: 1 selector: matchLabels: app: postgres template: metadata: labels: app: postgres spec: containers: - name: postgres image: postgres:9.</description></item><item><title/><link>https://blog.poneding.com/aws/terraform-remanage-resource/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/aws/terraform-remanage-resource/</guid><description>ğŸ  é¦–é¡µ / AWS / Terraform é‡æ–°ç®¡ç†èµ„æº
Terraform é‡æ–°ç®¡ç†èµ„æº # çœ‹åˆ°è¿™ä¸ªæ ‡é¢˜ä½ å¯èƒ½ä¼šæœ‰ç‚¹æ‡µï¼Œæˆ‘å…ˆæ¥è§£é‡Šä¸‹ã€‚
åœ¨ä½¿ç”¨Terraformç®¡ç†AWSçš„VPC-Subnetèµ„æºæ—¶ï¼ˆä¸‹é¢æ˜¯å®šä¹‰èµ„æºçš„ä»£ç æ¸…å•ï¼‰ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šå½“æˆ‘ä¿®æ”¹aws_subnet.eks-private-subnet-1èµ„æºçš„cidr_blockæ—¶ï¼Œå‡è®¾æˆ‘ä¿®æ”¹æˆäº†172.28.2.0/24ï¼Œè¿™æ—¶å€™æ—§çš„
resource &amp;#34;aws_subnet&amp;#34; &amp;#34;eks-private-subnet-1&amp;#34; { vpc_id = &amp;#34;${var.vpc_id}&amp;#34; cidr_block = &amp;#34;172.28.1.0/24&amp;#34; map_public_ip_on_launch = &amp;#34;false&amp;#34; availability_zone = &amp;#34;${var.region}a&amp;#34; tags = merge( {Name = &amp;#34;${var.cluster_name}-private-subnet-1a&amp;#34;}, &amp;#34;${local.cluster_private_subnet_tags}&amp;#34;) } Â« K8s éƒ¨ç½² Postgres</description></item><item><title/><link>https://blog.poneding.com/cka/001/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/cka/001/</guid><description>ğŸ  é¦–é¡µ / CKA / 001
001 # 01 Task - è‹±æ–‡ # Create a new ClusterRole named deployment-clusterrole that only allows the creation of the following resource types:
Deployment StatefulSet DaemonSet Create a new ServiceAccount named cicd-token in the existing namespace app-team1. Limited to namespace app-team1, bind the new ClusterRole deployment-clusterrole to the new ServiceAccount cicd-token. kubectl create ns app-team1 kubectl create serviceaccount cicd-token -n app-team1 kubectl create clusterrole deployment-clusterrole --verb=create --resource=deployment,statefulset,daemonset #limted to the namespace app-team1ã€‚éœ€è¦é™åˆ¶çš„æ˜¯namespaceçº§åˆ«ï¼Œclusterrolebindingä¸ºè®¾ç½®å…¨å±€ï¼Œrolebindingæ­£ç¡® kubectl create rolebinding cicd-clusterrole -n app-team1 --clusterrole=deployment-clusterrole --serviceaccount=app-team1:cicd-token 02 Task - è‹±æ–‡ # Set the node named ek8s-node-1 as unavaliable and reschedule all the pods running on it.</description></item><item><title/><link>https://blog.poneding.com/cka/prepare-cka/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/cka/prepare-cka/</guid><description>ğŸ  é¦–é¡µ / CKA / å‡†å¤‡CKA
å‡†å¤‡CKA # åŠç†æŠ¤ç…§ # ä¼˜æƒ åˆ¸ï¼š
Affkub95-268483
Frequently Asked Questions: CKA and CKAD &amp;amp; CKS - T&amp;amp;C DOC (linuxfoundation.org)
Â« 001
Â» è€ƒé¢˜</description></item><item><title/><link>https://blog.poneding.com/cka/tasks/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/cka/tasks/</guid><description>ğŸ  é¦–é¡µ / CKA / è€ƒé¢˜
è€ƒé¢˜ # kubectl scale deployment nginx --replicas=3 åˆ›å»ºbusyboxï¼š
kubectl run busybox --image=busybox --generator=run-pod/v1 --command=true -- sleep 7d # nslookup kubectl run nginx-dns --image=nginx kubectl run busybox --image=busybox --generator=run-pod/v1 --command=true -- sleep 7d kubectl exec -it busybox -- nslookup nginx-dns kubectl exec -it busybox -- nslookup &amp;lt;pod-ip&amp;gt; etcdå¤‡ä»½å’Œè¿˜åŸï¼š
ETCDCTL_API=3 etcdctl --endpoints=https://[127.0.0.1]:2379 --cacert=/etc/kubernetes/pki/etcd/ca.crt \ --cert=/etc/kubernetes/pki/etcd/server.crt --key=/etc/kubernetes/pki/etcd/server.key \ snapshot save ETCDCTL_API=3 etcdctl --endpoints=https://[127.0.0.1]:2379 --cacert=/etc/kubernetes/pki/etcd/ca.crt \ --name=master \ --cert=/etc/kubernetes/pki/etcd/server.</description></item><item><title/><link>https://blog.poneding.com/cs/internet/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/cs/internet/</guid><description>ğŸ  é¦–é¡µ / è®¡ç®—æœºç§‘å­¦ / äº’è”ç½‘å¦‚ä½•è¿ä½œï¼Ÿ
äº’è”ç½‘å¦‚ä½•è¿ä½œï¼Ÿ # æœ¬ç¯‡æ–‡ç« ç¿»è¯‘è‡ªï¼š åŸæ–‡åœ°å€
ä½œä¸ºå¼€å‘äººå‘˜ï¼Œæ·±å…¥äº†è§£äº’è”ç½‘æ˜¯ä»€ä¹ˆåŠå…¶å·¥ä½œåŸç†éå¸¸é‡è¦ã€‚å®ƒæ˜¯æ„å»ºå¤§å¤šæ•°ç°ä»£è½¯ä»¶åº”ç”¨ç¨‹åºçš„åŸºç¡€ã€‚ä¸ºäº†æ„å»ºæœ‰æ•ˆã€å®‰å…¨ä¸”å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡ï¼Œæ‚¨éœ€è¦æ·±å…¥äº†è§£äº’è”ç½‘çš„å·¥ä½œåŸç†ä»¥åŠå¦‚ä½•åˆ©ç”¨å…¶åŠŸèƒ½å’Œè¿æ¥æ€§ã€‚
åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»äº’è”ç½‘çš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬å®ƒçš„å·¥ä½œåŸç†ã€ä¸€äº›åŸºæœ¬æ¦‚å¿µã€æœ¯è¯­å’Œä¸€äº›ç”¨äºåœ¨äº’è”ç½‘ä¸Šæ„å»ºåº”ç”¨ç¨‹åºå’ŒæœåŠ¡çš„é€šç”¨åè®®ã€‚
æˆ‘ä»¬æœ‰å¾ˆå¤šå†…å®¹è¦ä»‹ç»ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ï¼
äº’è”ç½‘ç®€ä»‹ # åœ¨äº†è§£ä»€ä¹ˆæ˜¯äº’è”ç½‘ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä»€ä¹ˆæ˜¯ç½‘ç»œã€‚ç½‘ç»œæ˜¯ä¸€ç»„ç›¸äº’è¿æ¥çš„è®¡ç®—æœºæˆ–å…¶ä»–è®¾å¤‡ã€‚ä¾‹å¦‚ï¼Œæ‚¨å®¶é‡Œå¯èƒ½æœ‰ä¸€ä¸ªç”±è®¡ç®—æœºå’Œè®¾å¤‡ç»„æˆçš„ç½‘ç»œã€‚æ‚¨ä½åœ¨éš”å£çš„æœ‹å‹å¯èƒ½æœ‰ç±»ä¼¼çš„è®¾å¤‡ç½‘ç»œã€‚ä»–ä»¬çš„é‚»å±…å¯èƒ½æœ‰ç±»ä¼¼çš„è®¾å¤‡ç½‘ç»œã€‚æ‰€æœ‰è¿™äº›ç½‘ç»œè¿æ¥åœ¨ä¸€èµ·å°±å½¢æˆäº†äº’è”ç½‘ã€‚
äº’è”ç½‘æ˜¯ä¸€ä¸ªç½‘ç»œçš„ç½‘ç»œã€‚
äº’è”ç½‘æ˜¯ç¾å›½å›½é˜²éƒ¨äº 20 ä¸–çºª 60 å¹´ä»£æœ«å¼€å‘çš„ï¼Œä½œä¸ºåˆ›å»ºèƒ½å¤ŸæŠµå¾¡æ ¸æ”»å‡»çš„å»ä¸­å¿ƒåŒ–é€šä¿¡ç½‘ç»œçš„ä¸€ç§æ‰‹æ®µã€‚å¤šå¹´æ¥ï¼Œå®ƒå·²å‘å±•æˆä¸ºä¸€ä¸ªéå¸ƒå…¨çƒçš„å¤æ‚è€Œç²¾å¯†çš„ç½‘ç»œã€‚
å¦‚ä»Šï¼Œäº’è”ç½‘å·²æˆä¸ºç°ä»£ç”Ÿæ´»çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸–ç•Œå„åœ°æ•°åäº¿äººä½¿ç”¨äº’è”ç½‘æ¥è·å–ä¿¡æ¯ã€ä¸æœ‹å‹å’Œå®¶äººäº¤æµã€å¼€å±•ä¸šåŠ¡ç­‰ç­‰ã€‚ä½œä¸ºå¼€å‘äººå‘˜ï¼Œå¿…é¡»å……åˆ†äº†è§£äº’è”ç½‘çš„å·¥ä½œåŸç†ä»¥åŠæ”¯æ’‘äº’è”ç½‘çš„å„ç§æŠ€æœ¯å’Œåè®®ã€‚
äº’è”ç½‘å¦‚ä½•è¿ä½œï¼šæ¦‚è¿° # åœ¨è¾ƒé«˜å±‚é¢ä¸Šï¼Œäº’è”ç½‘çš„å·¥ä½œåŸç†æ˜¯ä½¿ç”¨ä¸€ç»„æ ‡å‡†åŒ–åè®®å°†è®¾å¤‡å’Œè®¡ç®—æœºç³»ç»Ÿè¿æ¥åœ¨ä¸€èµ·ã€‚è¿™äº›åè®®å®šä¹‰äº†è®¾å¤‡ä¹‹é—´å¦‚ä½•äº¤æ¢ä¿¡æ¯ï¼Œå¹¶ç¡®ä¿æ•°æ®å¯é ã€å®‰å…¨åœ°ä¼ è¾“ã€‚
äº’è”ç½‘çš„æ ¸å¿ƒæ˜¯äº’è¿è·¯ç”±å™¨çš„å…¨çƒç½‘ç»œï¼Œè´Ÿè´£å¼•å¯¼ä¸åŒè®¾å¤‡å’Œç³»ç»Ÿä¹‹é—´çš„æµé‡ã€‚å½“æ‚¨é€šè¿‡äº’è”ç½‘å‘é€æ•°æ®æ—¶ï¼Œæ•°æ®ä¼šè¢«åˆ†è§£ä¸ºå°æ•°æ®åŒ…ï¼Œç„¶åä»æ‚¨çš„è®¾å¤‡å‘é€åˆ°è·¯ç”±å™¨ã€‚è·¯ç”±å™¨æ£€æŸ¥æ•°æ®åŒ…å¹¶å°†å…¶è½¬å‘åˆ°é€šå¾€ç›®çš„åœ°çš„è·¯å¾„ä¸­çš„ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°æ•°æ®åŒ…åˆ°è¾¾æœ€ç»ˆç›®çš„åœ°ã€‚
ä¸ºäº†ç¡®ä¿æ•°æ®åŒ…çš„æ­£ç¡®å‘é€å’Œæ¥æ”¶ï¼Œäº’è”ç½‘ä½¿ç”¨äº†å¤šç§åè®®ï¼ŒåŒ…æ‹¬äº’è”ç½‘åè®®ï¼ˆIPï¼‰å’Œä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰ã€‚ IP è´Ÿè´£å°†æ•°æ®åŒ…è·¯ç”±åˆ°æ­£ç¡®çš„ç›®çš„åœ°ï¼Œè€Œ TCP ç¡®ä¿æ•°æ®åŒ…ä»¥æ­£ç¡®çš„é¡ºåºå¯é åœ°ä¼ è¾“ã€‚
é™¤äº†è¿™äº›æ ¸å¿ƒåè®®ä¹‹å¤–ï¼Œè¿˜æœ‰è®¸å¤šå…¶ä»–æŠ€æœ¯å’Œåè®®ç”¨äºé€šè¿‡äº’è”ç½‘å®ç°é€šä¿¡å’Œæ•°æ®äº¤æ¢ï¼ŒåŒ…æ‹¬åŸŸåç³»ç»Ÿ (DNS)ã€è¶…æ–‡æœ¬ä¼ è¾“â€‹â€‹åè®® (HTTP) å’Œå®‰å…¨åè®®å¥—æ¥å­—å±‚/ä¼ è¾“å±‚å®‰å…¨ (SSL/TLS) åè®®ã€‚ä½œä¸ºå¼€å‘äººå‘˜ï¼Œæ·±å…¥äº†è§£è¿™äº›ä¸åŒçš„æŠ€æœ¯å’Œåè®®å¦‚ä½•ååŒå·¥ä½œä»¥å®ç°äº’è”ç½‘ä¸Šçš„é€šä¿¡å’Œæ•°æ®äº¤æ¢éå¸¸é‡è¦ã€‚
åŸºæœ¬æ¦‚å¿µå’Œæœ¯è¯­ # è¦äº†è§£äº’è”ç½‘ï¼Œç†Ÿæ‚‰ä¸€äº›åŸºæœ¬æ¦‚å¿µå’Œæœ¯è¯­å¾ˆé‡è¦ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦æ³¨æ„çš„å…³é”®æœ¯è¯­å’Œæ¦‚å¿µï¼š
æ•°æ®åŒ…ï¼šé€šè¿‡äº’è”ç½‘ä¼ è¾“çš„å°æ•°æ®å•ä½ã€‚ è·¯ç”±å™¨ï¼šåœ¨ä¸åŒç½‘ç»œä¹‹é—´å¼•å¯¼æ•°æ®åŒ…çš„è®¾å¤‡ã€‚ IP åœ°å€ï¼šåˆ†é…ç»™ç½‘ç»œä¸Šæ¯ä¸ªè®¾å¤‡çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºå°†æ•°æ®è·¯ç”±åˆ°æ­£ç¡®çš„ç›®çš„åœ°ã€‚ åŸŸåï¼šç”¨äºè¯†åˆ«ç½‘ç«™çš„äººç±»å¯è¯»åç§°ï¼Œä¾‹å¦‚ google.comã€‚ DNSï¼šåŸŸåç³»ç»Ÿè´Ÿè´£å°†åŸŸåè½¬æ¢ä¸ºIPåœ°å€ã€‚ HTTPï¼šè¶…æ–‡æœ¬ä¼ è¾“â€‹â€‹åè®®ç”¨äºåœ¨å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ç½‘ç»œæµè§ˆå™¨ï¼‰å’ŒæœåŠ¡å™¨ï¼ˆä¾‹å¦‚ç½‘ç«™ï¼‰ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚ HTTPSï¼šHTTP çš„åŠ å¯†ç‰ˆæœ¬ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æä¾›å®‰å…¨é€šä¿¡ã€‚ SSL/TLSï¼šå®‰å…¨å¥—æ¥å­—å±‚å’Œä¼ è¾“å±‚å®‰å…¨åè®®ç”¨äºé€šè¿‡äº’è”ç½‘æä¾›å®‰å…¨é€šä¿¡ã€‚ äº†è§£è¿™äº›åŸºæœ¬æ¦‚å¿µå’Œæœ¯è¯­å¯¹äºä½¿ç”¨äº’è”ç½‘å’Œå¼€å‘åŸºäºäº’è”ç½‘çš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡è‡³å…³é‡è¦ã€‚
åè®®åœ¨äº’è”ç½‘ä¸­çš„ä½œç”¨ # åè®®åœ¨é€šè¿‡äº’è”ç½‘è¿›è¡Œé€šä¿¡å’Œæ•°æ®äº¤æ¢æ–¹é¢å‘æŒ¥ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚åè®®æ˜¯ä¸€ç»„è§„åˆ™å’Œæ ‡å‡†ï¼Œå®šä¹‰è®¾å¤‡å’Œç³»ç»Ÿä¹‹é—´å¦‚ä½•äº¤æ¢ä¿¡æ¯ã€‚
äº’è”ç½‘é€šä¿¡ä¸­ä½¿ç”¨è®¸å¤šä¸åŒçš„åè®®ï¼ŒåŒ…æ‹¬äº’è”ç½‘åè®® (IP)ã€ä¼ è¾“æ§åˆ¶åè®® (TCP)ã€ç”¨æˆ·æ•°æ®æŠ¥åè®® (UDP)ã€åŸŸåç³»ç»Ÿ (DNS) ç­‰ã€‚
IP è´Ÿè´£å°†æ•°æ®åŒ…è·¯ç”±åˆ°æ­£ç¡®çš„ç›®çš„åœ°ï¼Œè€Œ TCP å’Œ UDP åˆ™ç¡®ä¿æ•°æ®åŒ…å¯é ä¸”é«˜æ•ˆåœ°ä¼ è¾“ã€‚ DNS ç”¨äºå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€ï¼ŒHTTP ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚</description></item><item><title/><link>https://blog.poneding.com/cs/networking/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/cs/networking/</guid><description>ğŸ  é¦–é¡µ / è®¡ç®—æœºç§‘å­¦ / ç½‘ç»œé€šä¿¡
ç½‘ç»œé€šä¿¡ # I/O æ¨¡å‹ # ã€ŠUNIX ç½‘ç»œç¼–ç¨‹ã€‹ä¸­æ€»ç»“äº† 5 ç§ I/O æ¨¡å‹ï¼ŒåŒ…æ‹¬åŒæ­¥å’Œå¼‚æ­¥ I/Oï¼š
é˜»å¡ I/O (Blocking I/O) éé˜»å¡ I/O (Nonblocking I/O) I/O å¤šè·¯å¤ç”¨ (I/O multiplexing) ä¿¡å·é©±åŠ¨ I/O (Signal driven I/O) å¼‚æ­¥ I/O (Asynchronous I/O) æ“ä½œç³»ç»Ÿä¸Šçš„ I/O æ˜¯ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„æ•°æ®äº¤äº’ã€‚
Â« äº’è”ç½‘å¦‚ä½•è¿ä½œï¼Ÿ
Â» è™šæ‹Ÿå†…å­˜</description></item><item><title/><link>https://blog.poneding.com/cs/virtual-memory/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/cs/virtual-memory/</guid><description>ğŸ  é¦–é¡µ / è®¡ç®—æœºç§‘å­¦ / è™šæ‹Ÿå†…å­˜
è™šæ‹Ÿå†…å­˜ # ä¸ºäº†æ›´åŠ æœ‰æ•ˆçš„ç®¡ç†å†…å­˜å¹¶ä¸”é™ä½å†…å­˜å‡ºé”™çš„æ¦‚ç‡ã€‚
è®¡ç®—æœºå­˜å‚¨å™¨ # é€Ÿåº¦å¿« å®¹é‡å¤§ ä»·æ ¼ä¾¿å®œ ç±»å‹ï¼Œè‡ªä¸Šå‘ä¸‹åˆ†åˆ«æ˜¯å¯„å­˜å™¨ï¼Œé«˜é€Ÿç¼“å­˜ï¼Œä¸»å­˜ï¼ˆRAMï¼‰ï¼Œç£ç›˜ã€‚æˆæœ¬ä¸è®¿é—®é€Ÿåº¦è´Ÿç›¸å…³ã€‚
å¯„å­˜å™¨çš„å®¹é‡ï¼š32 ä½ï¼š32x32 bitå—ï¼Œ64 ä½ï¼š64x64 bit
1 ä¸ªå­—èŠ‚ï¼ˆBytesï¼‰ç­‰äº 8 bitï¼Œå› æ­¤ 1kb æ˜¯ 8x1024 bit
ä¸»å­˜ï¼ˆRAMï¼‰ä¸ CPU ç›´æ¥äº¤æ¢æ•°æ®çš„å†…éƒ¨å­˜å‚¨å™¨ã€‚
ç‰©ç†å†…å­˜ è™šæ‹Ÿå†…å­˜ è™šæ‹Ÿå†…å­˜æ ¸å¿ƒåŸç† # ä¸ºæ¯ä¸ªç¨‹åºè®¾ç½®ä¸€æ®µ&amp;quot;è¿ç»­&amp;quot;çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼ŒæŠŠè¿™ä¸ªåœ°å€ç©ºé—´åˆ†å‰²æˆå¤šä¸ªå…·æœ‰è¿ç»­åœ°å€èŒƒå›´çš„é¡µ (Page)ï¼Œå¹¶æŠŠè¿™äº›é¡µå’Œç‰©ç†å†…å­˜åšæ˜ å°„ï¼Œåœ¨ç¨‹åºè¿è¡ŒæœŸé—´åŠ¨æ€æ˜ å°„åˆ°ç‰©ç†å†…å­˜ã€‚å½“ç¨‹åºå¼•ç”¨åˆ°ä¸€æ®µåœ¨ç‰©ç†å†…å­˜çš„åœ°å€ç©ºé—´æ—¶ï¼Œç”±ç¡¬ä»¶ç«‹åˆ»æ‰§è¡Œå¿…è¦çš„æ˜ å°„ï¼›è€Œå½“ç¨‹åºå¼•ç”¨åˆ°ä¸€æ®µä¸åœ¨ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿè´Ÿè´£å°†ç¼ºå¤±çš„éƒ¨åˆ†è£…å…¥ç‰©ç†å†…å­˜å¹¶é‡æ–°æ‰§è¡Œå¤±è´¥çš„æŒ‡ä»¤ã€‚
å†…å­˜äº¤æ¢ï¼ˆswapï¼‰ # åœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´åªåˆ†é…æ˜ å°„å½“å‰ä½¿ç”¨åˆ°çš„å†…å­˜ï¼Œæš‚æ—¶ä¸ä½¿ç”¨çš„æ•°æ®åˆ™å†™å›ç£ç›˜ä½œä¸ºå‰¯æœ¬ä¿å­˜ï¼Œéœ€è¦ç”¨çš„æ—¶å€™å†è¯»å…¥å†…å­˜ï¼ŒåŠ¨æ€åœ°åœ¨ç£ç›˜å’Œå†…å­˜ä¹‹é—´äº¤æ¢æ•°æ®ã€‚
å‚è€ƒ # è™šæ‹Ÿå†…å­˜ç²¾ç²¹ Â« ç½‘ç»œé€šä¿¡</description></item><item><title/><link>https://blog.poneding.com/dapr/dapr/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/dapr/dapr/</guid><description>ğŸ  é¦–é¡µ / Dapr / Dapr 0-1
Dapr 0-1 # ä»‹ç» # Daprï¼ˆDistributed Application Runtimeï¼‰,æä¾›åˆ†å¸ƒå¼åº”ç”¨è¿è¡Œæ‰€éœ€è¦çš„ç¯å¢ƒã€‚
Sidecaræ¶æ„ã€‚
ç›®çš„ï¼š
å¿«é€Ÿè½åœ°å¾®æœåŠ¡ï¼Œå°†ä¸šåŠ¡å’ŒåŸºç¡€è®¾æ–½åˆ†ç¦»ï¼Œä¸“æ³¨äºä¸šåŠ¡å¼€å‘ï¼Œé™ä½å¾®æœåŠ¡çš„å¤æ‚æ€§ã€‚
è¿è¡Œç¯å¢ƒï¼š
æœåŠ¡å‘ç° è´Ÿè½½å‡è¡¡ æ•…éšœè½¬ç§» ç†”æ–­é™æµ ç¼“å­˜ å¼‚æ­¥é€šä¿¡ æ—¥å¿—ç»„ä»¶ é“¾è·¯ç›‘æ§ &amp;hellip; æ ¸å¿ƒåŠŸèƒ½ï¼š
Service Invocationï¼ˆæœåŠ¡è°ƒç”¨ï¼‰ State Managementï¼ˆçŠ¶æ€ç®¡ç†ï¼‰ Publish and Subscribeï¼ˆæ¶ˆæ¯å‘å¸ƒè®¢é˜…ï¼‰ Resource bingdings and triggersï¼ˆèµ„æºç»‘å®šï¼Œäº‹ä»¶è§¦å‘ï¼‰ Actorsï¼ˆå•çº¿ç¨‹æ¨¡å‹ï¼‰åˆ†å¸ƒå¼é” Observabilityï¼ˆé¥æµ‹ï¼‰ELKï¼Œé“¾è·¯ç›‘æ§ï¼Œå‘Šè­¦ Secretsï¼ˆå®‰å…¨ï¼‰IdentityServer4 å®‰è£… # ä¾èµ– # Dockerï¼š https://docs.docker.com/install/ æ³¨æ„ï¼šwindowså¹³å°ï¼ŒDockerå¿…é¡»è¿è¡ŒLinux Containersæ¨¡å¼
å®‰è£…cli # https://github.com/dapr/cli
ä»¥åœ¨linuxä¸­å®‰è£…daprä¸ºä¾‹ï¼š
wget -q https://raw.githubusercontent.com/dapr/cli/master/install/install.sh -O-|/bin/bash dapr init --runtime-version Service Invocation # è§£å†³å¾®æœåŠ¡ä¹‹é—´é€šä¿¡çš„é—®é¢˜ã€‚</description></item><item><title/><link>https://blog.poneding.com/design-pattern/cicd/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/design-pattern/cicd/</guid><description> ğŸ  é¦–é¡µ / è®¾è®¡æ¨¡å¼ / CI/CD
CI/CD # Concepts # Pipeline # PipelineStage # Fieldsï¼š
Name Type Desc ID string PipelineID string PrevPipelineStageID string Status uint8 Pending, Runing, Success, Failed, Abort Name string PipelineStageTask # Fieldsï¼š
Name Type Desc ID string PipelineStageID string PrevPipelineStageTaskID string Image string Container image task running on. DindRequired boolean Docker in docker? DindImage string dependency DindRequired default: docker:18-dind. Scripts string CacheDirs string EnvironmentVariables string Status string EnvironmentVariables string EnvironmentVariables string</description></item><item><title/><link>https://blog.poneding.com/dev/Apifox-%E5%AF%BC%E5%85%A5-Kubernetes-API/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/dev/Apifox-%E5%AF%BC%E5%85%A5-Kubernetes-API/</guid><description>ğŸ  é¦–é¡µ / å¼€å‘ / Apifox å¯¼å…¥ Kubernetes API
Apifox å¯¼å…¥ Kubernetes API # æœ¬æ¥æœ‰ä¸€ç§å¿«æ·æ–¹å¼ï¼Œä½†æ˜¯å¯¼å…¥æŠ¥é”™ï¼Œæç¤ºæ•°æ®æ ¼å¼ä¸å…¼å®¹ï¼š
Apifox ç›´æ¥ä»¥ Url æ–¹å¼å¯¼å…¥ï¼Œå¯¼å…¥åœ°å€å¦‚ä¸‹ï¼š
https://github.com/kubernetes/kubernetes/blob/master/api/openapi-spec/swagger.json
ç¬¬ä¸€æ­¥ï¼Œæœ¬åœ°ä»£ç†ï¼š
kubectl proxy --address 0.0.0.0 --accept-hosts &amp;#39;^*$&amp;#39; ç¬¬äºŒæ­¥ï¼Œæå– API json æ–‡ä»¶è‡³æœ¬åœ°ï¼š
curl http://localhost:8001/openapi/v2 &amp;gt; k8s-swagger.json ç¬¬ä¸‰æ­¥ï¼ŒApifox å¯¼å…¥å³å®Œæˆã€‚</description></item><item><title/><link>https://blog.poneding.com/devops/agile/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/agile/</guid><description>ğŸ  é¦–é¡µ / DevOps / Agile
Agile # æ•æ· äº¤ä»˜äº§å“å¯ä»¥çœ‹ä½œé¥­åº—ä¸Šèœ é¡¾å®¢ç‚¹äº†åä¸ªèœ åå¨æŠŠåä¸ªèœåšå®Œï¼Œæœ€ååä¸ªèœä¸€èµ·ä¸Šæ¡Œ â€”â€”ä¸æ•æ· åå¨åšå®Œä¸€ä¸ªèœå°±ä¸Šä¸€ä¸ªèœ â€”â€”æ•æ·
æ•æ·çš„ä¼˜ç‚¹ï¼š
åšä¸€ç›˜ä¸Šä¸€ç›˜ï¼Œé¡¾å®¢æ—©æ—©å°±èƒ½åƒä¸Šäº†ï¼Œä¼˜å…ˆæ¨ªæ‰«é¥¥é¥¿ï¼›å°½æ—©ç»™ç”¨æˆ·ä½“éªŒä¸Šäº§å“ï¼› åšä¸€ç›˜ä¸Šä¸€ç›˜ï¼Œæ¯ä¸ªèœéƒ½æ˜¯æ–°å‡ºé”…ï¼Œé¡¾å®¢èƒ½åƒä¸Šä¸€å£çƒ­çš„ï¼›å¯¹æ¯”åç›˜èœä¸€èµ·ä¸Šï¼Œå¯èƒ½å…ˆç‚’çš„èœå·²ç»å‡‰äº†ï¼Œå‡‰çš„èœæ¢åšæˆäº§å“çš„è¯ï¼Œå¯èƒ½å°±æ˜¯å·²ç»è¿‡æ—¶çš„åŠŸèƒ½äº†ï¼Œä¸ç¬¦åˆéœ€æ±‚äº† åšä¸€ç›˜ä¸Šä¸€ç›˜ï¼Œ å¦‚æœå‰é¢çš„èœå’¸äº†ï¼Œå¯ä»¥åé¦ˆç»™é¥­åº—ï¼Œåé¢çš„èœåšæ·¡ç‚¹ï¼›å¯¹æ¯”åç›˜èœä¸€èµ·ä¸Šï¼Œé¡¾å®¢å°±æ— æ³•ä»ä¸­é—´åé¦ˆæ„è§äº†ï¼Œåšä¸€ä¸ªç”¨æˆ·æ’ä¸ä¸Šæ„è§çš„äº§å“ï¼Œä¸¥é‡çš„åæœå¯èƒ½æ˜¯ç”¨æˆ·å·²ç»ä¸æ„Ÿå…´è¶£äº†ã€‚ Â» Ansible</description></item><item><title/><link>https://blog.poneding.com/devops/ansible/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/ansible/</guid><description>ğŸ  é¦–é¡µ / DevOps / Ansible
Ansible # ä»‹ç» # ä¸€æ¬¾è½»é‡çº§çš„è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ï¼Œåªéœ€è¦ä¸€å°ä¸»æœºå®‰è£…Ansibleï¼Œä¾¿å¯ä»¥ç®¡ç†å…¶ä»–å¯è¿é€šçš„LinuxæœåŠ¡å™¨ã€‚
å¼€æº
python
ç‰¹ç‚¹ # è‡ªåŠ¨åŒ–å¼•æ“ï¼Œå®ç°ç®¡ç†é…ç½®ï¼Œåº”ç”¨éƒ¨ç½²ï¼ŒæœåŠ¡ç¼–æ’åŠå…¶ä»–å„ç§æœåŠ¡å™¨ç®¡ç†éœ€æ±‚ï¼› ä½¿ç”¨ç®€å•ï¼Œå…·æœ‰å®¢æˆ·ç«¯çš„ç‰¹ç‚¹ï¼› åŸºäºsshå®ç°é…ç½®ç®¡ç†ï¼› ä¾èµ–pythonï¼› åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒäº‘æœåŠ¡æ“ä½œã€‚ å®‰è£… # â€‹ ç”±äºAnsibleä½¿ç”¨Pythonå¼€å‘ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨pipå®‰è£…
pip install ansible â€‹ ä¹Ÿå¯ä»¥ä½¿ç”¨yumæˆ–apt-getå®‰è£…
yum install ansible -y apt-get install ansible -y ansible --version â€‹ åªéœ€è¦åœ¨Control Nodeä¸Šå®‰è£…å³å¯ã€‚
ä¸»è¦æ¦‚å¿µ # Control nodeï¼š
å®‰è£…äº†Ansibleçš„ä¸»æœºéƒ½å¯ä»¥ç§°ä¹‹ä¸ºControl nodeï¼Œåè¿‡æ¥è¯´ï¼ŒAnsibleå®‰è£…åœ¨Contriol Nodeä¸Šï¼›
ä¸€èˆ¬ä¸ºlinuxæœºå™¨ï¼ˆæ³¨ï¼šç›®å‰ä¹Ÿå·²ç»å¯¹windowsåšäº†æ”¯æŒï¼‰ã€‚
Managed nodesï¼š
å¾…ç®¡ç†çš„ç½‘ç»œè®¾å¤‡æˆ–è€…æœåŠ¡å™¨ï¼›
linuxæœºå™¨ï¼ˆå®‰è£…äº†pythonï¼‰ã€‚
Inventoryï¼š
Modulesï¼š
Tasksï¼š
Ansibleé…ç½® # â€‹ é…ç½®æ–‡ä»¶ä½ç½®ï¼š/etc/ansible/ansible.cfgï¼Œä¸ºiniæ ¼å¼æ–‡ä»¶ã€‚
é…ç½®ç¤ºä¾‹ # â€‹ inventoryï¼šä¸»æœºæ¸…å•é…ç½®æ–‡ä»¶ä½ç½®ï¼Œåœ¨ä½¿ç”¨Ansibleå‘½ä»¤æ—¶ï¼Œä¹Ÿå¼€å§‹-i &amp;lt;path&amp;gt;æŒ‡å®šï¼›
â€‹ host_key_checkingï¼šå½“know_hostsä¸­ä¸å­˜åœ¨çš„ä¸»æœºï¼ˆå³å°šæœªè®¿é—®è¿‡çš„ä¸»æœºï¼Œæ˜¯å¦éœ€è¦è¾“å…¥å¯†é’¥ï¼‰ï¼›
â€‹ become_userï¼šsudoç”¨æˆ·ï¼›</description></item><item><title/><link>https://blog.poneding.com/devops/bule-green-rollback-gray/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/bule-green-rollback-gray/</guid><description>ğŸ  é¦–é¡µ / DevOps / è“ç»¿éƒ¨ç½²ã€æ»šåŠ¨éƒ¨ç½²å’Œç°åº¦éƒ¨ç½²
è“ç»¿éƒ¨ç½²ã€æ»šåŠ¨éƒ¨ç½²å’Œç°åº¦éƒ¨ç½² # ç›´æ¥ä¸¾ä¾‹è¯´æ˜ï¼š
ç°ç¯å¢ƒä¸­è¿è¡Œç€3ä¸ªV1ç‰ˆæœ¬çš„å®ä¾‹ï¼Œè®¡åˆ’æ›´æ–°åˆ°V2ç‰ˆæœ¬ã€‚
è“ç»¿éƒ¨ç½² # ç›´æ¥ä½¿ç”¨æ–°çš„æœåŠ¡èµ„æºéƒ¨ç½²3ä¸ªV2ç‰ˆæœ¬å®ä¾‹ï¼ˆä»ç„¶ä¿ç•™3ä¸ªV1ç‰ˆæœ¬ï¼‰ï¼Œç„¶åå°†è¯·æ±‚æµé‡å…¨éƒ¨è½¬åˆ°V2ç‰ˆæœ¬ã€‚
ä¼˜ç‚¹ï¼š
æ— éœ€ä¸­æ–­æœåŠ¡ï¼›
æœ‰å›æ—‹çš„ä½™åœ°ï¼Œå¦‚æœV2ç‰ˆæœ¬æœ‰bugçš„è¯ï¼Œå¯ä»¥å¾ˆå¿«é€Ÿçš„é‡æ–°å›åˆ°V1ç‰ˆæœ¬ã€‚
ç¼ºç‚¹ï¼š
èµ„æºå ç”¨è¾ƒå¤§ï¼Œåœ¨å‘å¸ƒè¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°6ä¸ªå®ä¾‹çš„æœåŠ¡èµ„æºã€‚
æ»šåŠ¨éƒ¨ç½² # ç°åœæ‰ä¸€ä¸ªV1ç‰ˆæœ¬çš„å®ä¾‹ï¼Œå¾…å…¶åœæ­¢åï¼Œéƒ¨ç½²ä¸€ä¸ªV2ç‰ˆæœ¬çš„å®ä¾‹ï¼ŒV2å®ä¾‹éƒ¨ç½²æˆåŠŸä¹‹åï¼Œå†åœæ‰ä¸€ä¸ªV1å®ä¾‹ï¼Œå¾€å¤ï¼Œç›´è‡³å…¨éƒ¨æ›¿æ¢ä¸ºV2ç‰ˆæœ¬å®ä¾‹ã€‚
ä¼˜ç‚¹ï¼š
æ— éœ€ä¸­æ–­æœåŠ¡ï¼›
éƒ¨ç½²æ–°ç‰ˆæœ¬æ—¶æ— éœ€å¢åŠ æœåŠ¡èµ„æºï¼ŒèŠ‚çœæˆæœ¬ã€‚
ç¼ºç‚¹ï¼š
V2ç‰ˆæœ¬æœ‰bugçš„è¯ï¼Œä¸èƒ½åŠæ—¶å›æ»šã€‚
ç°åº¦éƒ¨ç½² # ä¹Ÿå«é‡‘ä¸é›€éƒ¨ç½²ï¼Œåœæ‰ä¸€ä¸ªV1ç‰ˆæœ¬çš„å®ä¾‹ï¼Œéƒ¨ç½²ä¸€ä¸ªV2ç‰ˆæœ¬çš„å®ä¾‹ï¼Œå°†éƒ¨åˆ†ç”¨æˆ·è¯·æ±‚æµé‡çš„è½¬åˆ°V2ç‰ˆæœ¬ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œå†é€æ­¥æ›¿æ¢V1ç‰ˆæœ¬ã€‚A/Bæµ‹è¯•å°±æ˜¯ä¸€ç§ç°åº¦å‘å¸ƒã€‚
ä¼˜ç‚¹ï¼š
æ— éœ€ä¸­æ–­æœåŠ¡ï¼›
åŒæ ·æ— éœ€å¢åŠ æœåŠ¡å™¨ï¼Œèƒ½è¾ƒä¸ºå¹³ç¨³çš„è¿‡æ¸¡åˆ°æ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸”å½“æœ‰bugæ—¶ä¹Ÿèƒ½åšåˆ°å¿«é€Ÿå›æ»šã€‚
Â« Ansible
Â» æ··æ²Œå·¥ç¨‹åŸåˆ™ ï¼ˆPRINCIPLES OF CHAOS ENGINEERINGï¼‰</description></item><item><title/><link>https://blog.poneding.com/devops/chaos-engineering/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/chaos-engineering/</guid><description>ğŸ  é¦–é¡µ / DevOps / æ··æ²Œå·¥ç¨‹åŸåˆ™ ï¼ˆPRINCIPLES OF CHAOS ENGINEERINGï¼‰
æ··æ²Œå·¥ç¨‹åŸåˆ™ ï¼ˆPRINCIPLES OF CHAOS ENGINEERINGï¼‰ # http://principlesofchaos.org/ ç®€ä½“ä¸­æ–‡ç‰ˆ
æ··æ²Œå·¥ç¨‹æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸Šè¿›è¡Œå®éªŒçš„å­¦ç§‘, ç›®çš„æ˜¯å»ºç«‹å¯¹ç³»ç»ŸæŠµå¾¡ç”Ÿäº§ç¯å¢ƒä¸­å¤±æ§æ¡ä»¶çš„èƒ½åŠ›ä»¥åŠä¿¡å¿ƒã€‚ï¼š
å¤§è§„æ¨¡åˆ†å¸ƒå¼è½¯ä»¶ç³»ç»Ÿçš„å‘å±•æ­£åœ¨æ”¹å˜è½¯ä»¶å·¥ç¨‹ã€‚ä½œä¸ºä¸€ä¸ªè¡Œä¸šï¼Œæˆ‘ä»¬å¾ˆå¿«é‡‡ç”¨äº†æé«˜å¼€å‘çµæ´»æ€§å’Œéƒ¨ç½²é€Ÿåº¦çš„å®è·µã€‚ç´§éšç€è¿™äº›ä¼˜ç‚¹çš„ä¸€ä¸ªè¿«åˆ‡é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬å¯¹æŠ•å…¥ç”Ÿäº§çš„å¤æ‚ç³»ç»Ÿæœ‰å¤šå°‘ä¿¡å¿ƒï¼Ÿ
å³ä½¿åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰å•ä¸ªæœåŠ¡éƒ½æ­£å¸¸è¿è¡Œ, è¿™äº›æœåŠ¡ä¹‹é—´çš„äº¤äº’ä¹Ÿä¼šå¯¼è‡´ä¸å¯é¢„çŸ¥çš„ç»“æœã€‚ è¿™äº›ä¸å¯é¢„çŸ¥çš„ç»“æœ, ç”±å½±å“ç”Ÿäº§ç¯å¢ƒçš„ç½•è§ä¸”ç ´åæ€§çš„äº‹ä»¶å¤åˆè€Œæˆï¼Œä»¤è¿™äº›åˆ†å¸ƒå¼ç³»ç»Ÿå­˜åœ¨å†…åœ¨çš„æ··æ²Œã€‚
æˆ‘ä»¬éœ€è¦åœ¨å¼‚å¸¸è¡Œä¸ºå‡ºç°ä¹‹å‰ï¼Œåœ¨æ•´ä¸ªç³»ç»Ÿå†…æ‰¾å‡ºè¿™äº›å¼±ç‚¹ã€‚è¿™äº›å¼±ç‚¹åŒ…æ‹¬ä»¥ä¸‹å½¢å¼:
å½“æœåŠ¡ä¸å¯ç”¨æ—¶çš„ä¸æ­£ç¡®å›æ»šè®¾ç½®; ä¸å½“çš„è¶…æ—¶è®¾ç½®å¯¼è‡´çš„é‡è¯•é£æš´; ç”±äºä¸‹æ¸¸ä¾èµ–çš„æµé‡è¿‡è½½å¯¼è‡´çš„æœåŠ¡ä¸­æ–­; å•ç‚¹æ•…éšœæ—¶çš„çº§è”å¤±è´¥ç­‰ã€‚ æˆ‘ä»¬å¿…é¡»ä¸»åŠ¨çš„å‘ç°è¿™äº›é‡è¦çš„å¼±ç‚¹ï¼Œåœ¨è¿™äº›å¼±ç‚¹é€šè¿‡ç”Ÿäº§ç¯å¢ƒæš´éœ²ç»™æˆ‘ä»¬çš„ç”¨æˆ·ä¹‹å‰ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥ç®¡ç†è¿™äº›ç³»ç»Ÿå›ºæœ‰çš„æ··æ²Œ, é€šè¿‡å¢åŠ çš„çµæ´»æ€§å’Œé€Ÿç‡ä»¥æå‡æˆ‘ä»¬å¯¹ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„ä¿¡å¿ƒ, å°½ç®¡ç³»ç»Ÿçš„å¤æ‚æ€§æ˜¯ç”±è¿™äº›éƒ¨ç½²æ‰€å¯¼è‡´çš„ã€‚
æˆ‘ä»¬é‡‡ç”¨åŸºäºç»éªŒå’Œç³»ç»Ÿçš„æ–¹æ³•è§£å†³äº†åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨è§„æ¨¡å¢é•¿æ—¶å¼•å‘çš„é—®é¢˜, å¹¶ä»¥æ­¤å»ºç«‹å¯¹ç³»ç»ŸæŠµå¾¡è¿™äº›äº‹ä»¶çš„èƒ½åŠ›å’Œä¿¡å¿ƒã€‚é€šè¿‡åœ¨å—æ§å®éªŒä¸­è§‚å¯Ÿåˆ†å¸ƒå¼ç³»ç»Ÿçš„è¡Œä¸ºæ¥äº†è§£å®ƒçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ··æ²Œå·¥ç¨‹ã€‚
æ··æ²Œå·¥ç¨‹å®è·µ # ä¸ºäº†å…·ä½“åœ°è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨è§„æ¨¡ä¸Šçš„ä¸ç¡®å®šæ€§ï¼Œå¯ä»¥æŠŠæ··æ²Œå·¥ç¨‹çœ‹ä½œæ˜¯ä¸ºäº†æ­ç¤ºç³»ç»Ÿå¼±ç‚¹è€Œè¿›è¡Œçš„å®éªŒã€‚è¿™äº›å®éªŒéµå¾ªå››ä¸ªæ­¥éª¤ï¼š
é¦–å…ˆï¼Œç”¨ç³»ç»Ÿåœ¨æ­£å¸¸è¡Œä¸ºä¸‹çš„ä¸€äº›å¯æµ‹é‡çš„è¾“å‡ºæ¥å®šä¹‰â€œç¨³å®šçŠ¶æ€â€ã€‚ å…¶æ¬¡ï¼Œå‡è®¾è¿™ä¸ªåœ¨æ§åˆ¶ç»„å’Œå®éªŒç»„éƒ½ä¼šç»§ç»­ä¿æŒç¨³å®šçŠ¶æ€ã€‚ ç„¶åï¼Œåœ¨å®éªŒç»„ä¸­å¼•å…¥åæ˜ çœŸå®ä¸–ç•Œäº‹ä»¶çš„å˜é‡ï¼Œå¦‚æœåŠ¡å™¨å´©æºƒã€ç¡¬ç›˜æ•…éšœã€ç½‘ç»œè¿æ¥æ–­å¼€ç­‰ã€‚ æœ€åï¼Œé€šè¿‡æ§åˆ¶ç»„å’Œå®éªŒç»„ä¹‹é—´çš„çŠ¶æ€å·®å¼‚æ¥åé©³ç¨³å®šçŠ¶æ€çš„å‡è¯´ã€‚ ç ´åç¨³æ€çš„éš¾åº¦è¶Šå¤§ï¼Œæˆ‘ä»¬å¯¹ç³»ç»Ÿè¡Œä¸ºçš„ä¿¡å¿ƒå°±è¶Šå¼ºã€‚å¦‚æœå‘ç°äº†ä¸€ä¸ªå¼±ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªæ”¹è¿›ç›®æ ‡ã€‚é¿å…åœ¨ç³»ç»Ÿè§„æ¨¡åŒ–ä¹‹åè¢«æ”¾å¤§ã€‚
é«˜çº§åŸåˆ™ # ä»¥ä¸‹åŸåˆ™æè¿°äº†åº”ç”¨æ··æ²Œå·¥ç¨‹çš„ç†æƒ³æ–¹å¼ï¼Œè¿™äº›åŸåˆ™åŸºäºä¸Šè¿°å®éªŒè¿‡ç¨‹ã€‚å¯¹è¿™äº›åŸåˆ™çš„åŒ¹é…ç¨‹åº¦èƒ½å¤Ÿå¢å¼ºæˆ‘ä»¬åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¿¡å¿ƒã€‚
å»ºç«‹ä¸€ä¸ªå›´ç»•ç¨³å®šçŠ¶æ€è¡Œä¸ºçš„å‡è¯´ # è¦å…³æ³¨ç³»ç»Ÿçš„å¯æµ‹é‡è¾“å‡º, è€Œä¸æ˜¯ç³»ç»Ÿçš„å±æ€§ã€‚å¯¹è¿™äº›è¾“å‡ºåœ¨çŸ­æ—¶é—´å†…çš„åº¦é‡æ„æˆäº†ç³»ç»Ÿç¨³å®šçŠ¶æ€çš„ä¸€ä¸ªä»£ç†ã€‚ æ•´ä¸ªç³»ç»Ÿçš„ååé‡ã€é”™è¯¯ç‡ã€å»¶è¿Ÿç™¾åˆ†ç‚¹ç­‰éƒ½å¯èƒ½æ˜¯è¡¨ç¤ºç¨³æ€è¡Œä¸ºçš„æŒ‡æ ‡ã€‚ é€šè¿‡åœ¨å®éªŒä¸­çš„ç³»ç»Ÿæ€§è¡Œä¸ºæ¨¡å¼ä¸Šçš„å…³æ³¨, æ··æ²Œå·¥ç¨‹éªŒè¯äº†ç³»ç»Ÿæ˜¯å¦æ­£å¸¸å·¥ä½œ, è€Œä¸æ˜¯è¯•å›¾éªŒè¯å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚
å¤šæ ·åŒ–çœŸå®ä¸–ç•Œçš„äº‹ä»¶ # æ··æ²Œå˜é‡åæ˜ äº†ç°å®ä¸–ç•Œä¸­çš„äº‹ä»¶ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡æ½œåœ¨å½±å“æˆ–ä¼°è®¡é¢‘ç‡æ’å®šè¿™äº›äº‹ä»¶çš„ä¼˜å…ˆçº§ã€‚è€ƒè™‘ä¸ç¡¬ä»¶æ•…éšœç±»ä¼¼çš„äº‹ä»¶, å¦‚æœåŠ¡å™¨å®•æœºã€è½¯ä»¶æ•…éšœ (å¦‚é”™è¯¯å“åº”) å’Œéæ•…éšœäº‹ä»¶ (å¦‚æµé‡æ¿€å¢æˆ–ä¼¸ç¼©äº‹ä»¶)ã€‚ ä»»ä½•èƒ½å¤Ÿç ´åç¨³æ€çš„äº‹ä»¶éƒ½æ˜¯æ··æ²Œå®éªŒä¸­çš„ä¸€ä¸ªæ½œåœ¨å˜é‡ã€‚
åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œå®éªŒ # ç³»ç»Ÿçš„è¡Œä¸ºä¼šä¾æ®ç¯å¢ƒå’Œæµé‡æ¨¡å¼éƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ ç”±äºèµ„æºä½¿ç”¨ç‡å˜åŒ–çš„éšæ—¶å¯èƒ½å‘ç”Ÿ, å› æ­¤é€šè¿‡é‡‡é›†å®é™…æµé‡æ˜¯æ•è·è¯·æ±‚è·¯å¾„çš„å”¯ä¸€å¯é æ–¹æ³•ã€‚ ä¸ºäº†ä¿è¯ç³»ç»Ÿæ‰§è¡Œæ–¹å¼çš„çœŸå®æ€§ä¸å½“å‰éƒ¨ç½²ç³»ç»Ÿçš„ç›¸å…³æ€§, æ··æ²Œå·¥ç¨‹å¼ºçƒˆæ¨èç›´æ¥é‡‡ç”¨ç”Ÿäº§ç¯å¢ƒæµé‡è¿›è¡Œå®éªŒã€‚</description></item><item><title/><link>https://blog.poneding.com/devops/commercial-canvas/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/commercial-canvas/</guid><description>ğŸ  é¦–é¡µ / DevOps / å•†ä¸šç”»å¸ƒ
å•†ä¸šç”»å¸ƒ # ç”¨æ¥æè¿°å•†ä¸šæ¨¡å¼ã€å¯è§†åŒ–å•†ä¸šæ¨¡å¼ã€è¯„ä¼°å•†ä¸šæ¨¡å¼ä»¥åŠæ”¹å˜å•†ä¸šæ¨¡å¼çš„é€šç”¨è¯­è¨€ã€‚
å•†ä¸šæ¨¡å¼ï¼šé€šè¿‡å•†ä¸šäº§å“åˆ›é€ ä»·å€¼ï¼Œä¼ é€’ä»·å€¼ï¼Œè·å–ä»·å€¼çš„ä¸€ç§åŸç†ã€‚
ä¹ä¸ªæ¨¡å— # CSå®¢æˆ·ç»†åˆ†ï¼ˆCustomer Segmentsï¼‰ï¼šä¼ä¸šæˆ–æœºæ„æ‰€æœåŠ¡çš„ä¸€ä¸ªæˆ–å¤šä¸ªå®¢æˆ·åˆ†ç±»ç¾¤ä½“ã€‚
VPä»·å€¼ä¸»å¼ ï¼ˆValue Propositionsï¼‰ï¼šé€šè¿‡ä»·å€¼ä¸»å¼ æ¥è§£å†³å®¢æˆ·éš¾é¢˜å’Œæ»¡è¶³å®¢æˆ·éœ€æ±‚ã€‚
CHæ¸ é“é€šè·¯ï¼ˆChannelsï¼‰ï¼šé€šè¿‡æ²Ÿé€šã€åˆ†é”€å’Œé”€å”®æ¸ é“å‘å®¢æˆ·ä¼ é€’ä»·å€¼ä¸»å¼ ã€‚
CRå®¢æˆ·å…³ç³»ï¼ˆCustomer Relationshipsï¼‰ï¼šåœ¨æ¯ä¸€ä¸ªå®¢æˆ·ç»†åˆ†å¸‚åœºå»ºç«‹å’Œç»´æŠ¤å®¢æˆ·å…³ç³»ã€‚
R$æ”¶å…¥æ¥æºï¼ˆRevenue Streamsï¼‰ï¼šæ”¶å…¥æ¥æºäº§ç”ŸäºæˆåŠŸæä¾›ç»™å®¢æˆ·çš„ä»·å€¼ä¸»å¼ ã€‚
KRæ ¸å¿ƒèµ„æºï¼ˆKey Resouresï¼‰ï¼šæ ¸å¿ƒèµ„æºæ˜¯æä¾›å’Œäº¤ä»˜å…ˆå‰æè¿°è¦ç´ æ‰€å¿…å¤‡çš„é‡è¦èµ„äº§ã€‚
KAå…³é”®ä¸šåŠ¡ï¼ˆKey Activitiesï¼‰ï¼šé€šè¿‡æ‰§è¡Œä¸€äº›å…³é”®ä¸šåŠ¡æ´»åŠ¨ï¼Œè¿è½¬å•†ä¸šæ¨¡å¼ã€‚
KPé‡è¦åˆä½œï¼ˆKey Partnershipï¼‰ï¼šæœ‰äº›ä¸šåŠ¡è¦å¤–åŒ…ï¼Œè€Œå¦å¤–ä¸€äº›èµ„æºéœ€è¦ä»ä¼ä¸šå¤–éƒ¨è·å¾—ã€‚
C$æˆæœ¬ç»“æ„ï¼ˆCost Structureï¼‰ï¼šå•†ä¸šæ¨¡å¼ä¸Šè¿°è¦ç´ æ‰€å¼•å‘çš„æˆæœ¬æ„æˆã€‚
åŸºæœ¬è®¤çŸ¥ # å®¢æˆ·ç»†åˆ† # å®¢æˆ·æ˜¯å•†ä¸šæ¨¡å¼çš„æ ¸å¿ƒã€‚å“ªäº›æ˜¯é‡è¦å®¢æˆ·
Â« æ··æ²Œå·¥ç¨‹åŸåˆ™ ï¼ˆPRINCIPLES OF CHAOS ENGINEERINGï¼‰
Â» ä½¿ç”¨grafanaç›‘æ§5xxæœåŠ¡</description></item><item><title/><link>https://blog.poneding.com/devops/grafana-monite-service-with-5xx/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/grafana-monite-service-with-5xx/</guid><description>ğŸ  é¦–é¡µ / DevOps / ä½¿ç”¨grafanaç›‘æ§5xxæœåŠ¡
ä½¿ç”¨grafanaç›‘æ§5xxæœåŠ¡ # 1. Grafanaä¿¡æ¯ # grafanaæœåŠ¡ï¼š https://devops.example.com/grafana
å¦‚æœè¦æ³¨å†Œè´¦å·è¯·è”ç³»devopsç»„ã€‚
2. Grafanaç›‘æ§é¢„è§ˆ # grafanaå·²ç»é…ç½®äº†å¯¹service.hompartners.comåŸŸåä¸‹çš„serviceè®¿é—®çŠ¶æ€è¿”å›5xxçš„ç›‘æ§ï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”çš„grafanaé¢æ¿ https://devops.example.com/grafana/d/Q_zv-HrWz/cst-service-status?orgId=1
è¯¥ç›‘æ§é¢æ¿ä¸­å¯ä»¥æŸ¥çœ‹å¦‚userapiã€emailapiç­‰æœåŠ¡æ˜¯å¦æ­£å¸¸ï¼Œå½“é¢æ¿çš„ç½‘æ ¼è§†å›¾ä¸­å‡ºç°çº¢ç‚¹ï¼Œè¯´æ˜è®¿é—®å¯¹åº”çš„æœåŠ¡è¿”å›äº†5xxçŠ¶æ€ï¼Œå³æœåŠ¡ç«¯å¼‚å¸¸ã€‚å¼€å‘äººå‘˜ç­‰å¯ä»¥æ ¹æ®è¯¥è§†å›¾åŠæ—¶å‘ç°æœåŠ¡å¼‚å¸¸æƒ…å†µã€‚
3. Grafanaæ·»åŠ ç›‘æ§5xxæœåŠ¡ # å¦‚æœé¡¹ç»§ç»­æ·»åŠ Grafanaé¢æ¿æ¥ç›‘æ§æ›´å¤šçš„æœåŠ¡ï¼Œè¯·å‚ç…§ä»¥ä¸‹æ•™ç¨‹ã€‚
Step 1 å¤åˆ¶æ¨¡æ¿è§†å›¾ï¼š
é€‰ä¸­å¹¶è¿›å…¥xxx service http_status_5xx templateé¢æ¿ï¼ŒæŒ‰æ“ä½œå¦‚ä¸‹å¤åˆ¶xxx.xxx.com http_status_5xxè§†å›¾
ï¼ˆå¯é€šè¿‡è¯¥é“¾æ¥è®¿é—®ï¼š https://devops.example.com/grafana/d/XNnusprWz/xxx-service-http_status_5xx-template?orgId=1ï¼‰
Step 2 åˆ›å»ºæ–°é¢æ¿ï¼š
æŒ‰å¦‚ä¸‹æ“ä½œåˆ›å»ºæ–°é¢æ¿å¹¶ç²˜è´´è§†å›¾ã€‚
éšåä¼šåœ¨é¡µé¢å‘ˆç°ä¸€ä¸ªè§†å›¾ï¼Œè¿™æ—¶å¯ä»¥å…ˆç¼–è¾‘é¢æ¿ä¿¡æ¯ï¼Œå¹¶æ–°å‘½åï¼Œé€‰æ‹©é¢æ¿åˆ†ç±»ï¼Œå¹¶ä¿å­˜é¢æ¿ä¿¡æ¯ã€‚
Step 3 å®šåˆ¶xxx.xxx.com http_status_5xxè§†å›¾ï¼š
ä¿å­˜å®Œæˆä¹‹åï¼Œç‚¹å‡»å·¦ä¸Šè§’çš„å›é€€ç®­å¤´å›¾æ ‡ï¼š&amp;lt;&amp;ndash;ï¼Œå›åˆ°è§†å›¾é¡µé¢ï¼ŒæŒ‰å¦‚ä¸‹æ“ä½œç¼–è¾‘è§†å›¾ã€‚
ä¿®æ”¹æŸ¥è¯¢sqlè¯­å¥ï¼ŒåŸŸåä¿®æ”¹ä¸ºè¦ç›‘æ§çš„åŸŸåæˆ–æœåŠ¡åï¼Œæ¯”å¦‚ä½ æƒ³ç›‘æ§www.example.comåŸŸåä¸‹æ‰€æœ‰æœåŠ¡ï¼Œé‚£ä¹ˆä½ å¯ä»¥å®šåˆ¶sqlå¦‚ä¸‹ï¼š
SELECT &amp;#34;service_code&amp;#34; FROM &amp;#34;service_status&amp;#34; WHERE (&amp;#34;health_code&amp;#34; = 500 AND &amp;#34;domain_name&amp;#34; = &amp;#39;www.example.com&amp;#39;) AND $timeFilter GROUP BY &amp;#34;service_name&amp;#34; ï¼Œå½“ç„¶ä½ å¯èƒ½åªæƒ³ç›‘æ§æŸä¸ªåŸŸåä¸‹çš„å…¶ä¸­ä¸€ä¸ªæœåŠ¡ï¼Œå¦‚ä½ æƒ³ç›‘æ§www.example.comåŸŸåä¸‹operationplatgformæœåŠ¡ï¼Œé‚£ä¹ˆä½ å¯ä»¥å®šåˆ¶sqlå¦‚ä¸‹ï¼š
SELECT &amp;#34;service_code&amp;#34; FROM &amp;#34;service_status&amp;#34; WHERE (&amp;#34;health_code&amp;#34; = 500 AND &amp;#34;domain_name&amp;#34; = &amp;#39;www.</description></item><item><title/><link>https://blog.poneding.com/devops/grafana-monite-service/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/grafana-monite-service/</guid><description>ğŸ  é¦–é¡µ / DevOps / ä½¿ç”¨Grafanaç›‘æ§service
ä½¿ç”¨Grafanaç›‘æ§service # ç›‘æ§liveä¸Šçš„åº”ç”¨æœåŠ¡,å¦‚æœæœåŠ¡httpçŠ¶æ€ä¸º5xx,åˆ™ååº”åˆ°grafanaå›¾è¡¨ä¸­,DevOpså’Œå¼€å‘äººå‘˜éƒ½èƒ½åŠæ—¶ä»å›¾è¡¨ä¸­è·å–ä¿¡æ¯,åŠæ—¶ç¡®è®¤å’Œæ’æŸ¥é—®é¢˜.
Service HttpçŠ¶æ€æ•°æ®æ¥æº # ä½¿ç”¨ç¨‹åºå®šæ—¶è½®è¯¢è·å–aws elbçš„æ—¥å¿—æ•°æ®,å°†æ—¥å¿—æ•°æ®ä»¥æ—¶åºå½¢å¼å­˜å‚¨åœ¨influxdb,ç›®å‰æ•°æ®ç»“æ„å¦‚ä¸‹:
tag keys:
# TagKeyName Remark 1 domain_name 2 service_name é»˜è®¤å–pathbase,å¦‚æœpathbaseä¸ºç©º,å–domain field keys:
# FieldKeyName Remark 1 domain_name 2 elb_status_code æ•°å­—ç±»å‹,200;500 3 health_code æ•°å­—ç±»å‹,200;500 4 request_url è¯·æ±‚è·¯å¾„ 5 service_code ä¸€ä¸ªåŸŸåä¸‹çš„å¤šä¸ªservice,æŒ‰åºä»1è‡ªå¢,ä½œä¸ºgrafanaå›¾è¡¨çš„yè½´æ•°æ® åˆ›å»ºDashboard # =&amp;gt; Add Query
ç›®å‰æ•°æ®æºå·²ç»é…ç½®å®Œæˆï¼Œé€‰æ‹©Influxdb_Elb_Logsä½œä¸ºQUuery DataSourceï¼Œå¹¶ä¸”å¼€å§‹é…ç½®query
æŸ¥è¯¢è¯­å¥å¯ä»¥å‚è€ƒï¼š
SELECT mean(&amp;#34;service_code&amp;#34;) FROM &amp;#34;service_status&amp;#34; WHERE (&amp;#34;domain_name&amp;#34; = &amp;#39;service.example.com&amp;#39; AND &amp;#34;health_code&amp;#34; = 500) AND $timeFilter GROUP BY time($__interval), &amp;#34;service_name&amp;#34; æ ¹æ®è‡ªèº«éœ€æ±‚ä¿®æ”¹queryå³å¯ã€‚</description></item><item><title/><link>https://blog.poneding.com/devops/grafana/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/grafana/</guid><description>ğŸ  é¦–é¡µ / DevOps / Grafana
Grafana # å®˜æ–¹æ–‡æ¡£ï¼š https://grafana.com/docs/grafana/latest/
ç®€ä»‹ # ç‰¹æ€§ # å¯è§†åŒ–ï¼šé€šè¿‡å›¾è¡¨å±•ç¤ºæŒ‡æ ‡ä¿¡æ¯ï¼Œç›´è§‚ï¼Œä¾¿äºåˆ†æ
æŠ¥è­¦ï¼šæŒ‡æ ‡æ•°æ®è¶…å‡ºé˜ˆå€¼
ç»Ÿä¸€ï¼šå¤šç§æ•°æ®æºå¯ä»¥åº”ç”¨åˆ°åŒä¸€ä¸ªDashboardä¸­
å¤šå¹³å°æ”¯æŒï¼šwindowsã€linuxã€dockerã€mac
ä¸°å¯Œçš„æ’ä»¶æ‰©å±•
ä¸°å¯Œçš„æ¨¡æ¿æ”¯æŒ
ä½¿ç”¨Grafanaç›‘æ§Jenkins # ç›‘æ§æŒ‡æ ‡åŒ…æ‹¬:jenkinså‘å¸ƒçŠ¶æ€,jenkinsçš„å‘å¸ƒæ—¶é•¿ç­‰.
å‰ææ¡ä»¶ # å·²å®‰è£…jenkins
å·²å®‰è£…prometheus
å·²å®‰è£…grafana
Jenkinså®‰è£…æ’ä»¶ # ç™»å…¥Jenkins =&amp;gt; Manage Jenkins =&amp;gt; Manage Plugins =&amp;gt; Availableé¡µç­¾ æœç´¢Prometheusæ’ä»¶,å®‰è£…å³å¯.
æ­¤èŠ‚å¯ä»¥å‚è€ƒ: https://medium.com/@eng.mohamed.m.saeed/monitoring-jenkins-with-grafana-and-prometheus-a7e037cbb376
Â« ä½¿ç”¨Grafanaç›‘æ§service
Â» Jaeger</description></item><item><title/><link>https://blog.poneding.com/devops/jeager/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/jeager/</guid><description>ğŸ  é¦–é¡µ / DevOps / Jaeger
Jaeger # å‰è¨€ # å¾®æœåŠ¡ä¹‹é—´çš„è°ƒç”¨å…³ç³»é”™ç»¼å¤æ‚ï¼Œå½“ä½ åœ¨äº¬ä¸œä¸‹å•æ—¶ï¼Œåº”ç”¨èƒŒåçš„æœåŠ¡è°ƒç”¨é“¾å¯èƒ½è¶…ä½ æƒ³è±¡ã€‚è°ƒç”¨é“¾çš„è¿½è¸ªæ˜¯å¾®æœåŠ¡ç»•ä¸è¿‡å»çš„æŠ€æœ¯æ ˆï¼Œ
ç®€ä»‹ # å…³äº # Jaegerï¼Œå—Dapperå’ŒOpenZipkinå¯å‘ï¼Œç”±Uberå¼€æºçš„ä¸€ä¸ªåˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿï¼Œç”¨äºåŸºäºå¾®æœåŠ¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç›‘æ§å’Œæ’é”™ï¼ŒåŒ…æ‹¬ï¼š
åˆ†å¸ƒå¼ä¸Šä¸‹æ–‡ä¼ é€’ åˆ†å¸ƒå¼äº‹åŠ¡ç›‘æ§ é—®é¢˜æ ¹ç”±åˆ†æ æœåŠ¡ä¾èµ–åˆ†æ æ€§èƒ½ã€å»¶è¿Ÿä¼˜åŒ– åŠŸèƒ½ # å…¼å®¹OpenTracingæ•°æ®æ¨¡å‹å’Œå·¥å…·åº“ å¯¹æ¯ä¸ªæœåŠ¡ã€ç«¯ç‚¹ä½¿ç”¨ä¸€è‡´çš„æŠ½æ ·æ¦‚ç‡ æ”¯æŒå¤šæ ·çš„åç«¯æ•°æ®åº“ï¼šCassandraï¼ŒElasticsearchï¼ŒMemory è¿½è¸ªæ•°æ®æ‹“æ‰‘å›¾å½¢å±•ç¤º åŸºç¡€æ¦‚å¿µ # Spanï¼š
è·¨åº¦ï¼Œæ˜¯è·¨æœåŠ¡çš„ä¸€æ¬¡è°ƒç”¨ã€‚åŒ…å«åç§°ï¼Œå¼€å§‹æ—¶é—´å’Œæˆªæ­¢æ—¶é—´ï¼ŒSpanä¹‹é—´å¯ä»¥å¹¶åˆ—ï¼Œä¹Ÿå¯ä»¥åµŒå¥—ã€‚
Traceï¼š
æ˜¯ä¸€æ¬¡å®Œæˆçš„åˆ†å¸ƒå¼è°ƒç”¨é“¾ï¼ŒåŒ…å«å¤šä¸ªSpan
æŠ€æœ¯è§„æ ¼ # åç«¯Goè¯­è¨€å®ç° å‰ç«¯React/Javascript æ”¯æŒçš„æ•°æ®åº“ï¼šCassandra3.4+ï¼ŒElasticsearch5.x+ï¼ŒKafka&amp;hellip; ç»„ä»¶ä»‹ç» # jaeger-clientï¼š
jaegerå®¢æˆ·ç«¯ï¼Œå¯ä»¥ä½¿ç”¨å¤šç§ä¸»æµè¯­è¨€å®ç°OpenTracingåè®®ï¼Œå°†è°ƒç”¨é“¾æ•°æ®æ”¶é›†åˆ°agentã€‚
jaeger-agentï¼š
jaegerçš„ä»£ç†ç¨‹åºï¼Œå°†æ”¶é›†åˆ°çš„clientè°ƒç”¨é“¾æ•°æ®ä¸ŠæŠ¥åˆ°collectorã€‚
jaeger-collectorï¼š
jaegerè°ƒç”¨é“¾æ•°æ®æ”¶é›†å™¨ï¼Œå¯¹æ”¶é›†åˆ°çš„è°ƒç”¨é“¾æ•°æ®è¿›è¡Œæ ¡éªŒï¼Œå¤„ç†ï¼Œå­˜å‚¨åˆ°åç«¯æ•°æ®åº“ã€‚
jaeger-queryï¼š
jaegerè°ƒç”¨é“¾æ•°æ®æŸ¥è¯¢æœåŠ¡ï¼Œæœ‰ç‹¬ç«‹UIã€‚
OpenTracing # åˆ†å¸ƒå¼çš„è¿½è¸ªç³»ç»Ÿå…¶å®ä¸æ­¢Jaegerä¸€ç§ï¼Œä½†æ˜¯å®ƒä»¬çš„æ ¸å¿ƒåŸç†éƒ½å¤§ç›¸å¾„åº­ï¼Œéƒ½æ˜¯ä»å…¥ä¾µåˆ°ä»£ç ä¸­åŸ‹ç‚¹ï¼Œç„¶ååƒè¿½è¸ªç³»ç»Ÿä¸ŠæŠ¥æ•°æ®ä¿¡æ¯ï¼Œæœ€ç»ˆæˆ‘ä»¬åœ¨è¿½è¸ªç³»ç»Ÿå¾—åˆ°æ•°æ®ï¼Œä»è€Œå®ç°è¿½è¸ªåˆ†æã€‚
ä¸ºäº†å…¼å®¹ç»Ÿä¸€å„è¿½è¸ªç³»ç»ŸAPIï¼ŒOpenTracingè§„èŒƒè¯ç”Ÿäº†ï¼Œå®ƒä¸å¹³å°æ— å…³ï¼Œä¸å‚å•†æ— å…³ã€‚æœ‰äº†å®ƒçš„å­˜åœ¨ï¼Œä½ å¯ä»¥æ–¹ä¾¿çš„åˆ‡æ¢ä½ æƒ³ä½¿ç”¨çš„è¿½è¸ªç³»ç»Ÿã€‚
å®‰è£… # Docker # docker run -d --name jaeger \ -e COLLECTOR_ZIPKIN_HTTP_PORT=9411 \ -p 5775:5775/udp \ -p 6831:6831/udp \ -p 6832:6832/udp \ -p 5778:5778 \ -p 16686:16686 \ -p 14268:14268 \ -p 14250:14250 \ -p 9411:9411 \ jaegertracing/all-in-one:1.</description></item><item><title/><link>https://blog.poneding.com/devops/nginx/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/devops/nginx/</guid><description>ğŸ  é¦–é¡µ / DevOps / nginx
nginx # nginxç®€ä»‹ # é«˜æ€§èƒ½çš„åå‘ä»£ç†å·¥å…·ï¼Œè´Ÿè½½å‡è¡¡å™¨ï¼›
nginxé…ç½® # å…¨å±€é…ç½® # eventé…ç½® # httpé…ç½® # é…ç½®åå‘ä»£ç† # æ­£å‘ä»£ç†ï¼š
åœ¨å›½å†…æ˜¯
é…ç½®location:
localtion [ = | ~ | ~* | ^~] uri { } =ï¼šç”¨äºä¸åŒ…å«æ­£åˆ™è¡¨è¾¾å¼çš„urlå‰ï¼Œè¦æ±‚è¯·æ±‚å­—ç¬¦ä¸²ä¸uriä¸¥æ ¼åŒ¹é…ï¼› ~ï¼šç”¨äºè¡¨ç¤ºuriåŒ…å«æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”åŒºåˆ†å¤§å°å†™ï¼› ~*ï¼šç”¨äºè¡¨ç¤ºuriåŒ…å«æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ä¸”ä¸åŒºåˆ†å¤§å°å†™ï¼› ^~ï¼šç”¨äºä¸åŒ…å«æ­£åˆ™è¡¨è¾¾å¼çš„uriå‰ï¼Œè¦æ±‚nginxæœåŠ¡å™¨æ‰¾åˆ°è¡¨ç¤ºuiå’Œè¯·æ±‚å­—ç¬¦ä¸²åŒ¹é…åº¦æœ€é«˜çš„locationåï¼Œç«‹å³ä½¿ç”¨æ­¤locationå¤„ç†è¯·æ±‚ é…ç½®è´Ÿè½½å‡è¡¡ # å°†è´Ÿè½½åˆ†æ‘Šåˆ°ä¸åŒçš„æœåŠ¡å•å…ƒï¼Œä¿è¯æœåŠ¡çš„å¿«é€Ÿå“åº”ï¼Œé«˜å¯ç”¨ã€‚
upstream myserver { server 192.168.0.1:8081; server 192.168.0.2:8082; } server { listen 80; server_name 192.168.0.1; location / { proxy_pass http://myserver; root html; index index.html index.htm; } } å‡è¡¡ç­–ç•¥ï¼š</description></item><item><title/><link>https://blog.poneding.com/docker/container-diff/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/container-diff/</guid><description>ğŸ  é¦–é¡µ / Docker / container-diff å·¥å…·çš„ä½¿ç”¨
container-diff å·¥å…·çš„ä½¿ç”¨ # ç®€ä»‹ # container-diff æ˜¯ google å¼€æºçš„ä¸€æ¬¾ç”¨äºåˆ†æå’Œæ¯”è¾ƒ Docker é•œåƒçš„å·¥å…·ï¼Œå®ƒå¯ä»¥ä»å¤šä¸ªç»´åº¦åˆ†æä¸€ä¸ªæˆ–è€…æ¯”è¾ƒä¸¤ä¸ªå®¹å™¨é•œåƒï¼š
é•œåƒæ„å»ºå†å² é•œåƒæ–‡ä»¶ç³»ç»Ÿ é•œåƒå¤§å° è½¯ä»¶åŒ…ç®¡ç† é¡¹ç›®åœ°å€ï¼š https://github.com/GoogleContainerTools/container-diff
å®‰è£… # macOS # curl -LO https://storage.googleapis.com/container-diff/latest/container-diff-darwin-amd64 &amp;amp;&amp;amp; chmod +x container-diff-darwin-amd64 &amp;amp;&amp;amp; sudo mv container-diff-darwin-amd64 /usr/local/bin/container-diff Linux # curl -LO https://storage.googleapis.com/container-diff/latest/container-diff-linux-amd64 &amp;amp;&amp;amp; chmod +x container-diff-linux-amd64 &amp;amp;&amp;amp; sudo mv container-diff-linux-amd64 /usr/local/bin/container-diff # or curl -LO https://storage.googleapis.com/container-diff/latest/container-diff-linux-amd64 &amp;amp;&amp;amp; chmod +x container-diff-linux-amd64 &amp;amp;&amp;amp; mkdir -p $HOME/bin &amp;amp;&amp;amp; export PATH=$PATH:$HOME/bin &amp;amp;&amp;amp; mv container-diff-linux-amd64 $HOME/bin/container-diff Windows # ä¸‹è½½åœ°å€ï¼š https://storage.</description></item><item><title/><link>https://blog.poneding.com/docker/dind/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/dind/</guid><description>ğŸ  é¦–é¡µ / Docker / Docker in Docker
Docker in Docker # Docker-in-Docker çš„æ„æ€æ˜¯åœ¨ Docker å®¹å™¨ä¸­ä½¿ç”¨ dockerï¼Œå°±åƒå’Œåœ¨å®¿ä¸»æœºä¸Šä½¿ç”¨ docker ä¸€æ ·ï¼Œä½ å¯ä»¥ç†è§£ä¸ºå¥—å¨ƒã€‚
åœºæ™¯ï¼š
å¦‚æœä½ çš„ Jenkins æ˜¯ä½¿ç”¨ Docker å®¹å™¨çš„æ–¹å¼è¿è¡Œçš„ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ Jenkins çš„ Docker æ’ä»¶æ¥ä¸º Jenkins Job æä¾›è¿è¡Œå®¹å™¨ï¼Œè¿™æ—¶å€™ä½ å°±éœ€è¦ç”¨åˆ° Docker-in-Dockerï¼›
ä¸€èˆ¬è¿™ä¸ªæŠ€æœ¯ä½¿ç”¨åœ¨åº”ç”¨çš„ç¨‹åºé›†æˆä¸­ CI/CDã€‚
1. æŒ‚è½½ä¸»æœº /var/run/docker.sock # Docker å®¹å™¨ï¼š
docker run -v /var/run/docker.sock:/var/run/docker.sock --name docker-in-docker -it docker åœ¨è¿è¡Œèµ·æ¥çš„å®¹å™¨ä¸­ä½¿ç”¨dockerï¼š
$ docker run -v /var/run/docker.sock:/var/run/docker.sock --name docker-in-docker -it docker / # docker run hello-world Hello from Docker! This message shows that your installation appears to be working correctly.</description></item><item><title/><link>https://blog.poneding.com/docker/docker-buildx/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/docker-buildx/</guid><description>ğŸ  é¦–é¡µ / Docker / docker buildx
docker buildx # $ docker buildx Usage: docker buildx [OPTIONS] COMMAND Extended build capabilities with BuildKit Options: --builder string Override the configured builder instance Management Commands: imagetools Commands to work on images in registry Commands: bake Build from a file build Start a build create Create a new builder instance du Disk usage inspect Inspect current builder instance ls List builder instances prune Remove build cache rm Remove a builder instance stop Stop builder instance use Set the current builder instance version Show buildx version information Run &amp;#39;docker buildx COMMAND --help&amp;#39; for more information on a command.</description></item><item><title/><link>https://blog.poneding.com/docker/docker-commands/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/docker-commands/</guid><description>ğŸ  é¦–é¡µ / Docker / Docker å¸¸ç”¨å‘½ä»¤
Docker å¸¸ç”¨å‘½ä»¤ # å¯åŠ¨å®¹å™¨å‘½ä»¤ # é»˜è®¤éœ€è¦sudoæƒé™æ‰§è¡Œ
sudo docker run -d -p 80:80 --name nginx nginx &amp;ndash;nameï¼šå®¹å™¨å‘½å
-dï¼šåœ¨åå°å¯åŠ¨
-pï¼š&amp;lt;hostç«¯å£&amp;gt;ï¼š&amp;lt;å®¹å™¨ç«¯å£&amp;gt;
&amp;ndash;rmï¼šå®¹å™¨é€€å‡ºå³åˆ é™¤
-itï¼ši-ä¸å®¹å™¨äº¤äº’ï¼Œt-ç»ˆç«¯
ä»¥rootæƒé™è¿›å…¥å®¹å™¨ # sudo docker exec -it -u root nginx bash è®©å®¹å™¨ä¸€ç›´ç¡çœ  # ä½¿ç”¨ curlimages/curl é•œåƒï¼Œå¹¶è®©å…¶ä¸€ç›´ç¡çœ ã€‚
docker run -d --name sleep curlimages/curl sleep infinity æ“ä½œé•œåƒå‘½ä»¤ # æŸ¥çœ‹é•œåƒ # sudo docker images åˆ é™¤é•œåƒ # sudo docker rmi &amp;lt;image&amp;gt; # or sudo docker image rm &amp;lt;image&amp;gt; åˆ é™¤æ‰€æœ‰é•œåƒ # sudo docker rmi $(docker images -q) æ¸…é™¤æœªä½¿ç”¨é•œåƒ # sudo docker image prune # or sudo docker rmi $(sudo docker images | grep &amp;#34;^&amp;lt;none&amp;gt;&amp;#34; | awk &amp;#34;{print $3}&amp;#34;) æ¨¡ç³Šæ¸…é™¤é•œåƒ # docker rmi $(docker images | grep &amp;#39;query&amp;#39; | awk &amp;#39;{print $3}&amp;#39;) æ“ä½œå®¹å™¨å‘½ä»¤ # æŸ¥çœ‹å·²ç»é€€å‡ºçš„å®¹å™¨ # sudo docker ps -a | grep Exited æ¸…ç†å·²ç»é€€å‡ºçš„å®¹å™¨ # sudo docker rm $(sudo docker ps -qf status=exited) # or sudo docker rm `sudo docker ps -a | grep Exited | awk &amp;#39;{print $1}&amp;#39;` æ¸…é™¤æ‰€æœ‰å®¹å™¨ # ä½¿ç”¨ -f å‚æ•°æ‰èƒ½æ¸…é™¤æ‰€æœ‰å®¹å™¨ï¼Œä¸ä½¿ç”¨åˆ™åªä¼šæ¸…ç†å·²ç»é€€å‡ºçš„å®¹å™¨</description></item><item><title/><link>https://blog.poneding.com/docker/docker-compose-practice/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/docker-compose-practice/</guid><description>ğŸ  é¦–é¡µ / Docker / Docker Compose å®è·µ
Docker Compose å®è·µ # å®‰è£… # å¦‚æœä½ å®‰è£…äº† Docker Desktopï¼Œé‚£ä¹ˆå®ƒå·²ç»å¸®ä½ è‡ªåŠ¨å®‰è£…äº† Docker Compose æ’ä»¶ã€‚å¦åˆ™ï¼Œéœ€è¦é¢å¤–å®‰è£…æ’ä»¶ã€‚
ä½¿ç”¨ä¸€ä¸‹å‘½ä»¤å®‰è£…æˆ–å‡çº§ Docker Composeï¼ˆlinuxï¼‰ï¼š
Ubuntuï¼ŒDebianï¼š sudo apt update sudo apt install docker-compose-plugin åŸºäº RPM å‘è¡Œç‰ˆ: sudo yum update sudo yum install docker-compose-plugin éªŒè¯å®‰è£…ç‰ˆæœ¬ï¼š
docker-compose version å¸¸ç”¨å‘½ä»¤ # è¿è¡Œ
docker-compose up æŸ¥çœ‹è¿è¡Œ
docker-compose ps åœæ­¢
docker-compose stop å¯åŠ¨&amp;amp;é‡å¯
docker-compose start docker-compose restart é€€å‡º
docker-compose down ä½¿ç”¨ docker-compose -h æŸ¥çœ‹æ›´å¤šå‘½ä»¤åŠå‚æ•°ã€‚
å®è·µ # ä½¿ç”¨ Docker Compose è¿è¡Œä¸€ä¸ªç®€å•çš„ golang web ç¨‹åºã€‚</description></item><item><title/><link>https://blog.poneding.com/docker/docker-container-install-pfx-cert/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/docker-container-install-pfx-cert/</guid><description>ğŸ  é¦–é¡µ / Docker / Docker å®¹å™¨ä¸­å®‰è£… PFX è¯ä¹¦
Docker å®¹å™¨ä¸­å®‰è£… PFX è¯ä¹¦ # å¦‚æœæ­£åœ¨å¼€å‘ .NetCore é¡¹ç›®ï¼Œå¹¶ä¸”ä½ çš„é¡¹ç›®éœ€è¦ä½¿ç”¨åˆ° PFX è¯ä¹¦ã€‚æ­¤æ—¶ä½ éœ€è¦å°†ä½ çš„é¡¹ç›®å‘å¸ƒåˆ° Docker å®¹å™¨ä¸­ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦åœ¨ä½ çš„ Docker å®¹å™¨ä¸­å®‰è£… PFX è¯ä¹¦äº†ã€‚
ä»£ç ä¸­ç¼–å†™ # ä½¿ç”¨ X509Store Api ç¼–å†™ä½ çš„ç¨‹åº
using (var certificate = new X509Certificate2(pfxFileBytes, pfxPassword, X509KeyStorageFlags.Exportable | X509KeyStorageFlags.PersistKeySet)) using (var store = new X509Store(storeName, storeLocation, OpenFlags.ReadWrite)) { store.Add(certificate); store.Close(); } Dockerfile ä¸­ç¼–å†™ # ä½¿ç”¨ dotnet-certificate-tool å·¥å…·å®‰è£… pfx è¯ä¹¦ã€‚
é¦–å…ˆè·å–åˆ° Pfx æ–‡ä»¶çš„ Thumbprintï¼Œè¿™åœ¨ dotnet-certificate-tool å‘½ä»¤ä¸­ä½œä¸ºå‚æ•°è¢«ä½¿ç”¨ã€‚
ä½¿ç”¨ Powershell Get-PfxCertificate å‡½æ•°è·å– Thumbprint Get-PfxCertificate -FilePath C:\Pfx\Hello-to-World.</description></item><item><title/><link>https://blog.poneding.com/docker/docker-copy-between-host-container/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/docker-copy-between-host-container/</guid><description>ğŸ  é¦–é¡µ / Docker / Docker ä¸»æœºå®¹å™¨äº’æ‹·è´æ–‡ä»¶
Docker ä¸»æœºå®¹å™¨äº’æ‹·è´æ–‡ä»¶ # å‘½ä»¤ï¼šdocker cp
1. å°† Docker å®¹å™¨å†…æ–‡ä»¶æ‹·è´åˆ° Host # è·å– docker å®¹å™¨çš„ Container ID æˆ–Name
sudo docker ps ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»å®¹å™¨å†…æ‹·å‡ºæ–‡ä»¶
sudo docker cp [CONTAINER ID/NAME]:[CONTAINER_PATH] [HOST_PATH] ä¾‹å¦‚æˆ‘éœ€è¦å°†å®¹å™¨å†… /app/appsettings.json æ–‡ä»¶æ‹·è´åˆ°å®¿ä¸»æœºçš„ ~/temp/ ç›®å½• ï¼ˆè¯¥ç›®å½•å¿…é¡»å­˜åœ¨ï¼‰ ä¸‹
sudo docker cp b3e608e28f21:/app/appsettings.json ~/temp/appsettings.json # ä¸æŒ‡å®šæ–‡ä»¶åäº¦å¯ï¼Œé»˜è®¤ä½¿ç”¨åŸæ–‡ä»¶å sudo docker cp b3e608e28f21:/app/appsettings.json ~/temp/ 2. å°† Host æ–‡ä»¶æ‹·è´è‡³ Docker å®¹å™¨ # åŒæ ·ï¼Œéœ€è¦å…ˆè·å–å®¹å™¨çš„ Container ID æˆ– Nameï¼›
ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†æ–‡ä»¶æ‹·è´è‡³å®¹å™¨å†…
sudo docker cp [HOST_PATH] [CONTAINER ID/NAME]:[CONTAINER_PATH] ä¾‹å¦‚æˆ‘éœ€è¦å°†å®¿ä¸»æœºçš„ ~/temp/hello.</description></item><item><title/><link>https://blog.poneding.com/docker/docker-manifest-build-cross-arch-image/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/docker-manifest-build-cross-arch-image/</guid><description>ğŸ  é¦–é¡µ / Docker / ä½¿ç”¨ docker manifest å‘½ä»¤æ„å»ºå¤šæ¶æ„é•œåƒ
ä½¿ç”¨ docker manifest å‘½ä»¤æ„å»ºå¤šæ¶æ„é•œåƒ # # åˆ›å»º docker manifest create poneding/myimage:v1 poneding/myimage-amd64:v1 poneding/myimage-arm64:v1 # æ³¨è§£ docker manifest annotate poneding/myimage:v1 poneding/myimage-amd64:v1 --arch amd64 docker manifest annotate poneding/myimage:v1 poneding/asmyimageh-arm64:v1 --arch arm64 # æ£€æŸ¥ docker manifest inspect poneding/myimage:v1 # æ¨é€ docker manifest push poneding/myimage:v1 åœ¨ x86 æœºå™¨ä¸Šæ„å»º arm64 é•œåƒ
docker run --rm --privileged multiarch/qemu-user-static --reset --persistent yes Â« Docker ä¸»æœºå®¹å™¨äº’æ‹·è´æ–‡ä»¶
Â» ç†è§£ docker run &amp;ndash;link</description></item><item><title/><link>https://blog.poneding.com/docker/docker-run-link/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/docker-run-link/</guid><description>ğŸ  é¦–é¡µ / Docker / ç†è§£ docker run &amp;ndash;link
ç†è§£ docker run &amp;ndash;link # ä½¿ç”¨æ–¹å¼ # # å‰æå·²ç»å­˜åœ¨ä¸€ä¸ª container2 åœ¨è¿è¡Œ docker run img1 --name container1 --link container2 ä½œç”¨ # container1 è¿æ¥ container2ï¼Œè¾¾åˆ°ï¼š
ä¸ container2 ç›´æ¥é€šä¿¡ è·å– container2 çš„ç¯å¢ƒå˜é‡ Â« ä½¿ç”¨ docker manifest å‘½ä»¤æ„å»ºå¤šæ¶æ„é•œåƒ
Â» Docker å¯è§†åŒ–å·¥å…· Kitematic</description></item><item><title/><link>https://blog.poneding.com/docker/docker-visiable-tool-kitematic/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/docker-visiable-tool-kitematic/</guid><description>ğŸ  é¦–é¡µ / Docker / Docker å¯è§†åŒ–å·¥å…· Kitematic
Docker å¯è§†åŒ–å·¥å…· Kitematic # ä½¿ç”¨ Kitematicï¼Œä»¥å¯è§†åŒ–çš„æ–¹å¼ç®¡ç† docker é•œåƒï¼Œå®¹å™¨ç­‰ã€‚
å®‰è£… Kitematic # åœ¨ ubuntuï¼ˆdesktopï¼‰ä¸­å®‰è£… kitematic ä½œä¸ºç¤ºä¾‹ï¼Œå…¶ä»–å¹³å°å®‰è£…ä¸‹è½½åœ°å€ï¼š https://github.com/docker/kitematic/releases
# download wget https://github.com/docker/kitematic/releases/download/v0.17.11/Kitematic-0.17.11-Ubuntu.zip unzip Kitematic-0.17.11-Ubuntu.zip # install sudo dpkg -i Kitematic-0.17.11_amd64.deb ç”¨æˆ·ç»„ç®¡ç† # ubuntu å·²ç»å®‰è£…äº† docker äº†ï¼Œå½“æˆ‘ä»¬å®‰è£…å®Œ Kitematic ä¹‹åï¼Œç¬¬ä¸€æ¬¡æ‰“å¼€ä¼šé‡åˆ°
å°†å½“å‰ç”¨æˆ·åŠ å…¥åˆ° docker ç»„ï¼š
sudo usermod -aG docker $USER # é‡å¯ docker sudo systemctl restart docker sudo chmod a+rw /var/run/docker.sock å®Œæˆä¸Šé¢æ“ä½œåï¼Œé‡å¯ä¸»æœºï¼Œåº”è¯¥å°±å¯ä»¥ä½¿ç”¨ Kitamatic äº†ã€‚
ä½¿ç”¨ Kitematic # ç¬¬ä¸€æ¬¡å¯åŠ¨ Kitematicï¼Œéœ€è¦ç™»å½• docker è´¦å·ï¼Œç™»å½•å®Œæˆåï¼Œç•Œé¢å¦‚ä¸‹ã€‚</description></item><item><title/><link>https://blog.poneding.com/docker/dockerfile/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/dockerfile/</guid><description>ğŸ  é¦–é¡µ / Docker / Dockerfile
Dockerfile # å®˜æ–¹æ–‡æ¡£å‚è€ƒï¼š https://docs.docker.com/engine/reference/builder/
Dockerfile Linterï¼š https://hadolint.github.io/hadolint/
Usage # docker build [work-dir] -t [image-tag] -f [dockerfile-path] --build-arg [arg-key]=[arg-value] æŒ‡ä»¤ # Dockerfile reference | Docker Documentation
FROM # ARG # ç”±docker buildå‘½ä»¤ä¼ çš„å‚æ•°ã€‚
ARGåœ¨multi-stageçš„ä½œç”¨èŒƒå›´ # å¦‚æœARGæ”¾ç½®åœ¨ç¬¬ä¸€ä¸ªFROMä¹‹å‰ï¼Œé‚£ä¹ˆä½œç”¨èŒƒå›´æ˜¯å…¨å±€çš„ï¼›å¦‚æœARGæ”¾åœ¨FROMä¹‹åï¼Œé‚£ä¹ˆåªå¯¹FROMçš„stageä½œç”¨ã€‚
ARG USERNAME FROM alpine RUN echo hello, ${USERNAME} FROM alpine RUN echo hi, ${USERNAME} CMD # CMD æŒ‡ä»¤çš„ç›®çš„æ˜¯ä¸ºä¸€ä¸ªå¯æ‰§è¡Œå®¹å™¨æä¾›åˆå§‹è¿è¡Œå‘½ä»¤æˆ–è¿è¡Œå‚æ•°ã€‚
CMD æŒ‡ä»¤æœ‰ä¸‰ç§å½¢å¼ï¼š
å¯æ‰§è¡Œå‘½ä»¤ + å‘½ä»¤å‚æ•°åˆ—è¡¨ï¼Œæ¨èä½¿ç”¨ CMD [&amp;#34;executable&amp;#34;,&amp;#34;param1&amp;#34;,&amp;#34;param2&amp;#34;] å‘½ä»¤å‚æ•°åˆ—è¡¨ï¼Œä½œä¸º ENTRYPOINT çš„å‚æ•° CMD [&amp;#34;param1&amp;#34;,&amp;#34;param2&amp;#34;] Shell å½¢å¼ï¼Œå­—ç¬¦ä¸²å½¢å¼çš„å‘½ä»¤ CMD command param1 param2 å•ä¸ª build stage åªå…è®¸å­˜åœ¨ä¸€ä¸ª CMD æŒ‡ä»¤ï¼Œå¦‚æœå­˜åœ¨å¤šä¸ª CMD æŒ‡ä»¤ï¼Œåªæœ‰æœ€åä¸€ä¸ª CMD æŒ‡ä»¤ç”Ÿæ•ˆã€‚</description></item><item><title/><link>https://blog.poneding.com/docker/linux-container/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/linux-container/</guid><description>ğŸ  é¦–é¡µ / Docker / Linux å®¹å™¨
Linux å®¹å™¨ # å®¹å™¨æ˜¯è½»é‡çº§çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚
èµ„æºéš”ç¦»å’Œé™åˆ¶
å®¹å™¨é•œåƒ # è”åˆæ–‡ä»¶ç³»ç»Ÿ # å…è®¸æ–‡ä»¶å­˜æ”¾åœ¨ä¸åŒçš„å±‚çº§ä¸Šï¼Œä½†æ˜¯æœ€ç»ˆå¯ä»¥é€šè¿‡ç»Ÿä¸€çš„è§†å›¾æŸ¥çœ‹åˆ°è¿™äº›å±‚çº§çš„æ‰€æœ‰æ–‡ä»¶ã€‚
cgroup # namespace # mountï¼šæ–‡ä»¶ç³»ç»Ÿéš”ç¦» utsï¼šhostname domain pidï¼š1å·è¿›ç¨‹ network user ipcï¼šè¿›ç¨‹é—´é€šä¿¡ cgroup Â« Dockerfile
Â» é root è´¦å·è·å– docker æƒé™</description></item><item><title/><link>https://blog.poneding.com/docker/non-root-account-get-docker-permission/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/non-root-account-get-docker-permission/</guid><description>ğŸ  é¦–é¡µ / Docker / é root è´¦å·è·å– docker æƒé™
é root è´¦å·è·å– docker æƒé™ # é»˜è®¤ docker çš„å‘½ä»¤æ˜¯éœ€è¦ sudo æƒé™çš„ï¼Œå¦‚æœä½ è§‰å¾—éº»çƒ¦ï¼Œæƒ³ç›´æ¥åœ¨å½“å‰ç”¨æˆ·ä¸‹æ‰§è¡Œ docker æƒé™ï¼Œä½ å¯ä»¥å°è¯•ä½¿ç”¨ä¸‹é¢è¿™ä¸ªè§£å†³æ–¹æ¡ˆã€‚
æ‹¢å…±åˆ†ä¸¤æ­¥ï¼š
ç¬¬ä¸€æ­¥ï¼Œå°†å½“å‰ç”¨æˆ·æ·»åŠ åˆ° docker ç»„
sudo usermod -aG docker $USER ç¬¬äºŒæ­¥ï¼Œæˆæƒ
sudo chmod a+rw /var/run/docker.sock å¿«å»è¯•è¯•å§ã€‚
Â« Linux å®¹å™¨
Â» Mac é‡è£… Docker Desktop</description></item><item><title/><link>https://blog.poneding.com/docker/reinstall-docker-desktop-on-mac/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/reinstall-docker-desktop-on-mac/</guid><description>ğŸ  é¦–é¡µ / Docker / Mac é‡è£… Docker Desktop
Mac é‡è£… Docker Desktop # åœ¨ä½¿ç”¨ Docker Desktop çš„è¿‡ç¨‹ä¸­ï¼Œçªç„¶é‡åˆ°ç¨‹åºå´©æºƒ Invalid virtual machine configuration. The storage device attachment is invalidï¼Œåœ¨é‡å¯ä»¥åŠç®€å•é‡è£…æ— æœåï¼Œæˆ‘ä»¬è¯•ç”¨ä»¥ä¸‹æ–¹å¼é‡è£…ã€‚
ç¬¬ä¸€æ­¥ï¼Œå¸è½½ Docker Desktopï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
# å¸è½½ /Applications/Docker.app/Contents/MacOS/uninstall # åˆ é™¤å‰©ä½™æ–‡ä»¶ rm -rf ~/Library/Group\ Containers/group.com.docker rm -rf ~/Library/Containers/com.docker.docker rm -rf ~/.docker ç¬¬äºŒæ­¥ï¼Œé‡å¯ Macï¼Œé‡å¯åï¼Œæ‰“å¼€æ´»åŠ¨ç›‘è§†å™¨ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨åä¸ºcom.docker.vmnetd çš„è¿›ç¨‹ï¼Œå¦‚æœå­˜åœ¨ï¼Œç»“æŸè¯¥è¿›ç¨‹ï¼ˆå¦‚æœæ— æ³•æ­£å¸¸ç»“æŸï¼Œé‚£ä¹ˆå°è¯•å¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼‰ã€‚
ç¬¬ä¸‰æ­¥ï¼Œé‡è£… Docker Desktopã€‚
Â« é root è´¦å·è·å– docker æƒé™
Â» some-apps.md</description></item><item><title/><link>https://blog.poneding.com/docker/some-apps/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/docker/some-apps/</guid><description>ğŸ  é¦–é¡µ / Docker / some-apps.md
Docker åº”ç”¨
Cloudreve # é¡¹ç›®åœ°å€ï¼š https://github.com/cloudreve/Cloudreve
docker run -d --name cloudreve \ -p 5212:5212 \ --mount type=bind,source=/root/apps/cloudreve/conf.ini,target=/cloudreve/conf.ini \ --mount type=bind,source=/root/apps/cloudreve/cloudreve.db,target=/cloudreve/cloudreve.db \ -v /root/apps/cloudreve/uploads:/cloudreve/uploads \ -v /root/apps/cloudreve/avatar:/cloudreve/avatar \ cloudreve/cloudreve:latest Etcd # docker run -d --name etcd \ -p 12379:2379 \ -p 12380:2380 \ -e ALLOW_NONE_AUTHENTICATION=yes \ -e ETCD_LISTEN_CLIENT_URLS=http://0.0.0.0:2379 \ -e ETCD_ADVERTISE_CLIENT_URLS=http://etcd:2379,http://0.0.0.0:2379 \ -v /root/apps/etcd/data:/var/run/etcd \ quay.io/coreos/etcd:v3.5.6 Minio # docker run -d --name minio \ -p 9000:9000 \ -p 9001:9001 \ -e MINIO_ROOT_USER=minio \ -e MINIO_ROOT_PASSWORD=&amp;#39;pd1n9@1024&amp;#39; \ -v /root/apps/minio/data:/data \ quay.</description></item><item><title/><link>https://blog.poneding.com/ebpf/ebpf/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/ebpf/ebpf/</guid><description>ğŸ  é¦–é¡µ / EBPF / eBPF
eBPF # ç®€ä»‹ # eBPF (extended Berkeley Packet Filter) æ˜¯ä¸€é¡¹é©å‘½æ€§çš„æŠ€æœ¯ï¼Œèµ·æºäº Linux å†…æ ¸ï¼Œå®ƒå¯ä»¥åœ¨ç‰¹æƒä¸Šä¸‹æ–‡ä¸­ï¼ˆå¦‚æ“ä½œç³»ç»Ÿå†…æ ¸ï¼‰è¿è¡Œæ²™ç›’ç¨‹åºã€‚å®ƒç”¨äºå®‰å…¨æœ‰æ•ˆåœ°æ‰©å±•å†…æ ¸çš„åŠŸèƒ½ï¼Œè€Œæ— éœ€é€šè¿‡æ›´æ”¹å†…æ ¸æºä»£ç æˆ–åŠ è½½å†…æ ¸æ¨¡å—çš„æ–¹å¼æ¥å®ç°ã€‚
ä»å†å²ä¸Šçœ‹ï¼Œç”±äºå†…æ ¸å…·æœ‰ç›‘ç£å’Œæ§åˆ¶æ•´ä¸ªç³»ç»Ÿçš„ç‰¹æƒï¼Œæ“ä½œç³»ç»Ÿä¸€ç›´æ˜¯å®ç°å¯è§‚æµ‹æ€§ã€å®‰å…¨æ€§å’Œç½‘ç»œåŠŸèƒ½çš„ç†æƒ³åœºæ‰€ã€‚åŒæ—¶ï¼Œç”±äºæ“ä½œç³»ç»Ÿå†…æ ¸çš„æ ¸å¿ƒåœ°ä½å’Œå¯¹ç¨³å®šæ€§å’Œå®‰å…¨æ€§çš„é«˜è¦æ±‚ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸å¾ˆéš¾å¿«é€Ÿè¿­ä»£å‘å±•ã€‚å› æ­¤åœ¨ä¼ ç»Ÿæ„ä¹‰ä¸Šï¼Œä¸åœ¨æ“ä½œç³»ç»Ÿæœ¬èº«ä¹‹å¤–å®ç°çš„åŠŸèƒ½ç›¸æ¯”ï¼Œæ“ä½œç³»ç»Ÿçº§åˆ«çš„åˆ›æ–°é€Ÿåº¦è¦æ…¢ä¸€äº›ã€‚
eBPF ä»æ ¹æœ¬ä¸Šæ”¹å˜äº†è¿™ä¸ªæ–¹å¼ã€‚é€šè¿‡å…è®¸åœ¨æ“ä½œç³»ç»Ÿä¸­è¿è¡Œæ²™ç›’ç¨‹åºçš„æ–¹å¼ï¼Œåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å¯ä»¥è¿è¡Œ eBPF ç¨‹åºï¼Œä»¥ä¾¿åœ¨è¿è¡Œæ—¶å‘æ“ä½œç³»ç»Ÿæ·»åŠ é¢å¤–çš„åŠŸèƒ½ã€‚ç„¶ååœ¨ JIT ç¼–è¯‘å™¨å’ŒéªŒè¯å¼•æ“çš„å¸®åŠ©ä¸‹ï¼Œæ“ä½œç³»ç»Ÿç¡®ä¿å®ƒåƒæœ¬åœ°ç¼–è¯‘çš„ç¨‹åºä¸€æ ·å…·å¤‡å®‰å…¨æ€§å’Œæ‰§è¡Œæ•ˆç‡ã€‚è¿™å¼•å‘äº†ä¸€è‚¡åŸºäº eBPF çš„é¡¹ç›®çƒ­æ½®ï¼Œå®ƒä»¬æ¶µç›–äº†å¹¿æ³›çš„ç”¨ä¾‹ï¼ŒåŒ…æ‹¬ä¸‹ä¸€ä»£ç½‘ç»œå®ç°ã€å¯è§‚æµ‹æ€§å’Œå®‰å…¨åŠŸèƒ½ç­‰é¢†åŸŸã€‚
å¦‚ä»Šï¼ŒeBPF è¢«å¹¿æ³›ç”¨äºé©±åŠ¨å„ç§ç”¨ä¾‹ï¼šåœ¨ç°ä»£æ•°æ®ä¸­å¿ƒå’Œäº‘åŸç”Ÿç¯å¢ƒä¸­æä¾›é«˜æ€§èƒ½ç½‘ç»œå’Œè´Ÿè½½å‡è¡¡ï¼Œä»¥ä½å¼€é”€æå–ç»†ç²’åº¦çš„å®‰å…¨å¯è§‚æµ‹æ€§æ•°æ®ï¼Œå¸®åŠ©åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜è·Ÿè¸ªåº”ç”¨ç¨‹åºï¼Œä¸ºæ€§èƒ½æ•…éšœæ’æŸ¥ã€é¢„é˜²æ€§çš„å®‰å…¨ç­–ç•¥æ‰§è¡Œ(åŒ…æ‹¬åº”ç”¨å±‚å’Œå®¹å™¨è¿è¡Œæ—¶)æä¾›æ´å¯Ÿï¼Œç­‰ç­‰ã€‚å¯èƒ½æ€§æ˜¯æ— é™çš„ï¼ŒeBPF å¼€å¯çš„åˆ›æ–°æ‰åˆšåˆšå¼€å§‹ã€‚
é’©å­ # eBPF ç¨‹åºæ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œå½“å†…æ ¸æˆ–åº”ç”¨ç¨‹åºé€šè¿‡æŸä¸ªé’©å­ç‚¹æ—¶è¿è¡Œã€‚é¢„å®šä¹‰çš„é’©å­åŒ…æ‹¬ç³»ç»Ÿè°ƒç”¨ã€å‡½æ•°å…¥å£/é€€å‡ºã€å†…æ ¸è·Ÿè¸ªç‚¹ã€ç½‘ç»œäº‹ä»¶ç­‰ã€‚
å¦‚æœé¢„å®šä¹‰çš„é’©å­ä¸èƒ½æ»¡è¶³ç‰¹å®šéœ€æ±‚ï¼Œåˆ™å¯ä»¥åˆ›å»ºå†…æ ¸æ¢é’ˆï¼ˆkprobeï¼‰æˆ–ç”¨æˆ·æ¢é’ˆï¼ˆuprobeï¼‰ï¼Œä»¥ä¾¿åœ¨å†…æ ¸æˆ–ç”¨æˆ·åº”ç”¨ç¨‹åºçš„å‡ ä¹ä»»ä½•ä½ç½®é™„åŠ  eBPF ç¨‹åºã€‚
ç¼–å†™ç¨‹åº # åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒeBPF ä¸æ˜¯ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯é€šè¿‡åƒÂ Ciliumã€ bccÂ æˆ–Â bpftraceÂ è¿™æ ·çš„é¡¹ç›®é—´æ¥ä½¿ç”¨ï¼Œè¿™äº›é¡¹ç›®æä¾›äº† eBPF ä¹‹ä¸Šçš„æŠ½è±¡ï¼Œä¸éœ€è¦ç›´æ¥ç¼–å†™ç¨‹åºï¼Œè€Œæ˜¯æä¾›äº†æŒ‡å®šåŸºäºæ„å›¾çš„æ¥å®šä¹‰å®ç°çš„èƒ½åŠ›ï¼Œç„¶åç”¨ eBPF å®ç°ã€‚
å¦‚æœä¸å­˜åœ¨æ›´é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼Œåˆ™éœ€è¦ç›´æ¥ç¼–å†™ç¨‹åºã€‚Linux å†…æ ¸æœŸæœ› eBPF ç¨‹åºä»¥å­—èŠ‚ç çš„å½¢å¼åŠ è½½ã€‚è™½ç„¶ç›´æ¥ç¼–å†™å­—èŠ‚ç å½“ç„¶æ˜¯å¯èƒ½çš„ï¼Œä½†æ›´å¸¸è§çš„å¼€å‘å®è·µæ˜¯åˆ©ç”¨åƒÂ LLVMÂ è¿™æ ·çš„ç¼–è¯‘å™¨å¥—ä»¶å°†ä¼ª c ä»£ç ç¼–è¯‘æˆ eBPF å­—èŠ‚ç ã€‚
å®‰å…¨æ€§ # ç”±äº eBPF å…è®¸æˆ‘ä»¬åœ¨å†…æ ¸ä¸­è¿è¡Œä»»æ„ä»£ç ï¼Œéœ€è¦æœ‰ä¸€ç§æœºåˆ¶æ¥ç¡®ä¿å®ƒçš„å®‰å…¨è¿è¡Œï¼Œä¸ä¼šä½¿ç”¨æˆ·çš„æœºå™¨å´©æºƒï¼Œä¹Ÿä¸ä¼šæŸå®³ä»–ä»¬çš„æ•°æ®ã€‚è¿™ä¸ªæœºåˆ¶å°±æ˜¯ eBPF éªŒè¯å™¨ã€‚
éªŒè¯å™¨å¯¹ eBPF ç¨‹åºè¿›è¡Œåˆ†æï¼Œä»¥ç¡®ä¿æ— è®ºè¾“å…¥ä»€ä¹ˆï¼Œå®ƒéƒ½ä¼šåœ¨ä¸€å®šæ•°é‡çš„æŒ‡ä»¤å†…å®‰å…¨åœ°ç»ˆæ­¢ã€‚</description></item><item><title/><link>https://blog.poneding.com/front-end/build-blog-site/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/front-end/build-blog-site/</guid><description>ğŸ  é¦–é¡µ / å‰ç«¯æŠ€æœ¯ / æ­å»ºåšå®¢ç«™ç‚¹
æ­å»ºåšå®¢ç«™ç‚¹ # 1. Hugo æ­å»ºåšå®¢ # Hugo æ˜¯ä¸€ä¸ªç”¨ Go è¯­è¨€ç¼–å†™çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ã€‚Hugo çš„é€Ÿåº¦éå¸¸å¿«ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸éœ€è¦ä»»ä½•è¿è¡Œæ—¶ä¾èµ–ã€‚Hugo çš„ä¸»è¦ç‰¹ç‚¹æ˜¯é€Ÿåº¦å¿«ã€æ˜“äºå®‰è£…ã€æ˜“äºä½¿ç”¨ã€æ˜“äºå®šåˆ¶ã€‚
1.1 å®‰è£… Hugo # å‚è€ƒï¼š https://gohugo.io/installation
1.2 åˆ›å»ºåšå®¢ # hugo new site blog --format yaml cd blog git init 1.3 é€‰æ‹©ä¸»é¢˜ # ä½¿ç”¨ hugo-book ä¸»é¢˜ã€‚
git submodule add https://github.com/alex-shpak/hugo-book themes/hugo-book 2. å®šåˆ¶ # 2.1 é…ç½® hugo.yaml # # hugo server --minify --themesDir ../.. --baseURL=http://0.0.0.0:1313/theme/hugo-book/ baseURL: https://blog.poneding.com/ title: ç§‹æ²³è½å¶ theme: hugo-book pluralizeListTitles: false defaultContentLanguage: cn # Book configuration disablePathToLower: true enableGitInfo: true # Needed for mermaid/katex shortcodes markup: tableOfContents: startLevel: 2 endLevel: 3 # ordered: true highlight: noClasses: false # style: monokai menu: after: - name: &amp;#34;ğŸ”— GitHub&amp;#34; url: &amp;#34;https://github.</description></item><item><title/><link>https://blog.poneding.com/front-end/pinia/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/front-end/pinia/</guid><description>ğŸ  é¦–é¡µ / å‰ç«¯æŠ€æœ¯ / Pinia å…¥é—¨
Pinia å…¥é—¨ # ä»€ä¹ˆæ˜¯pinia # Pinia æ˜¯ Vue çš„ä¸“å±çŠ¶æ€ç®¡ç†åº“ï¼Œå¯ä»¥å®ç°è·¨ç»„ä»¶æˆ–é¡µé¢å…±äº«çŠ¶æ€ï¼Œæ˜¯ vuex çŠ¶æ€ç®¡ç†å·¥å…·çš„æ›¿ä»£å“ï¼Œå’Œ Vuexç›¸æ¯”ï¼Œå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿
æä¾›æ›´åŠ ç®€å•çš„API ï¼ˆå»æ‰äº† mutation ï¼‰ æä¾›ç¬¦åˆç»„åˆå¼APIé£æ ¼çš„API ï¼ˆå’Œ Vue3 æ–°è¯­æ³•ç»Ÿä¸€ï¼‰ å»æ‰äº†modulesçš„æ¦‚å¿µï¼Œæ¯ä¸€ä¸ªstoreéƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å— æ­é… TypeScript ä¸€èµ·ä½¿ç”¨æä¾›å¯é çš„ç±»å‹æ¨æ–­ åˆ›å»ºç©ºVueé¡¹ç›®å¹¶å®‰è£…Pinia # 1. åˆ›å»ºç©ºVueé¡¹ç›® # npm init vue@latest 2. å®‰è£…Piniaå¹¶æ³¨å†Œ # npm i pinia import { createPinia } from &amp;#39;pinia&amp;#39; const app = createApp(App) // ä»¥æ’ä»¶çš„å½¢å¼æ³¨å†Œ app.use(createPinia()) app.use(router) app.mount(&amp;#39;#app&amp;#39;) å®ç°counter # æ ¸å¿ƒæ­¥éª¤ï¼š
å®šä¹‰store ç»„ä»¶ä½¿ç”¨store 1- å®šä¹‰store
import { defineStore } from &amp;#39;pinia&amp;#39; import { ref } from &amp;#39;vue&amp;#39; export const useCounterStore = defineStore(&amp;#39;counter&amp;#39;, ()=&amp;gt;{ // æ•°æ® ï¼ˆstateï¼‰ const count = ref(0) // ä¿®æ”¹æ•°æ®çš„æ–¹æ³• ï¼ˆactionï¼‰ const increment = ()=&amp;gt;{ count.</description></item><item><title/><link>https://blog.poneding.com/front-end/vitepress/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/front-end/vitepress/</guid><description>ğŸ  é¦–é¡µ / å‰ç«¯æŠ€æœ¯ / VitePress
VitePress # æ­å»ºé¡¹ç›® # mkdir vitepress-demo npm add -D vitepress npx vitepress init è¿è¡Œ # npm run docs:dev # æˆ–è€…ç›´æ¥è°ƒç”¨ VitePress npx vitepress dev docs æ‰“åŒ… # npm run docs:build GitHub Action # .github/workflows/deploy.yaml
# æ„å»º VitePress ç«™ç‚¹å¹¶å°†å…¶éƒ¨ç½²åˆ° GitHub Pages çš„ç¤ºä¾‹å·¥ä½œæµç¨‹ # name: Deploy VitePress site to Pages on: # åœ¨é’ˆå¯¹ `main` åˆ†æ”¯çš„æ¨é€ä¸Šè¿è¡Œã€‚å¦‚æœä½  # ä½¿ç”¨ `master` åˆ†æ”¯ä½œä¸ºé»˜è®¤åˆ†æ”¯ï¼Œè¯·å°†å…¶æ›´æ”¹ä¸º `master` push: branches: [master] # å…è®¸ä½ ä» Actions é€‰é¡¹å¡æ‰‹åŠ¨è¿è¡Œæ­¤å·¥ä½œæµç¨‹ workflow_dispatch: # è®¾ç½® GITHUB_TOKEN çš„æƒé™ï¼Œä»¥å…è®¸éƒ¨ç½²åˆ° GitHub Pages permissions: contents: read pages: write id-token: write # åªå…è®¸åŒæ—¶è¿›è¡Œä¸€æ¬¡éƒ¨ç½²ï¼Œè·³è¿‡æ­£åœ¨è¿è¡Œå’Œæœ€æ–°é˜Ÿåˆ—ä¹‹é—´çš„è¿è¡Œé˜Ÿåˆ— # ä½†æ˜¯ï¼Œä¸è¦å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„è¿è¡Œï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›å…è®¸è¿™äº›ç”Ÿäº§éƒ¨ç½²å®Œæˆ concurrency: group: pages cancel-in-progress: false jobs: # æ„å»ºå·¥ä½œ build: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v4 with: fetch-depth: 0 # å¦‚æœæœªå¯ç”¨ lastUpdatedï¼Œåˆ™ä¸éœ€è¦ # - uses: pnpm/action-setup@v3 # å¦‚æœä½¿ç”¨ pnpmï¼Œè¯·å–æ¶ˆæ³¨é‡Š # - uses: oven-sh/setup-bun@v1 # å¦‚æœä½¿ç”¨ Bunï¼Œè¯·å–æ¶ˆæ³¨é‡Š - name: Setup Node uses: actions/setup-node@v4 with: node-version: 20 cache: npm # æˆ– pnpm / yarn - name: Setup Pages uses: actions/configure-pages@v4 - name: Install dependencies run: npm ci # æˆ– pnpm install / yarn install / bun install - name: Build with VitePress run: npm run docs:build # æˆ– pnpm docs:build / yarn docs:build / bun run docs:build - name: Upload artifact uses: actions/upload-pages-artifact@v3 with: path: .</description></item><item><title/><link>https://blog.poneding.com/front-end/vue3/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/front-end/vue3/</guid><description>ğŸ  é¦–é¡µ / å‰ç«¯æŠ€æœ¯ / è®¤è¯†Vue3
è®¤è¯†Vue3 # 1. Vue3ç»„åˆå¼APIä½“éªŒ # é€šè¿‡ Counter æ¡ˆä¾‹ ä½“éªŒVue3æ–°å¼•å…¥çš„ç»„åˆå¼API
&amp;lt;script&amp;gt; export default { data(){ return { count:0 } }, methods:{ addCount(){ this.count++ } } } &amp;lt;/script&amp;gt; &amp;lt;script setup&amp;gt; import { ref } from &amp;#39;vue&amp;#39; const count = ref(0) const addCount = ()=&amp;gt; count.value++ &amp;lt;/script&amp;gt; ç‰¹ç‚¹ï¼š
ä»£ç é‡å˜å°‘ åˆ†æ•£å¼ç»´æŠ¤å˜æˆé›†ä¸­å¼ç»´æŠ¤ 2. Vue3æ›´å¤šçš„ä¼˜åŠ¿ # ä½¿ç”¨create-vueæ­å»ºVue3é¡¹ç›® # 1. è®¤è¯†create-vue # create-vueæ˜¯Vueå®˜æ–¹æ–°çš„è„šæ‰‹æ¶å·¥å…·ï¼Œåº•å±‚åˆ‡æ¢åˆ°äº† vite ï¼ˆä¸‹ä¸€ä»£å‰ç«¯å·¥å…·é“¾ï¼‰ï¼Œä¸ºå¼€å‘æä¾›æé€Ÿå“åº”
2. ä½¿ç”¨create-vueåˆ›å»ºé¡¹ç›® # å‰ç½®æ¡ä»¶ - å·²å®‰è£…16.</description></item><item><title/><link>https://blog.poneding.com/git/common-usage/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/common-usage/</guid><description>ğŸ  é¦–é¡µ / Git / Git å¸¸ç”¨
Git å¸¸ç”¨ # æœ¬ç¯‡ä¸»è¦ä»‹ç» Git çš„å¸¸ç”¨å‘½ä»¤ï¼ŒåŒ…æ‹¬ Git çš„åŸºæœ¬é…ç½®ã€åˆ›å»ºä»“åº“ã€æ·»åŠ æ–‡ä»¶ã€æäº¤æ–‡ä»¶ã€æŸ¥çœ‹çŠ¶æ€ã€æŸ¥çœ‹æäº¤å†å²ã€æ’¤é”€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶ã€åˆ†æ”¯ç®¡ç†ã€è¿œç¨‹ä»“åº“ç­‰ã€‚
Git åŸºæœ¬é…ç½® # é…ç½® SSH å¯†é’¥ # æäº¤ä»£ç åˆ°è¿œç¨‹ä»“åº“æ—¶ï¼Œéœ€è¦ä½¿ç”¨ SSH å¯†é’¥è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå› æ­¤éœ€è¦å…ˆé…ç½® SSH å¯†é’¥ã€‚
# ç”Ÿæˆ SSH å¯†é’¥ ssh-keygen -t rsa -C poneding@gmail.com # æŸ¥çœ‹ SSH å¯†é’¥ï¼Œå¤åˆ¶åˆ° GitHub/GitLab ç­‰ SSH Keys ä¸­ cat ~/.ssh/id_rsa.pub æ·»åŠ  .ssh/config æ–‡ä»¶ï¼Œé…ç½® SSH å¯†é’¥çš„åˆ«åï¼Œæ–¹ä¾¿ç®¡ç†å¤šä¸ª SSH å¯†é’¥ã€‚
vim ~/.ssh/config ä»¥ GitHub ä¸ºä¾‹ï¼Œé…ç½®å¦‚ä¸‹ï¼š
# GitHub Host github.com HostName github.com IdentityFile ~/.ssh/id_rsa é…ç½®ç”¨æˆ·åå’Œé‚®ç®± # æäº¤ä»£ç æ—¶ï¼Œéœ€è¦é…ç½®ç”¨æˆ·åå’Œé‚®ç®±ã€‚</description></item><item><title/><link>https://blog.poneding.com/git/git-secret/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/git-secret/</guid><description>ğŸ  é¦–é¡µ / Git / ä½¿ç”¨ git-secret ä¿æŠ¤ä»“åº“æ•æ„Ÿæ•°æ®
ä½¿ç”¨ git-secret ä¿æŠ¤ä»“åº“æ•æ„Ÿæ•°æ® # å¦‚ä½•ä¿æŠ¤ git ä»“åº“ä¸­çš„æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œè´¦å·å¯†ç ç­‰ï¼Ÿ
é¦–å…ˆï¼Œæœ€å¥½å…ˆå°†ä»“åº“è®¾ç½®æˆç§æœ‰ä»“åº“ï¼ç„¶åï¼Œ
ç¬¬ä¸€ç§æ–¹å¼ï¼šå¸¦æœ‰æ•æ„Ÿæ•°æ®çš„æ–‡ä»¶åŠ å…¥åˆ°. gitignoreï¼Œä¸æäº¤åˆ°ä»“åº“ä¸­ï¼› ç¬¬äºŒç§æ–¹å¼ï¼šæ•æ„Ÿæ•°æ®åº“æ–‡ä»¶åŠ å¯†åå†æäº¤åˆ°ä»“åº“ä¸­ï¼Œè¿™ä¸ªå°±æ˜¯ä»Šå¤©è¦è¯´çš„ git-secretã€‚ è¿™ä¸¤ç§æ–¹å¼éƒ½æœ‰ä¼˜ç¼ºç‚¹ï¼š
ç¬¬ä¸€ç§æ–¹å¼ï¼Œè¾ƒä¸ºé è°±ï¼Œæ•æ„Ÿæ–‡ä»¶åœ¨ git ä»“åº“ä¹‹å¤–ï¼Œæ ¹æœ¬ä¸Šé¿å…ä»“åº“æ•æ„Ÿæ•°æ®çš„æ³„éœ²ï¼Œä½†æ˜¯æ•æ„Ÿæ–‡ä»¶ä¸å—ç‰ˆæœ¬æ§åˆ¶äº†ï¼Œå¼€å‘äººå‘˜éœ€è¦åœ¨å…¶ä»–é¢‘é“åŒæ­¥æ•æ„Ÿæ–‡ä»¶çš„æ›´æ–°ï¼Œè€Œä¸”ä½¿ç”¨åˆ°è‡ªåŠ¨éƒ¨ç½²æ—¶éœ€è¦å¦å¤–å»æ‹‰å–æ•æ„Ÿæ•°æ®ï¼Œæœ€å¥½æ˜¯æœ‰è‡ªå·±çš„æ•æ„Ÿæ•°æ®é…ç½®ä¸­å¿ƒç»Ÿä¸€ç®¡ç†ï¼›
ç¬¬äºŒç§æ–¹å¼ï¼Œä½¿ç”¨ git-secret åŠ å¯†æ•æ„Ÿæ–‡ä»¶ï¼Œè¿™æ ·æ•æ„Ÿæ–‡ä»¶è¢«ä»“åº“ ignore æ‰ï¼Œè½¬è€Œæäº¤åŠ å¯†åçš„æ–‡ä»¶ï¼Œä½†æ˜¯æ•æ„Ÿæ–‡ä»¶å¦‚æœæ›´æ–°äº†å¼€å‘äººå‘˜è¦è®°å¾—å†æ¬¡åŠ å¯†ã€‚
git-secret ç®€ä»‹ # git-secret æ˜¯ä¸€ä¸ªåœ¨ git ä»“åº“ä¸­åŠ å¯†æ–‡ä»¶çš„å·¥å…·ï¼Œå°†æ•æ„Ÿæ–‡ä»¶åŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†æ–‡ä»¶ï¼Œå°†æ–‡ä»¶ä¿å­˜åˆ°ä»“åº“ä¸­ï¼Œè¿™æ ·æ•æ„Ÿæ–‡ä»¶ä¹Ÿæ˜¯ç‰ˆæœ¬æ§åˆ¶ï¼Œä½ å¯ä»¥è·å–åˆ°è¯¥æ–‡ä»¶çš„æ‰€æœ‰æäº¤è®°å½•ã€‚
ä½¿ç”¨ gpg å’Œæ‰€æœ‰ä¿¡ä»»ç”¨æˆ·çš„å…¬é’¥åŠ å¯†æ–‡ä»¶ï¼Œæ¯ä¸ªä¿¡ä»»ç”¨æˆ·å¯ä»¥ä½¿ç”¨ä¸ªäººå¯†é’¥è§£å¯†æ–‡ä»¶ï¼Œå¦‚æœç”¨æˆ·ç¦»å¼€å›¢é˜Ÿï¼Œå°†åˆ é™¤ç”¨æˆ·çš„å…¬é’¥å³å¯ï¼Œä»–ä¹Ÿå°±ä¸èƒ½å†è§£å¯†æ–‡ä»¶äº†ã€‚
git-secret ä½¿ç”¨ # å‡è®¾æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªä»“åº“ git-secret-demoï¼Œä»“åº“ä¸‹æœ‰ä¸€ä¸ªåŒ…å«æ•æ„Ÿä¿¡æ¯çš„æ–‡ä»¶ secret.jsonï¼š
æˆ‘ç°åœ¨æƒ³åšçš„æ˜¯ä½¿ç”¨ git-secret å°† secret.json æ–‡ä»¶åŠ å¯†ã€‚
é¦–å…ˆå¾—å®‰è£… gpg å·¥å…· # Debian &amp;amp; Ubuntu sudo apt install gnupg -y â€‹ # Macos brew install gnupg æœ¬åœ°åˆ›å»º gpg RSA å¯†é’¥å¯¹ gpg --gen-key åœ¨åˆ›å»ºæ—¶éœ€è¦è¾“å…¥è‡ªå·±çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼Œå¹¶ä¸”éœ€è¦è¾“å…¥ä½ çš„åŠ å¯†å¯†ç ã€‚</description></item><item><title/><link>https://blog.poneding.com/git/github-action-best-practice/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/github-action-best-practice/</guid><description>ğŸ  é¦–é¡µ / Git / Github Action ä½¿ç”¨æœ€ä½³å®è·µ
Github Action ä½¿ç”¨æœ€ä½³å®è·µ # Commit æ„å»º beta ç‰ˆæœ¬é•œåƒ # ä»“åº“æ ¹ç›®å½•ä¸‹åˆ›å»º .github/workflows/commit-cicd.yml æ–‡ä»¶ï¼Œç”¨äºæäº¤ä»£ç è§¦å‘ github actionã€‚
beta ç‰ˆæœ¬çš„é•œåƒ tag å‘½åè§„åˆ™ï¼š{vx.x.x}-beta-{COMMIT_ID}ï¼Œä¾‹å¦‚ï¼šv1.0.0-beta-f37cfa2
name: commit-cicd â€‹ env: BASE_VERSION: v1.0.0 â€‹ on: push: branches: [main] workflow_dispatch: â€‹ jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 â€‹ - name: Set ENV run: | echo &amp;#34;VERSION=${BASE_VERSION}-beta-${GITHUB_SHA::7}&amp;#34; &amp;gt;&amp;gt; $GITHUB_ENV â€‹ - name: Set up QEMU uses: docker/setup-qemu-action@v2 - name: Set up Docker Buildx uses: docker/setup-buildx-action@v2 â€‹ - name: Login to docker hub uses: docker/login-action@v2 with: username: poneding password: ${{ secrets.</description></item><item><title/><link>https://blog.poneding.com/git/github-host-helm-chart/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/github-host-helm-chart/</guid><description>ğŸ  é¦–é¡µ / Git / ä½¿ç”¨ GitHub æ‰˜ç®¡ helm-chart ä»“åº“
ä½¿ç”¨ GitHub æ‰˜ç®¡ helm-chart ä»“åº“ # helm å®˜æ–¹æ–‡æ¡£ï¼š
Helm | Chart Releaser Action to Automate GitHub Page Charts åˆ›å»º GitHub ä»“åº“ï¼Œä¾‹å¦‚ï¼šhelm-chartsï¼Œå…‹éš†åˆ°æœ¬åœ°ã€‚ git clone git@github.com:[gh_id]/helm-charts.git cd helm-charts åˆ›å»ºå¹²å‡€çš„ gh-pages åˆ†æ”¯ã€‚ git checkout --orphan gh-pages git rm -rf . vim README.md # helm-charts ## Usage [Helm](https://helm.sh) must be installed to use the charts. Please refer to Helm&amp;#39;s [documentation](https://helm.sh/docs) to get started. Once Helm has been set up correctly, add the repo as follows: ```bash helm repo add mycharts https://[gh_id].</description></item><item><title/><link>https://blog.poneding.com/git/github-hosting-helm-reop/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/github-hosting-helm-reop/</guid><description>ğŸ  é¦–é¡µ / Git / GitHub æ‰˜ç®¡ helm-chart ä»“åº“
GitHub æ‰˜ç®¡ helm-chart ä»“åº“ # åˆ›å»º GitHub ä»“åº“ # åˆ›å»º GitHub helm charts ä»“åº“ï¼Œä¾‹å¦‚ï¼šhelm-chartsï¼Œå…‹éš†åˆ°æœ¬åœ°ã€‚
git clone git@github.com:poneding/helm-charts.git cd helm-charts åˆ›å»º gh-pages å­¤ç«‹åˆ†æ”¯ # git checkout --orphan gh-pages git rm -rf . vim README.md ç¼–å†™ README.md æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š
# helm-charts ## Usage [Helm](https://helm.sh) must be installed to use the charts. Please refer to Helm&amp;#39;s [documentation](https://helm.sh/docs) to get started. Once Helm has been set up correctly, add the repo as follows: ```bash helm repo add poneding https://poneding.</description></item><item><title/><link>https://blog.poneding.com/git/github/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/github/</guid><description>ğŸ  é¦–é¡µ / Git / GitHub
GitHub # GitHub æ‰˜ç®¡ helm chart ä»“åº“ # GitHub æ‰˜ç®¡ helm chart ä»“åº“
è·å–ä»“åº“æœ€æ–° Release çš„ç‰ˆæœ¬ # æ–¹æ³•ä¸€ï¼š
curl -s https://api.github.com/repos/ketches/registry-proxy/releases/latest | jq -r .tag_name æ–¹æ³•äºŒï¼š
basename $(curl -s -w %{redirect_url} https://github.com/ketches/registry-proxy/releases/latest) README ç¾åŒ– # å¾½æ ‡ # [![Go Report Card](https://goreportcard.com/badge/github.com/ketches/registry-proxy)](https://goreportcard.com/report/github.com/ketches/registry-proxy) [![Go Doc](https://pkg.go.dev/badge/github.com/ketches/registry-proxy)](https://pkg.go.dev/github.com/ketches/registry-proxy) [![GitHub release](https://img.shields.io/github/v/release/ketches/registry-proxy)](https://img.shields.io/github/v/release/ketches/registry-proxy) [![GitHub license](https://img.shields.io/github/license/ketches/registry-proxy)](https://img.shields.io/github/license/ketches/registry-proxy) [![GitHub stars](https://img.shields.io/github/stars/ketches/registry-proxy)](https://img.shields.io/github/stars/ketches/registry-proxy) [![GitHub forks](https://img.shields.io/github/forks/ketches/registry-proxy)](https://img.shields.io/github/forks/ketches/registry-proxy) Stars èµ°åŠ¿ # [![Stargazers over time](https://starchart.cc/ketches/registry-proxy.svg?variant=adaptive)](https://starchart.cc/ketches/registry-proxy) è´¡çŒ®è€…åˆ—è¡¨ # ![Contributors](https://contrib.rocks/image?repo=ketches/registry-proxy) Â« GitHub æ‰˜ç®¡ helm-chart ä»“åº“</description></item><item><title/><link>https://blog.poneding.com/git/gitlab-intergrate-k8s/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/gitlab-intergrate-k8s/</guid><description>ğŸ  é¦–é¡µ / Git / Gitlab æ·»åŠ  K8s é›†ç¾¤
Gitlab æ·»åŠ  K8s é›†ç¾¤ # æœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨ Gitlab é¡¹ç›®ä¸­æ·»åŠ  K8s é›†ç¾¤ï¼Œä»¥ä¾¿ä½¿ç”¨ K8s é›†ç¾¤éƒ¨ç½² gitlab-runner å¸®æˆ‘ä»¬è¿è¡Œ gitlab çš„ CI/CDã€‚
å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š https://docs.gitlab.com/ee/user/project/clusters/add_remove_clusters.html#add-existing-cluster
æ“ä½œæ­¥éª¤ # æ‰¾åˆ°æ·»åŠ ä½ç½®ï¼š
ç™»å…¥ gitlab åï¼Œè¿›å…¥è‡ªå·±çš„é¡¹ç›®ä¸»é¡µï¼Œèœå•æ  Operations =&amp;gt; Kubernetes =&amp;gt; Add Kubernetes clusterï¼Œé€‰æ‹©é¡µç­¾ Add existing clusterã€‚
æˆ‘ä»¬åªéœ€è¦è·å–å“åº”çš„å€¼å¡«å½•åˆ°è¯¥è¡¨å•å³å¯ã€‚Kubernetes cluster name é›†ç¾¤åç§°éšæ„å¡«ï¼ŒProject namespace å¯ä¸å¡«ã€‚
è·å– API URLï¼š
è¿è¡Œä»¥ä¸‹å‘½ä»¤å¾—åˆ°è¾“å‡ºå€¼ï¼š
kubectl cluster-info | grep &amp;#39;Kubernetes master&amp;#39; | awk &amp;#39;/http/ {print $NF}&amp;#39; è·å– CA Certificateï¼š
è¿è¡Œä»¥ä¸‹å‘½ä»¤å¾—åˆ°è¾“å‡ºå€¼ï¼š</description></item><item><title/><link>https://blog.poneding.com/git/gitlab-upgrade-cross-version/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/gitlab-upgrade-cross-version/</guid><description>ğŸ  é¦–é¡µ / Git / Gitlab è·¨ç‰ˆæœ¬å‡çº§
Gitlab è·¨ç‰ˆæœ¬å‡çº§ # æœ¬æ–‡è®°å½• Gitlab è·¨ç‰ˆæœ¬å‡çº§çš„å…·ä½“æ“ä½œè¿‡ç¨‹ã€‚
æŒ‰ç…§å®˜æ–¹çš„è¯´æ³•ï¼Œgitlab å…è®¸å°ç‰ˆæœ¬ç›´æ¥å‡çº§ï¼Œå¤§ç‰ˆæœ¬éœ€è¦é˜¶æ®µå‡çº§ã€‚
è·¨ç‰ˆæœ¬å‡çº§ç¤ºä¾‹ï¼š11.0.x -&amp;gt; 11.11.x -&amp;gt; 12.0.x -&amp;gt; 12.10.x -&amp;gt; 13.0.xã€‚
å®˜æ–¹æ¨èçš„å‡çº§è·¯çº¿æ–‡æ¡£ï¼š https://docs.gitlab.com/ee/policy/maintenance.html#upgrade-recommendations
ç›®çš„ # å®ç° gitlab ç‰ˆæœ¬ï¼š11.2.3 åˆ° 13.0.0 ç‰ˆæœ¬çš„å‡çº§ï¼Œæˆ‘é€‰æ‹©çš„å‡çº§è·¯çº¿æ˜¯ï¼š11.2.3 =&amp;gt; 11.11.8 =&amp;gt; 12.0.12 =&amp;gt; 12.10.6 =&amp;gt; 13.0.0 =&amp;gt; 13.1.2
æˆ‘å½“å‰åˆ›å»º gitlab å®¹å™¨çš„è„šæœ¬å¦‚ä¸‹ï¼š
sudo docker run --detach \ --hostname gitlab.example.com \ --publish 8443:443 --publish 8080:80 --publish 8022:22 \ --name gitlab \ --restart always \ --volume /home/ubuntu/Apps/gitlab/etc/gitlab:/etc/gitlab \ --volume /home/ubuntu/Apps/gitlab/var/log/gitlab/logs:/var/log/gitlab \ --volume /home/ubuntu/Apps/gitlab/var/opt/gitlab:/var/opt/gitlab \ gitlab/gitlab-ce:11.</description></item><item><title/><link>https://blog.poneding.com/git/multi-github-account-management/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/multi-github-account-management/</guid><description>ğŸ  é¦–é¡µ / Git / å¤š GitHub è´¦å·ç®¡ç†
å¤š GitHub è´¦å·ç®¡ç† # å®é™…å¼€å‘å·¥ä½œä¸­ï¼Œä½ æœ‰å¯èƒ½å¤šä¸ª GitHub è´¦å·ï¼šä¸ªäººå¼€å‘è´¦å·ï¼Œå·¥ä½œå¼€å‘è´¦å·ã€‚
åœ¨ä»“åº“ä»£ç ç®¡ç†çš„è¿‡ç¨‹ä¸­ä½ éœ€è¦é‡å¤çš„ä½¿ç”¨ git config user.* æ¥åˆ‡æ¢ä»£ç æäº¤è´¦å·ï¼Œå¾ˆæ˜¯éº»çƒ¦ã€‚ä»¥ä¸‹æ–¹æ¡ˆå¯ä»¥å¸®ä½ è§£å†³ä½ çš„çƒ¦æ¼ã€‚
è¯·ç¡®ä¿ä½ çš„ git ç‰ˆæœ¬æœ€ä½ä¸º 2.13
~/.gitconfig
[user] name = poneding email = poneding@gmail.com [includeIf &amp;#34;gitdir:~/src/workspace/&amp;#34;] path = ~/src/workspace/.gitconfig [url &amp;#34;git@github-workspace&amp;#34;] insteadOf = git@github.com [pull] rebase = false [init] defaultBranch = master [core] excludesfile = ~/.gitignore_global ~/src/workspace/.gitconfig
[user] name = dingpeng24001 email = dingpeng24001@talkweb.com.cn [url &amp;#34;git@github-workspace&amp;#34;] insteadOf = git@github.com [pull] rebase = false [init] defaultBranch = master [core] excludesfile = ~/.</description></item><item><title/><link>https://blog.poneding.com/git/simplest-git-server/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/git/simplest-git-server/</guid><description>ğŸ  é¦–é¡µ / Git / æ­å»ºæœ€ç®€å•çš„ git ä»“åº“æœåŠ¡
æ­å»ºæœ€ç®€å•çš„ git ä»“åº“æœåŠ¡ # è¿œç«¯ # åˆ›å»ºä»“åº“æœåŠ¡ç›®å½•ï¼š
git init --bare git-server-demo.git å…¶å®ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ç»ˆç«¯åˆ›å»ºï¼Œä½†æ˜¯ä½ é¦–å…ˆè¦å¯ä»¥èƒ½å¤Ÿé€šè¿‡ ssh çš„æ–¹å¼è¿æ¥è¿œç«¯ï¼Œä¾‹å¦‚è¿œç«¯ IP æ˜¯ 192.168.10.24
ssh root@192.168.10.24 git init --bare git-server-demo.git æ‰§è¡Œå®Œå‘½ä»¤ä¹‹åï¼Œå°†åœ¨è¿œç«¯ç›®æ ‡ç›®å½•ä¸‹ç”Ÿæˆ git-server-demo ç›®å½•ï¼Œå­ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š
tree git-server-demo.git git-server-demo.git â”œâ”€â”€ branches â”œâ”€â”€ config â”œâ”€â”€ description â”œâ”€â”€ HEAD â”œâ”€â”€ hooks â”‚Â â”œâ”€â”€ applypatch-msg.sample â”‚Â â”œâ”€â”€ commit-msg.sample â”‚Â â”œâ”€â”€ fsmonitor-watchman.sample â”‚Â â”œâ”€â”€ post-update.sample â”‚Â â”œâ”€â”€ pre-applypatch.sample â”‚Â â”œâ”€â”€ pre-commit.sample â”‚Â â”œâ”€â”€ pre-merge-commit.sample â”‚Â â”œâ”€â”€ prepare-commit-msg.</description></item><item><title/><link>https://blog.poneding.com/go/dev-env-config/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/dev-env-config/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Go å¼€å‘ç¯å¢ƒé…ç½®
Go å¼€å‘ç¯å¢ƒé…ç½® # cobra-cli # å®‰è£…ï¼š
go install github.com/spf13/cobra-cli@latest è‡ªåŠ¨è¡¥å…¨ï¼š
cobra-cli completion zsh &amp;gt; .zfunc/_cobra-cli åœ¨ .zshrc æ–‡ä»¶ä¸­æ·»åŠ å†…å®¹ï¼ˆå¦‚æœå·²æ·»åŠ ï¼Œåˆ™å¿½ç•¥ï¼‰ï¼š
fpath+=~/.zfunc autoload -Uz compinit &amp;amp;&amp;amp; compinit Â» Golang å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼</description></item><item><title/><link>https://blog.poneding.com/go/function-optional-pattern/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/function-optional-pattern/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼
Golang å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼ # å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼ # type Server struct { Addr string Timeout time.Duration } type Option func(*Server) func newServer(addr string, options ...Option) (*Server, error) { s := &amp;amp;Server{ Addr: addr, } for _, opt := range options { opt(s) } // ... return s, nil } func WithTimeout(timeout time.Duration) Option { return func(s *Server) { s.Timeout = timeout } } é€šç”¨å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼ # type BasicService struct { redisClient string } type ServiceOption func(*BasicService) func WithRedisClient(redisClient string) ServiceOption { return func(s *BasicService) { s.</description></item><item><title/><link>https://blog.poneding.com/go/go-cert-management/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-cert-management/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å¯†é’¥å¯¹ã€æ•°å­—ç­¾åå’Œè¯ä¹¦ç®¡ç†
Golang å¯†é’¥å¯¹ã€æ•°å­—ç­¾åå’Œè¯ä¹¦ç®¡ç† # Golang å®ç°å¯†é’¥å¯¹ç”Ÿæˆ ç›¸å½“äºä½¿ç”¨ openssl ç”Ÿæˆç§é’¥å’Œå…¬é’¥ï¼š
openssl genrsa -out pri.key 2048 openssl rsa -in pri.key -pubout -out pub.key package main import ( &amp;#34;crypto/rand&amp;#34; &amp;#34;crypto/rsa&amp;#34; ) func GenerateKeyPair() (*rsa.PrivateKey, *rsa.PublicKey, error) { prikey, err := rsa.GenerateKey(rand.Reader, 2048) if err != nil { return nil, nil, err } return prikey, &amp;amp;prikey.PublicKey, nil } å®ç°åŠ å¯†å’Œè§£å¯† åŠ å¯†è§£å¯†ï¼šå…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†
package main import ( &amp;#34;crypto/rand&amp;#34; &amp;#34;crypto/rsa&amp;#34; ) func Encrypt(data []byte, publicKey *rsa.</description></item><item><title/><link>https://blog.poneding.com/go/go-cross-complie/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-cross-complie/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang ä¸åŒå¹³å°æ¶æ„ç¼–è¯‘
Golang ä¸åŒå¹³å°æ¶æ„ç¼–è¯‘ # åœ¨ MacOS å¹³å°ç¼–è¯‘æˆ Windowsã€Linux å¯æ‰§è¡Œæ–‡ä»¶ï¼š
CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go CGO_ENABLED=0 GOOS=linux GOARCH=arm64 go build main.go CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build main.go CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build main.go åœ¨ Windows å¹³å°ç¼–è¯‘æˆ Linuxã€MacOS å¯æ‰§è¡Œæ–‡ä»¶ï¼š
$env:GOOS = &amp;#34;linux&amp;#34;;$env:CGO_ENABLED = &amp;#34;0&amp;#34;;$env:GOARCH = &amp;#34;amd64&amp;#34;;go build carbon/carbon.go $env:GOOS = &amp;#34;linux&amp;#34;;$env:CGO_ENABLED = &amp;#34;0&amp;#34;;$env:GOARCH = &amp;#34;arm64&amp;#34;;go build carbon/carbon.go $env:GOOS = &amp;#34;darwin&amp;#34;;$env:CGO_ENABLED = &amp;#34;0&amp;#34;;$env:GOARCH = &amp;#34;amd64&amp;#34;;go build carbon/carbon.</description></item><item><title/><link>https://blog.poneding.com/go/go-gen-cert/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-gen-cert/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang ç”Ÿæˆè¯ä¹¦
Golang ç”Ÿæˆè¯ä¹¦ # ä»£ç å®ç° # package certutil import ( &amp;#34;bytes&amp;#34; &amp;#34;crypto/rand&amp;#34; &amp;#34;crypto/rsa&amp;#34; &amp;#34;crypto/x509&amp;#34; &amp;#34;crypto/x509/pkix&amp;#34; &amp;#34;encoding/pem&amp;#34; &amp;#34;math/big&amp;#34; &amp;#34;net&amp;#34; &amp;#34;time&amp;#34; ) // CA ca type CA struct { caInfo *x509.Certificate caPrivKey *rsa.PrivateKey caPem, caKeyPem []byte } // GetCAPem get ca pem bytes func (c *CA) GetCAPem() ([]byte, error) { if c.caPem == nil { // create the CA caBytes, err := x509.CreateCertificate(rand.Reader, c.caInfo, c.</description></item><item><title/><link>https://blog.poneding.com/go/go-linkname/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-linkname/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / go:linkname æŒ‡ä»¤
go:linkname æŒ‡ä»¤ # èƒŒæ™¯ # é˜…è¯» Golang æºç æ—¶ï¼Œå‘ç°åœ¨æ ‡å‡†åº“ time.Sleep æ–¹æ³•æ²¡æœ‰æ²¡æœ‰æ–¹æ³•ä½“ã€‚å¦‚ä¸‹ï¼š
// Sleep pauses the current goroutine for at least the duration d. // A negative or zero duration causes Sleep to return immediately. func Sleep(d Duration) å½“æˆ‘ä»¬ç›´æ¥åœ¨ä»£ç ä¸­å†™ä¸€ä¸ªç©ºæ–¹æ³• func Foo()ï¼Œç¼–è¯‘æ—¶ä¼šæŠ¥é”™ï¼šmissing function bodyã€‚æ‰€ä»¥æ ‡å‡†åº“ä½¿ç”¨äº†ä»€ä¹ˆé­”æ³•æ¥å®ç°ç©ºæ–¹æ³•çš„å‘¢ï¼Ÿ è¿›ä¸€æ­¥ç ”ç©¶ï¼Œå¾—çŸ¥ time.Sleep è¿è¡Œæ—¶å®é™…è°ƒç”¨äº† runtime.timeSleepæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š
// timeSleep puts the current goroutine to sleep for at least ns nanoseconds. // //go:linkname timeSleep time.</description></item><item><title/><link>https://blog.poneding.com/go/go-list-to-tree/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-list-to-tree/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang åˆ—è¡¨è½¬æ ‘
Golang åˆ—è¡¨è½¬æ ‘ # åœºæ™¯ä»‹ç» # ä»æ•°æ®åº“è·å–åˆ°äº†èœå•åˆ—è¡¨æ•°æ®ï¼Œè¿™äº›èœå•æ•°æ®é€šè¿‡å­—æ®µ ParentID è¡¨ç¤ºçˆ¶å­å±‚çº§å…³ç³»ï¼Œç°åœ¨éœ€è¦å°†èœå•åˆ—è¡¨æ•°æ®è½¬æˆæ ‘çŠ¶çš„å®ä¾‹å¯¹è±¡ã€‚
æ•°æ®åº“å–å‡ºçš„åˆå§‹æ•°æ®ï¼š
raw := []Menu{ {Name: &amp;#34;ä¸€çº§èœå• 1&amp;#34;, ID: 1, PID: 0}, {Name: &amp;#34;ä¸€çº§èœå• 2&amp;#34;, ID: 2, PID: 0}, {Name: &amp;#34;ä¸€çº§èœå• 3&amp;#34;, ID: 3, PID: 0}, {Name: &amp;#34;äºŒçº§èœå• 1-1&amp;#34;, ID: 11, PID: 1}, {Name: &amp;#34;äºŒçº§èœå• 1-2&amp;#34;, ID: 12, PID: 1}, {Name: &amp;#34;äºŒçº§èœå• 1-3&amp;#34;, ID: 13, PID: 1}, {Name: &amp;#34;äºŒçº§èœå• 2-1&amp;#34;, ID: 21, PID: 2}, {Name: &amp;#34;äºŒçº§èœå• 2-2&amp;#34;, ID: 22, PID: 2}, {Name: &amp;#34;äºŒçº§èœå• 2-3&amp;#34;, ID: 23, PID: 2}, } éœ€è¦å¾—åˆ°çš„ç›®æ ‡æ•°æ®ï¼š</description></item><item><title/><link>https://blog.poneding.com/go/go-mtls/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-mtls/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å®ç°åŒå‘è®¤è¯
Golang å®ç°åŒå‘è®¤è¯ # TLS # ä¼ è¾“å±‚å®‰å…¨åè®®ï¼ˆTLSï¼‰ï¼Œåœ¨äº’è”ç½‘ä¸Šï¼Œé€šå¸¸æ˜¯ç”±æœåŠ¡å™¨å•å‘çš„å‘å®¢æˆ·ç«¯æä¾›è¯ä¹¦ï¼Œä»¥è¯æ˜å…¶èº«ä»½ã€‚
mTLS # åŒå‘ TLS è®¤è¯ï¼Œæ˜¯æŒ‡åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä½¿ç”¨åŒè¡ŒåŠ å¯†é€šé“ï¼ŒmTLS æ˜¯äº‘åŸç”Ÿåº”ç”¨ä¸­å¸¸ç”¨çš„é€šä¿¡å®‰å…¨åè®®ã€‚
ä½¿ç”¨åŒå‘TLSè¿æ¥çš„ä¸»è¦ç›®çš„æ˜¯å½“æœåŠ¡å™¨åº”è¯¥åªæ¥å—æ¥è‡ªæœ‰é™çš„å…è®¸çš„å®¢æˆ·ç«¯çš„ TLS è¿æ¥æ—¶ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç»„ç»‡å¸Œæœ›å°†æœåŠ¡å™¨çš„ TLS è¿æ¥é™åˆ¶ä¸ºåªæ¥è‡ªè¯¥ç»„ç»‡çš„åˆæ³•åˆä½œä¼™ä¼´æˆ–å®¢æˆ·ã€‚æ˜¾ç„¶ï¼Œä¸ºå®¢æˆ·ç«¯æ·»åŠ IPç™½åå•ä¸æ˜¯ä¸€ä¸ªå¥½çš„å®‰å…¨å®è·µï¼Œå› ä¸ºIPå¯èƒ½è¢«æ¬ºéª—ã€‚
ä¸ºäº†ç®€åŒ– mTLS æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¿™æ ·ç®€å•æ¢³ç†ï¼š
å®¢æˆ·ç«¯å‘é€è®¿é—®æœåŠ¡å™¨ä¸Šå—ä¿æŠ¤ä¿¡æ¯çš„è¯·æ±‚ï¼› æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æä¾›å…¬é’¥è¯ä¹¦ï¼› å®¢æˆ·ç«¯é€šè¿‡ä½¿ç”¨ CA çš„å…¬é’¥æ¥éªŒè¯æœåŠ¡å™¨å…¬é’¥è¯ä¹¦çš„æ•°å­—ç­¾åï¼Œä»¥éªŒè¯æœåŠ¡å™¨çš„è¯ä¹¦ï¼› å¦‚æœæ­¥éª¤ 3 æˆåŠŸï¼Œå®¢æˆ·æœºå°†å…¶å®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦å‘é€åˆ°æœåŠ¡å™¨ï¼› æœåŠ¡å™¨ä½¿ç”¨æ­¥éª¤ 3 ä¸­ç›¸åŒçš„æ–¹æ³•éªŒè¯å®¢æˆ·æœºçš„è¯ä¹¦ï¼› å¦‚æœæˆåŠŸï¼ŒæœåŠ¡å™¨å°†å¯¹å—ä¿æŠ¤ä¿¡æ¯çš„è®¿é—®æƒæˆäºˆå®¢æˆ·æœºã€‚ ä»£ç å®ç° # éœ€è¦å®ç°å®¢æˆ·ç«¯éªŒè¯æœåŠ¡ç«¯çš„å…¬é’¥è¯ä¹¦ï¼ŒæœåŠ¡ç«¯éªŒè¯å®¢æˆ·ç«¯çš„å…¬é’¥è¯ä¹¦ã€‚
ç”Ÿæˆè¯ä¹¦ # echo &amp;#39;æ¸…ç†å¹¶ç”Ÿæˆç›®å½•&amp;#39; OUT=./certs DAYS=365 RSALEN=2048 CN=poneding rm -rf ${OUT}/* mkdir ${OUT} &amp;gt;&amp;gt; /dev/null 2&amp;gt;&amp;amp;1 cd ${OUT} echo &amp;#39;ç”ŸæˆCAçš„ç§é’¥&amp;#39; openssl genrsa -out ca.key ${RSALEN} &amp;gt;&amp;gt; /dev/null 2&amp;gt;&amp;amp;1 echo &amp;#39;ç”ŸæˆCAçš„ç­¾åè¯ä¹¦&amp;#39; openssl req -new \ -x509 \ -key ca.</description></item><item><title/><link>https://blog.poneding.com/go/go-publish-package-01/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-publish-package-01/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å‘å¸ƒç±»åº“ - 1
Golang å‘å¸ƒç±»åº“ - 1 # æœ¬é¡µä»‹ç»å¦‚ä½•åœ¨ Github ä¸Šå‘å¸ƒæˆ‘ä»¬è‡ªå·±çš„ Golang ç±»åº“ã€‚
1ã€åˆ›å»º github ä»“åº“æ‰˜ç®¡ go ç±»åº“ä»£ç ï¼Œä¾‹å¦‚ common-goï¼šï¼š
2ã€å°†ä»“åº“å…‹éš†è‡³æœ¬åœ°ï¼šï¼š
git clone https://github.com/poneding/common-go.git 3ã€åˆå§‹åŒ–goç±»åº“çš„moduleï¼šï¼š
cd common-go go mod init github.com/poneding/common-go mkdir hello æ³¨æ„ï¼š
ä½¿ç”¨ go env å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å¼€å¯ go-module åŠŸèƒ½ï¼Œå¦‚æœæ²¡å¼€å¯éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ï¼šgo env -w GO111MODULE=onï¼›
module åç§°éœ€è¦ä¸ github ä»“åº“ä¸€è‡´ï¼Œè¿™æ ·å…¶ä»–äººæ‰èƒ½é€šè¿‡ go get github.com/poneding/commmon-go ä¸‹è½½åˆ°ä½ çš„ç±»åº“ã€‚
4ã€ç¼–å†™ go ç±»åº“ä»£ç ï¼Œä¾‹å¦‚ï¼šï¼š
hell/hello.goï¼š
package hello import &amp;#34;fmt&amp;#34; func Say(name string) { fmt.</description></item><item><title/><link>https://blog.poneding.com/go/go-publish-package-02/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-publish-package-02/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å‘å¸ƒç±»åº“ - 2
Golang å‘å¸ƒç±»åº“ - 2 # æœ¬é¡µä»‹ç»å¦‚ä½•åœ¨ Github ä¸Šå‡çº§æˆ‘ä»¬å·²å‘å¸ƒçš„ Golang ç±»åº“ã€‚
Go ç±»åº“ç‰ˆæœ¬è§„åˆ™ # go ç±»åº“ç‰ˆæœ¬çš„è§„åˆ™ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·ï¼Œå…¶ä¸­ï¼š
ä¸»ç‰ˆæœ¬å·ï¼šç±»åº“è¿›è¡Œäº†ä¸å¯å‘ä¸‹å…¼å®¹çš„ä¿®æ”¹ï¼Œä¾‹å¦‚åŠŸèƒ½é‡æ„ï¼Œè¿™æ—¶å€™ä¸»ç‰ˆæœ¬å·å¾€ä¸Šè¿½åŠ ï¼› æ¬¡ç‰ˆæœ¬å·ï¼šç±»åº“è¿›è¡Œäº†å¯å‘ä¸‹å…¼å®¹çš„ä¿®æ”¹ï¼Œä¾‹å¦‚æ–°å¢åŠŸèƒ½ï¼Œè¿™æ—¶å€™æ¬¡ç‰ˆæœ¬å·å¾€ä¸Šè¿½åŠ ï¼› ä¿®è®¢å·ï¼šç±»åº“è¿›è¡Œäº†å¯å‘ä¸‹å…¼å®¹çš„ä¿®æ”¹ï¼ˆä¿®æ”¹çš„è§„æ¨¡æ›´å°ï¼‰ï¼Œä¾‹å¦‚ä¿®å¤æˆ–ä¼˜åŒ–åŠŸèƒ½ï¼Œè¿™æ—¶å€™ä¿®è®¢å¥½å¾€ä¸Šè¿½åŠ ã€‚ Go ç±»åº“å‘ç‰ˆç¤ºä¾‹ # åŒæ ·ä»¥ github.com/poneding/common-go ç±»åº“ä¸ºç¤ºä¾‹ã€‚
å°ç‰ˆæœ¬å‡çº§ # ä¸»ç‰ˆæœ¬ä¸å‡çº§ï¼Œæ¬¡ç‰ˆæœ¬æˆ–ä¿®è®¢ç‰ˆæœ¬å‡çº§ã€‚
v0.x.x ç‰ˆæœ¬å‡çº§è‡³ v1.x.x ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥å‡çº§çš„ã€‚
å½“å‰ç‰ˆæœ¬æ˜¯ v1.0.0ï¼Œç°å¯¹è¯¥ç±»åº“è¿›è¡Œäº†åŠŸèƒ½ä¿®æ”¹ï¼Œå‘å¸ƒ v1.0.1 ç‰ˆæœ¬ï¼š
1ã€åˆ‡æ¢è‡³ v1 åˆ†æ”¯ï¼š
git checkout v1 2ã€ä¿®æ”¹ç±»åº“ä»£ç ï¼š
hello/hello.goï¼š
package hello import &amp;#34;fmt&amp;#34; func Say(name string) { fmt.Printf(&amp;#34;Hello, %s\n&amp;#34;, name) fmt.Println(&amp;#34;common-go version: v1.0.1&amp;#34;) } 3ã€æäº¤ä»£ç å¹¶å‘å¸ƒï¼š</description></item><item><title/><link>https://blog.poneding.com/go/go-solid/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-solid/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Go ç¨‹åº SOLID è®¾è®¡åŸåˆ™
Go ç¨‹åº SOLID è®¾è®¡åŸåˆ™ # å¯é‡ç”¨è½¯ä»¶è®¾è®¡çš„äº”ä¸ªåŸåˆ™ï¼ŒSOLID åŸåˆ™ï¼š
å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principleï¼‰ å¼€æ”¾ / å°é—­åŸåˆ™ï¼ˆOpen / Closed Principleï¼‰ é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰ æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰ ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversion Principleï¼‰ å•ä¸€èŒè´£åŸåˆ™ # SOLID çš„ç¬¬ä¸€ä¸ªåŸåˆ™ï¼ŒSï¼Œæ˜¯å•ä¸€è´£ä»»åŸåˆ™ã€‚
A class should have one, and only one, reason to change. â€“ Robert C Martin
ç°åœ¨ Go æ˜¾ç„¶æ²¡æœ‰ classses - ç›¸åï¼Œæˆ‘ä»¬æœ‰æ›´å¼ºå¤§çš„ç»„åˆæ¦‚å¿µ - ä½†æ˜¯å¦‚æœä½ èƒ½å›é¡¾ä¸€ä¸‹ class è¿™ä¸ªè¯çš„ç”¨æ³•ï¼Œæˆ‘è®¤ä¸ºæ­¤æ—¶ä¼šæœ‰ä¸€å®šä»·å€¼ã€‚
ä¸ºä»€ä¹ˆä¸€æ®µä»£ç åªæœ‰ä¸€ä¸ªæ”¹å˜çš„åŸå› å¾ˆé‡è¦ï¼Ÿå—¯ï¼Œå°±åƒä½ è‡ªå·±çš„ä»£ç å¯èƒ½ä¼šæ”¹å˜ä¸€æ ·ä»¤äººæ²®ä¸§ï¼Œå‘ç°æ‚¨çš„ä»£ç æ‰€ä¾èµ–çš„ä»£ç åœ¨æ‚¨è„šä¸‹å‘ç”Ÿå˜åŒ–æ›´ç—›è‹¦ã€‚å½“ä½ çš„ä»£ç å¿…é¡»æ”¹å˜æ—¶ï¼Œå®ƒåº”è¯¥å“åº”ç›´æ¥åˆºæ¿€ä½œå‡ºæ”¹å˜ï¼Œè€Œä¸åº”è¯¥æˆä¸ºé™„å¸¦æŸå®³çš„å—å®³è€…ã€‚
å› æ­¤ï¼Œå…·æœ‰å•ä¸€è´£ä»»çš„ä»£ç ä¿®æ”¹çš„åŸå› æœ€å°‘ã€‚
è€¦åˆå’Œå†…èš # æè¿°æ”¹å˜ä¸€ä¸ªè½¯ä»¶æ˜¯å¤šä¹ˆå®¹æ˜“æˆ–å›°éš¾çš„ä¸¤ä¸ªè¯æ˜¯ï¼šè€¦åˆå’Œå†…èšã€‚</description></item><item><title/><link>https://blog.poneding.com/go/go-stdlib/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-stdlib/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang æ ‡å‡†åº“
Golang æ ‡å‡†åº“ # fmt # æ ¼å¼åŒ–æ‰“å°
%v åŸæ ·è¾“å‡º %T æ‰“å°ç±»å‹ %t bool %s string %f float %d 10è¿›åˆ¶æ•´æ•° %b 2è¿›åˆ¶æ•´æ•° %o 8è¿›åˆ¶æ•´æ•° %x 16è¿›åˆ¶æ•´æ•° 0-9ï¼Œa-f %X 16è¿›åˆ¶æ•´æ•° 0-9ï¼ŒA-F %c char %p pointer %.2f float ä¿ç•™ä¸¤ä½ path # file := &amp;#34;./logs/2021-01-25/error.log&amp;#34; fileName := path.Base(file) # è¿”å›æ–‡ä»¶åï¼šerror.log fileExt := path.Ext(file) # è¿”å›æ–‡ä»¶åç¼€ï¼š.log fileDir := path.Dir(file) # è¿”å›æ–‡ä»¶è·¯å¾„ï¼š ./logs/2021-01-25 os/exec # Golangè¯­è¨€æœ‰ä¸€ä¸ªåŒ…å«åš os/execï¼Œä½¿ç”¨è¯¥åŒ…å¯ä»¥ç›´æ¥åœ¨ç¨‹åºä¸­è°ƒç”¨ä¸»æœºçš„å‘½ä»¤ï¼Œä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š
func OsExecUsage() error { fmt.</description></item><item><title/><link>https://blog.poneding.com/go/go-testing/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-testing/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / testing
testing # å‘½ä»¤ # æµ‹è¯•
go test -run=TestCompare -v . è¿è¡Œæµ‹è¯•ï¼Œæµ‹è¯•å‡½æ•°åç§°ä¸­ä»…åŒ…å« TestCompare å‰ç¼€ã€‚
åˆ—å‡ºåŒ…å†…æµ‹è¯•æ–‡ä»¶
go list -f={{.GoTestFiles}} . åˆ—å‡ºåŒ…å¤–æµ‹è¯•æ–‡ä»¶
go list -f={{.XTestGoFiles}} . åŒ…å†…æµ‹è¯•ï¼šæµ‹è¯•æ–‡ä»¶çš„åŒ…åç§°ä¸è¢«æµ‹åŒ…ä¸€è‡´ï¼Œå¯ä»¥è®¿é—®è¢«æµ‹åŒ…å†…æ‰€æœ‰æˆå‘˜ï¼Œç›¸å½“äºç™½ç›’æµ‹è¯•ï¼›
åŒ…å¤–æµ‹è¯•ï¼šæµ‹è¯•æ–‡ä»¶çš„åŒ…åç§°ä¸è¢«æµ‹åŒ…ä¸ä¸€è‡´ï¼Œä¸€èˆ¬åœ¨è¢«æµ‹åŒ…åç§°åé¢æ·»åŠ  _test åç¼€ï¼Œåªèƒ½è®¿é—®è¢«æµ‹åŒ…å†…å…¬å¼€æˆå‘˜ï¼Œç›¸å½“äºé»‘ç›’æµ‹è¯•ã€‚
Â« Golang æ ‡å‡†åº“
Â» Golang</description></item><item><title/><link>https://blog.poneding.com/go/go/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang
Golang # èµ„æ–™ # Go å®‰å…¨æŒ‡å— Go è¯­è¨€ç¼–ç¨‹è§„èŒƒ Golang channel # golang å®ç°å¹¶å‘æ˜¯é€šè¿‡é€šä¿¡å…±äº«å†…å­˜ï¼Œchannel æ˜¯ go è¯­è¨€ä¸­goroutine çš„é€šä¿¡ç®¡é“ï¼Œé€šè¿‡ channel å°†å€¼ä»ä¸€ä¸ª goroutine å‘é€åˆ°å¦ä¸€ä¸ª goroutineã€‚
è¯­æ³• # åˆ›å»º channelï¼š
ä½¿ç”¨ make() å‡½æ•°åˆ›å»ºï¼š
ch := make(chan int) é»˜è®¤åˆ›å»ºä¸€ä¸ªæ— ç¼“å­˜ channelã€‚
å‘é€æ•°æ®åˆ° channelï¼š
ch &amp;lt;- x ä» channel è¯»å–æ•°æ®ï¼š
x := &amp;lt;-ch å…³é—­ channelï¼š
ä½¿ç”¨ close() å‡½æ•°å…³é—­ï¼š
close(ch) å½“ä½ çš„ç¨‹åºä¸å†éœ€è¦å¾€ channel ä¸­å‘é€æ•°æ®æ—¶ï¼Œå¯ä»¥å…³é—­ channelã€‚
å¦‚æœå¾€å·²ç»å…³é—­çš„ channal å‘é€æ•°æ®ï¼Œç¨‹åºå‘ç”Ÿå¼‚å¸¸ã€‚
æ— ç¼“å†² channel # å¦‚æœå½“å‰æ²¡æœ‰ä¸€ä¸ª goroutine å¯¹æ— ç¼“å†² channel æ¥æ”¶æ•°æ®ï¼Œé‚£ä¹ˆæ— ç¼“å†² channel ä¼šé˜»æ­¢å‘é€æ•°æ®ã€‚</description></item><item><title/><link>https://blog.poneding.com/go/gopkg-errors/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/gopkg-errors/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / gopkg-errors.md
title: Go åŒ… - errors date: 2022-10-19T14:44:06+08:00 lastmod: 2022-11-03T03:32:31.646Z tags:
Golang gopkg keywords: Golang gopkg errors weight: 1 errors åŒ…ä¸ºä½ çš„ Go ç¨‹åºæä¾›ä¸€ç§å¯¹ç¨‹åºå‘˜è°ƒè¯•ã€æŸ¥çœ‹æ—¥å¿—æ›´å‹å¥½çš„é”™è¯¯å¤„ç†æ–¹å¼ã€‚
Go ç¨‹åºä¸­ä¼ ç»Ÿçš„é”™è¯¯å¤„ç†æ–¹æ³•ï¼š
if err != nil { return err } é€’å½’çš„å‘ä¸Šä¼ é€’é”™è¯¯ï¼Œè¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªç¼ºé™·ï¼šæœ€ç»ˆå¤„ç†é”™è¯¯çš„ä½ç½®æ— æ³•è·å–é”™è¯¯çš„è°ƒç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚
errors åŒ…ä»¥ä¸ç ´åé”™è¯¯çš„åŸå§‹å€¼çš„æ–¹å¼å‘é”™è¯¯ä¸­çš„æ·»åŠ è°ƒç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚
è·å–åŒ… # go get github.com/pkg/errors é”™è¯¯æ·»åŠ ä¸Šä¸‹æ–‡ # The errors.Wrap function returns a new error that adds context to the original error. For example
_, err := ioutil.ReadAll(r) if err !</description></item><item><title/><link>https://blog.poneding.com/go/goreleaser/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/goreleaser/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Goreleaser
Goreleaser # Go ç¨‹åºé¡¹ç›®çš„è‡ªåŠ¨åŒ–å‘å¸ƒå·¥å…·ï¼Œç®€å•çš„å‘å¸ƒå‘½ä»¤å¸®åŠ©æˆ‘ä»¬çœå»å¤§é‡çš„é‡å¤å·¥ä½œã€‚
å®‰è£… # MacOsï¼š
brew install goreleaser/tap/goreleaser æºç ç¼–è¯‘ï¼š
git clone https://github.com/goreleaser/goreleaser cd goreleaser go get ./... go build -o goreleaser . ./goreleaser --version åˆå§‹åŒ– # åœ¨goé¡¹ç›®ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆ.goreleaser.ymlæ–‡ä»¶ï¼š
goreleaser init ç”Ÿæˆæ–‡ä»¶åï¼Œè‡ªè¡Œé…ç½®ï¼Œç›¸ä¿¡ä½ èƒ½çœ‹çš„æ‡‚ã€‚
éªŒè¯ .goreleaser.yml # goreleaser check ä½¿ç”¨æœ¬åœ°ç¯å¢ƒæ„å»º
goreleaser build --single-target é…ç½® github token # token å¿…é¡»è‡³å°‘åŒ…å« write:package æƒé™ï¼Œæ‰èƒ½ä¸Šä¼ åˆ°å‘å¸ƒèµ„æºä¸­ã€‚
ä»githubç”Ÿæˆtokenï¼Œå†™å…¥æ–‡ä»¶ï¼š
mkdir ~/.config/goreleaser vim ~/.config/goreleaser/github_token æˆ–è€…ç›´æ¥åœ¨ç»ˆç«¯å¯¼å…¥ç¯å¢ƒé…ç½®ï¼š
export GITHUB_TOKEN=&amp;#34;YOUR_GITHUB_TOKEN&amp;#34; ä¸ºé¡¹ç›®æ‰“ä¸Š tag # git tag v0.</description></item><item><title/><link>https://blog.poneding.com/go/mac-appl-silicon-cross-compile-cgo/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/mac-appl-silicon-cross-compile-cgo/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Mac M1 äº¤å‰ç¼–è¯‘ CGO
Mac M1 äº¤å‰ç¼–è¯‘ CGO # æ–¹æ³•ä¸€ # 1ã€å®‰è£…ä¾èµ–
brew tap messense/macos-cross-toolchains brew install x86_64-unknown-linux-gnu brew install aarch64-unknown-linux-gnu 2ã€æ·»åŠ åˆ° PATH
export PATH=$PATH:/opt/homebrew/Cellar/x86_64-unknown-linux-gnu/11.2.0_1/bin::/opt/homebrew/Cellar/aarch64-unknown-linux-gnu/11.2.0_1/bin 3ã€ç¼–è¯‘ CGO ç¨‹åº
CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-unknown-linux-gnu-gcc CXX=x86_64-unknown-linux-gnu-g++ go build CGO_ENABLED=1 GOOS=linux GOARCH=arm64 CC=aarch64-unknown-linux-gnu-gcc CXX=aarch64-unknown-linux-gnu-g++ go build æ–¹æ³•äºŒ # 1ã€å®‰è£…ä¾èµ–
brew install FiloSottile/musl-cross/musl-cross 2ã€æ·»åŠ åˆ° PATH
export PATH=$PATH:/opt/homebrew/Cellar/musl-cross/0.9.9_1/bin 3ã€ç¼–è¯‘ CGO ç¨‹åº
# -tags=musl ä¸èƒ½çœç•¥ä¸ç„¶ä¼šå‡ºç°å…¶ä»–é”™è¯¯ CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-linux-musl-gcc CXX=x86_64-linux-musl-g++ go build -tags=musl # å¦‚æœlinuxä¸æƒ³å®‰è£…muslæ”¯æŒ CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-linux-musl-gcc CXX=x86_64-linux-musl-g++ CGO_LDFLAGS=&amp;#34;-static&amp;#34; go build -tags=musl CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-linux-musl-gcc CGO_LDFLAGS=&amp;#34;-static&amp;#34; go build CGO_ENABLED=1 GOOS=linux GOARCH=arm64 CC=x86_64-linux-musl-gcc CGO_LDFLAGS=&amp;#34;-static&amp;#34; go build å‚è€ƒ # https://blog.</description></item><item><title/><link>https://blog.poneding.com/go/pprof/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/pprof/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / pprof
pprof # pprof æ˜¯æ€§èƒ½è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥ç”Ÿæˆç±»ä¼¼ç«ç„°å›¾ã€å †æ ˆå›¾ï¼Œå†…å­˜åˆ†æå›¾ç­‰ã€‚
package main import ( &amp;#34;fmt&amp;#34; &amp;#34;math/rand&amp;#34; &amp;#34;net/http&amp;#34; &amp;#34;time&amp;#34; _ &amp;#34;net/http/pprof&amp;#34; ) // åƒå†…å­˜ type Eater struct { Name string Buffer [][]int } var e Eater func main() { e = Eater{Name: &amp;#34;eater&amp;#34;} http.HandleFunc(&amp;#34;/go&amp;#34;, goHandler) http.ListenAndServe(&amp;#34;:8080&amp;#34;, nil) // å¦‚æœä¸ä½¿ç”¨é»˜è®¤çš„ muxï¼ˆhttp.DefaultServeMuxï¼‰ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼é›†æˆ pprof // mux := http.NewServeMux() // mux.HandleFunc(&amp;#34;/go&amp;#34;, goHandler) // mux.HandleFunc(&amp;#34;/debug/pprof/&amp;#34;, pprof.Index) // mux.HandleFunc(&amp;#34;/debug/pprof/cmdline&amp;#34;, pprof.Cmdline) // mux.HandleFunc(&amp;#34;/debug/pprof/profile&amp;#34;, pprof.Profile) // mux.HandleFunc(&amp;#34;/debug/pprof/symbol&amp;#34;, pprof.</description></item><item><title/><link>https://blog.poneding.com/go/ssh-keygen-with-go/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/ssh-keygen-with-go/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / ä½¿ç”¨ Go ç”Ÿæˆ OpenSSH å…¼å®¹çš„ RSA å¯†é’¥å¯¹
ä½¿ç”¨ Go ç”Ÿæˆ OpenSSH å…¼å®¹çš„ RSA å¯†é’¥å¯¹ # æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ssh-keygen å‘½ä»¤ç”Ÿæˆä¸€å¯¹ç”¨äº SSH è®¿é—®çš„ç§é’¥å’Œå…¬é’¥ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Go ç”Ÿæˆä¸€å¯¹ OpenSSH å…¼å®¹çš„ RSA å¯†é’¥å¯¹ã€‚
ä»¥ä¸‹ä»£ç ä¸­ GenOpenSSHKeyPair æ–¹æ³•ç”¨äºç”Ÿæˆä¸€å¯¹ç”¨äº SSH è®¿é—®çš„ç§é’¥å’Œå…¬é’¥ã€‚ç”Ÿæˆçš„ç§é’¥ä»¥ PEM ç¼–ç ï¼Œå…¬é’¥ä»¥ OpenSSH authorized_keys æ–‡ä»¶ä¸­åŒ…å«çš„æ ¼å¼è¿›è¡Œç¼–ç ã€‚
package util import ( &amp;#34;crypto/rand&amp;#34; &amp;#34;crypto/rsa&amp;#34; &amp;#34;crypto/x509&amp;#34; &amp;#34;encoding/pem&amp;#34; &amp;#34;golang.org/x/crypto/ssh&amp;#34; ) // GenOpenSSHKeyPair make a pair of private and public keys for SSH access. // Private Key generated is PEM encoded // Public key is encoded in the format for inclusion in an OpenSSH authorized_keys file.</description></item><item><title/><link>https://blog.poneding.com/graphql/graphql/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/graphql/graphql/</guid><description>ğŸ  é¦–é¡µ / Graphql / Graphql
Graphql # https://graphql.cn/learn/
ä»‹ç» # ä¸€ç§ API æŸ¥è¯¢è¯­è¨€ï¼Œä¹Ÿæ˜¯ä¸€ç§æ»¡è¶³ä½¿ç”¨ç°æœ‰æ•°æ®å®Œæˆå‡ ä¹æ‰€æœ‰æ•°æ®æŸ¥è¯¢çš„è¿è¡Œæ—¶ã€‚
å¯¹ API æ•°æ®æä¾›å¯ç†è§£çš„å®Œæ•´æè¿°ï¼Œèµ‹äºˆå®¢æˆ·ç«¯å‡†ç¡®è·å–æ‰€éœ€æ•°æ®ï¼Œä½¿å¾— API çš„æ¼”è¿›æ›´åŠ è½»æ¾ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥æ„å»ºå¼ºå¤§çš„å¼€å‘è€…å·¥å…·ï¼ˆLowCode?ï¼‰ã€‚
ç‰¹æ€§ # æ‰€å¾—å³æ‰€å–ï¼š
è¯·æ±‚ä»€ä¹ˆï¼Œè¿”å›ä»€ä¹ˆï¼Œå› ä¸ºæ€»æ˜¯æ ¹æ®ä½ è¯·æ±‚çš„ç»“æ„è¿”å›å¯é¢„è§çš„ç»“æœã€‚
å•å–å¤šå¾—ï¼š
å•æ¬¡è¯·æ±‚ï¼Œè¿”å›å¤šç§ç»“æ„çš„æ•°æ®ï¼Œä¸ä»…å¯¹èµ„æºå±æ€§æŸ¥è¯¢ï¼Œè€Œä¸”è¿˜ä¼šæ²¿ç€èµ„æºçš„å¼•ç”¨å…³ç³»è¿›ä¸€æ­¥æŸ¥è¯¢ã€‚
è¿™ä¹Ÿæ˜¯å¯¹æ¯” Restful API çš„ä¸€ç§ä¼˜åŠ¿ï¼ŒRestful API å¯¹å¤šèµ„æºçš„æŸ¥è¯¢æ—¶ï¼Œå¾€å¾€éœ€è¦å¤šæ¬¡è®¿é—®ä¸åŒçš„APIï¼Œè¿™æ— ç–‘å¢åŠ äº†ç½‘ç»œè¿æ¥çš„å‹åŠ›ã€‚
ç±»å‹ç³»ç»Ÿæè¿°æ‰€æœ‰ï¼š
GraphQL API åŸºäºç±»å‹å’Œå­—æ®µçš„æ–¹å¼è¿›è¡Œç»„ç»‡ï¼Œè€Œéå…¥å£ç«¯ç‚¹ã€‚ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªå•ä¸€å…¥å£ç«¯ç‚¹å¾—åˆ°ä½ çš„è®¿é—®æ•°æ®çš„æ‰€æœ‰èƒ½åŠ›ã€‚GraphQL ä½¿ç”¨ç±»å‹æ¥ä¿è¯åº”ç”¨åªè¯·æ±‚å¯èƒ½çš„æ•°æ®ï¼Œå¦åˆ™ä¼šæä¾›äº†æ˜ç¡®çš„æœ‰ç”¨çš„é”™è¯¯ä¿¡æ¯ã€‚åº”ç”¨ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»å‹ï¼Œè€Œé¿å…ç¼–å†™æ‰‹åŠ¨è§£æä»£ç ã€‚
APIæ— ç‰ˆæœ¬ï¼š
API æ¼”è¿›åªéœ€è¦å¾€ Graphql ç±»å‹ç³»ç»Ÿä¸­æ·»åŠ å­—æ®µå’Œç±»å‹ï¼Œè€Œä¸å½±å“ç°æœ‰æŸ¥è¯¢ã€‚
ç»Ÿä¸€å…±äº«ï¼š
GraphQL è®©ä½ çš„æ•´ä¸ªåº”ç”¨å…±äº«ä¸€å¥— APIï¼Œè€Œä¸ç”¨è¢«é™åˆ¶äºç‰¹å®šå­˜å‚¨å¼•æ“ã€‚GraphQL å¼•æ“å·²ç»æœ‰å¤šç§è¯­è¨€å®ç°ï¼Œé€šè¿‡ GraphQL API èƒ½å¤Ÿæ›´å¥½åˆ©ç”¨ä½ çš„ç°æœ‰æ•°æ®å’Œä»£ç ã€‚ä½ åªéœ€è¦ä¸ºç±»å‹ç³»ç»Ÿçš„å­—æ®µç¼–å†™å‡½æ•°ï¼ŒGraphQL å°±èƒ½é€šè¿‡ä¼˜åŒ–å¹¶å‘çš„æ–¹å¼æ¥è°ƒç”¨å®ƒä»¬ã€‚
èµ„æºå®šä¹‰ï¼Œè¯·æ±‚å’Œå“åº” # æ•°æ®æè¿°ï¼š
type User { name: String phone: String Friends: [User] } æ•°æ®è¯·æ±‚ï¼š
{ user(name: &amp;#34;dp&amp;#34;) { phone } } è¯·æ±‚ç»“æœï¼š</description></item><item><title/><link>https://blog.poneding.com/grpc/gRPC/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/grpc/gRPC/</guid><description> ğŸ  é¦–é¡µ / Grpc / gRPC å®æˆ˜
gRPC å®æˆ˜ # å‡†å¤‡ # golang 1.13+ Protoc</description></item><item><title/><link>https://blog.poneding.com/istio/aws-acm-tls-management/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/aws-acm-tls-management/</guid><description>ğŸ  é¦–é¡µ / Istio / ä½¿ç”¨ aws-acm ç®¡ç† tls å¯†é’¥å’Œè¯ä¹¦
ä½¿ç”¨ aws-acm ç®¡ç† tls å¯†é’¥å’Œè¯ä¹¦ # å‚è€ƒï¼š https://medium.com/faun/managing-tls-keys-and-certs-in-istio-using-amazons-acm-8ff9a0b99033
åœ¨Ingressgateway serviceçš„annotationä¸­æ·»åŠ :
kind: Service apiVersion: v1 metadata: name: my-ingressgateway namespace: istio-system labels: app: my-ingressgateway annotations: # external-dns.alpha.kubernetes.io/hostname: example.com service.beta.kubernetes.io/aws-load-balancer-backend-protocol: http service.beta.kubernetes.io/aws-load-balancer-connection-idle-timeout: &amp;#39;3600&amp;#39; service.beta.kubernetes.io/aws-load-balancer-ssl-cert: &amp;gt;- arn:aws:acm:ap-southeast-1:xxxxxxxxxxxx:certificate/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx service.beta.kubernetes.io/aws-load-balancer-ssl-ports: https .... service.yaml:
apiVersion: v1 kind: Service metadata: name: demo-api labels: app: demop-api spec: ports: - name: http port: 80 targetPort: 80 selector: app: demo-api pod æ‰€åœ¨çš„ namespace éœ€è¦å¼€å¯ istio-injectionï¼Œä¾‹å¦‚ï¼škubectl label namespace default istio-injection=enabled</description></item><item><title/><link>https://blog.poneding.com/istio/installation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/installation/</guid><description>ğŸ  é¦–é¡µ / Istio / å®‰è£… Istio
å®‰è£… Istio # å®‰è£…istioctl # Step 1 ä¸‹è½½ï¼š
ä»¥ä¸‹æ“ä½œæ­¥éª¤é»˜è®¤ä¼šå®‰è£…æœ€æ–°ç‰ˆ istioctlã€‚
curl -L https://istio.io/downloadIstio | sh - ä»¥ä¸Šå‘½ä»¤é»˜è®¤ä¼šå®‰è£…æœ€æ–°ç‰ˆ istioctlï¼Œå¦‚æœéœ€è¦å®‰è£…æŒ‡å®šç‰ˆæœ¬ä¾‹å¦‚ 1.6.8ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ã€‚
curl -L https://istio.io/downloadIstio | ISTIO_VERSION=1.6.8 TARGET_ARCH=x86_64 sh - Step 2 é…ç½®ï¼š
step 1ä¼šä¸‹è½½istioåŒ…ï¼Œç›®å½•istio-{ISTIO_VERSION}ï¼Œè¿›å…¥ç›®å½•
cd istio-{ISTIO_VERSION} æ‹·è´binç›®å½•ä¸‹çš„istioctläºŒè¿›åˆ¶æ–‡ä»¶åˆ°PATHç›®å½•ä¸‹ï¼š
cp bin/istio /usr/local/bin Â« ä½¿ç”¨ aws-acm ç®¡ç† tls å¯†é’¥å’Œè¯ä¹¦
Â» æˆæƒç­–ç•¥ Authorization Policy</description></item><item><title/><link>https://blog.poneding.com/istio/istio-auth-policy/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/istio-auth-policy/</guid><description>ğŸ  é¦–é¡µ / Istio / æˆæƒç­–ç•¥ Authorization Policy
æˆæƒç­–ç•¥ Authorization Policy # æˆæƒæ¶æ„ # ç”±äºæœåŠ¡ç½‘æ ¼çš„ Sidecar è®¾è®¡æ¨¡å¼ï¼Œæ¯ä¸ªå·¥ä½œè´Ÿè½½éƒ½ä¼šæœ‰ä¸€ä¸ª Envoy ä»£ç†ï¼Œè€Œæ¯ä¸ªä»£ç†éƒ½è¿è¡Œç€æˆæƒå¼•æ“ï¼Œä»¥æ­¤ç»™è¯·æ±‚æˆæƒã€‚æˆæƒå¼•æ“ä¾é æˆæƒç­–ç•¥æ¥é‰´å®šè¯·æ±‚æƒé™ï¼Œè¿”å› ALLOW æˆ– DENY é‰´æƒç»“æœã€‚
æˆæƒå¯ç”¨ # å°†æˆæƒç­–ç•¥åº”ç”¨åˆ°å·¥ä½œè´Ÿè½½å³ç”Ÿæ•ˆè®¿é—®æ§åˆ¶ã€‚å¯¹äºæ²¡æœ‰åº”ç”¨æˆæƒç­–ç•¥çš„å·¥ä½œè´Ÿè½½ï¼Œåˆ™ä¸ä¼šå¯¹è¯·æ±‚åšè®¿é—®æ§åˆ¶ã€‚
æˆæƒç­–ç•¥ # èµ„æºå®šä¹‰ # selectorï¼š
æ ‡ç­¾é€‰æ‹©å™¨ï¼Œé€šè¿‡æ ‡ç­¾é€‰æ‹©å™¨é€‰æ‹©åŒå‘½åç©ºé—´ä¸‹çš„ç›®æ ‡å·¥ä½œè´Ÿè½½ï¼Œå¯¹ç›®æ ‡å·¥ä½œè´Ÿè½½å¯ç”¨è®¿é—®æ§åˆ¶ã€‚
actionï¼š
å½“æ»¡è¶³rulesæ¡ä»¶æ—¶ï¼Œæ§åˆ¶ALLOWæˆ–DENYè¯·æ±‚ã€‚
rulesï¼š
è®¿é—®æ§åˆ¶çš„è¯·æ±‚æ¡ä»¶ï¼š
fromï¼šè¯·æ±‚æ¥æº toï¼šè¯·æ±‚ç›®æ ‡ whenï¼šåº”ç”¨è§„åˆ™æ‰€éœ€çš„æäº¤ ç¤ºä¾‹ # ä»¥ä¸‹æˆæƒç­–ç•¥å…è®¸ä¸¤ä¸ªæºï¼ˆæœåŠ¡å¸å· cluster.local/ns/default/sa/sleep å’Œå‘½åç©ºé—´ devï¼‰ï¼Œåœ¨ä½¿ç”¨æœ‰æ•ˆçš„ JWT ä»¤ç‰Œå‘é€è¯·æ±‚æ—¶ï¼Œå¯ä»¥è®¿é—®å‘½åç©ºé—´ foo ä¸­çš„å¸¦æœ‰æ ‡ç­¾ app: httpbin å’Œ version: v1 çš„å·¥ä½œè´Ÿè½½ã€‚
apiVersion: security.istio.io/v1beta1 kind: AuthorizationPolicy metadata: name: httpbin namespace: foo spec: selector: matchLabels: app: httpbin version: v1 action: ALLOW rules: - from: - source: principals: [&amp;#34;cluster.</description></item><item><title/><link>https://blog.poneding.com/istio/istio-canary-deploy/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/istio-canary-deploy/</guid><description>ğŸ  é¦–é¡µ / Istio / åº”ç”¨å¹³å°å®ç°åº”ç”¨é‡‘ä¸é›€å‘å¸ƒ
åº”ç”¨å¹³å°å®ç°åº”ç”¨é‡‘ä¸é›€å‘å¸ƒ # å®ç°æ€è·¯ # åº”ç”¨æ­£å¸¸çš„ CI æµç¨‹æ·»åŠ è¯·æ±‚å‚æ•°ï¼š
CanaryModeã€boolï¼Œtrue | falseï¼Œç¼ºçœå€¼ falseã€‘ CanaryWeight ã€intï¼Œç¼ºçœå€¼ 10ã€‘ ä½¿ç”¨ Istio çš„ DetinationRule + VirtualService å®ç°æµé‡æŒ‰æƒé‡åˆ†é…åˆ°ä¸åŒç‰ˆæœ¬åº”ç”¨ã€‚
æ¦‚å¿µ # Iterationï¼šå‘å¸ƒè¿­ä»£å·ï¼Œã€‚æ˜¯ä¸€ä¸ªå­—æ®µå€¼ï¼Œä½¿ç”¨é‡‘ä¸é›€å‘å¸ƒæ—¶ç´¯åŠ è¯¥å€¼ï¼Œä» 0 ç´¯åŠ ã€‚
Retractï¼šåŠ¨ä½œï¼Œå¼ƒç”¨é‡‘ä¸é›€ç‰ˆæœ¬ã€‚å½“é‡‘ä¸é›€ç‰ˆæœ¬å­˜åœ¨ä¸å¯å¿½è§†çš„é—®é¢˜æ—¶æ’¤å›é‡‘ä¸é›€æ‰§è¡Œè¯¥åŠ¨ä½œã€‚
Ratifyï¼šåŠ¨ä½œï¼Œç¡®è®¤ä½¿ç”¨é‡‘ä¸é›€ç‰ˆæœ¬ã€‚å½“é‡‘ä¸é›€ç‰ˆæœ¬ç¡®è®¤å¯ä»¥å…¨é¢æŠ•å…¥ä½¿ç”¨æ‰§è¡Œè¯¥åŠ¨ä½œã€‚
å‰æ # ä½¿ç”¨é‡‘ä¸é›€å‘å¸ƒçš„å‰ææ¡ä»¶ï¼š
åº”ç”¨å¤„äºå‘å¸ƒçŠ¶æ€ï¼Œå·²ç»è‡³å°‘å‘å¸ƒä¸€æ¬¡ï¼Œå½“å‰å­˜åœ¨ç¨³å®šçš„è¿è¡Œç‰ˆæœ¬ï¼› åº”ç”¨å·²ç»å¼€å¯ Istio Gatewayï¼Œæ¶‰åŠåˆ° VirtualService çš„æµé‡è½¬å‘ï¼› åº”ç”¨å½“å‰ä¸æ˜¯é‡‘ä¸é›€çŠ¶æ€ï¼Œè¦ä¸ç„¶ä¹±å¥—äº†ã€‚ å‘å¸ƒç»†èŠ‚ # CI å‘å¸ƒé™¤äº†åˆ›å»ºæˆ–æ›´æ–° Deploymentï¼ŒService ä¹‹å¤–ï¼Œé»˜è®¤åˆ›å»ºæˆ–æ›´æ–° istio çš„ DestinationRule èµ„æºï¼›
deploymentï¼š
apiVersion: apps/v1 kind: Deployment metadata: name: myapp-pbd3n69-v{iteration} # å‡ºäºå…¼å®¹å†å²å‘å¸ƒï¼Œå½“iterationä¸º0æ—¶ï¼Œnameä¸é™„å¸¦iterationï¼Œiterationå¤§äº0æ—¶ï¼Œnameå°†é™„å¸¦iteration labels: app: myapp-pbd3n69 version: v{iteration} spec: selector: matchLabels: app: myapp-pbd3n69 version: v{iteration} template: metadata: labels: app: myapp-pbd3n69 version: v{iteration} .</description></item><item><title/><link>https://blog.poneding.com/istio/istio-cors/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/istio-cors/</guid><description>ğŸ  é¦–é¡µ / Istio / Istio 0-1 ä½¿ç”¨Istioå®ç°Cors
Istio 0-1 ä½¿ç”¨Istioå®ç°Cors # Cors # Corsï¼ˆCross-Origin Resource Sharingï¼‰ï¼šè·¨åŸŸèµ„æºå…±äº«ï¼Œæ˜¯ä¸€ç§åŸºäº HTTP Header çš„æœºåˆ¶ï¼Œè¯¥æœºåˆ¶é€šè¿‡å…è®¸æœåŠ¡å™¨æ ‡ç¤ºé™¤äº†å®ƒè‡ªå·±ä»¥å¤–çš„å…¶å®ƒ originï¼ˆåŸŸï¼Œåè®®å’Œç«¯å£ï¼‰ï¼Œè¿™æ ·æµè§ˆå™¨å¯ä»¥è®¿é—®åŠ è½½è¿™äº›èµ„æºã€‚è·¨æºèµ„æºå…±äº«è¿˜é€šè¿‡ä¸€ç§æœºåˆ¶æ¥æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦ä¼šå…è®¸è¦å‘é€çš„çœŸå®è¯·æ±‚ï¼Œè¯¥æœºåˆ¶é€šè¿‡æµè§ˆå™¨å‘èµ·ä¸€ä¸ªåˆ°æœåŠ¡å™¨æ‰˜ç®¡çš„è·¨æºèµ„æºçš„&amp;quot;é¢„æ£€&amp;quot;è¯·æ±‚ã€‚åœ¨é¢„æ£€ä¸­ï¼Œæµè§ˆå™¨å‘é€çš„å¤´ä¸­æ ‡ç¤ºæœ‰ HTTP æ–¹æ³•å’ŒçœŸå®è¯·æ±‚ä¸­ä¼šç”¨åˆ°çš„å¤´ã€‚
è·¨æºHTTPè¯·æ±‚çš„ä¸€ä¸ªä¾‹å­ï¼šè¿è¡Œåœ¨ https://a.com çš„JavaScriptä»£ç ä½¿ç”¨ XMLHttpRequestæ¥å‘èµ·ä¸€ä¸ªåˆ° https://b.com/data.js çš„è¯·æ±‚ã€‚
å‡ºäºå®‰å…¨æ€§ï¼Œæµè§ˆå™¨é™åˆ¶è„šæœ¬å†…å‘èµ·çš„è·¨åŸŸ HTTP è¯·æ±‚ã€‚ ä¾‹å¦‚ï¼ŒXMLHttpRequest å’Œ Fetch API éµå¾ªåŒæºç­–ç•¥ã€‚ è¿™æ„å‘³ç€ä½¿ç”¨è¿™äº› API çš„ Web åº”ç”¨ç¨‹åºåªèƒ½ä»åŠ è½½åº”ç”¨ç¨‹åºçš„åŒä¸€ä¸ªåŸŸè¯·æ±‚ HTTP èµ„æºï¼Œé™¤éå“åº”æŠ¥æ–‡åŒ…å«äº†æ­£ç¡® CORS å“åº”å¤´ã€‚
æ›´å¤š Cors çŸ¥è¯†ï¼š è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰
Istio å®ç° # åŸºäº Istio VirtualService çš„é…ç½®å®ç°ã€‚
å®˜æ–¹æ–‡æ¡£ï¼š Istio / Virtual Service#CorsPolicy
åœ¨ç›®æ ‡æœåŠ¡ä¸Šè®¾ç½®å…è®¸çš„è¯·æ±‚åŸŸ Helloï¼š
apiVersion: networking.istio.io/v1beta1 kind: VirtualService metadata: name: b spec: http: - route: - destination: host: b.</description></item><item><title/><link>https://blog.poneding.com/istio/istio-timeout/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/istio-timeout/</guid><description>ğŸ  é¦–é¡µ / Istio / ä½¿ç”¨ Istio å®ç°æœåŠ¡è¶…æ—¶
ä½¿ç”¨ Istio å®ç°æœåŠ¡è¶…æ—¶ # å‚è€ƒ # https://www.servicemesher.com/blog/circuit-breaking-and-outlier-detection-in-istio/ è¶…æ—¶ # ä¸ºäº†é˜²æ­¢æ— é™æœŸçš„ç­‰å¾…æœåŠ¡ï¼Œä¸€èˆ¬éƒ½ä¼šç»™æœåŠ¡è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ŒAWS çš„ LoadBalancer é»˜è®¤çš„è¶…æ—¶æ—¶é—´æ˜¯ 60sã€‚ä½†æ˜¯ä¸åŒçš„æœåŠ¡ï¼Œå¯èƒ½éœ€è¦ä¸åŒçš„è¶…æ—¶è®¾ç½®ï¼Œä¾‹å¦‚ DocumentApi è¶…æ—¶æ—¶é—´å¯èƒ½éœ€è¦è®¾ç½®çš„é•¿ä¸€ç‚¹ã€‚
LoadBalancer çš„è¶…æ—¶æ˜¯å…¨å±€çš„ï¼Œæˆ‘ä»¬åŸºäº Istio æœåŠ¡ç½‘æ ¼é›†æˆäº†é’ˆå¯¹å•ä¸ªæœåŠ¡çš„è¶…æ—¶åŠŸèƒ½ã€‚
é‡è¯• # é‡è¯•ä¹Ÿæ˜¯ä¸€ä¸ªæœåŠ¡å¾ˆå¸¸ç”¨çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æŸæ¬¡è¯·æ±‚åˆ†é…åˆ°äº†ä¸€ä¸ªé—®é¢˜èŠ‚ç‚¹ï¼Œè¯·æ±‚å¤±è´¥ï¼Œåˆ™è‡ªåŠ¨é‡è¯•ç‰¹å®šæ¬¡æ•°ã€‚
ç†”æ–­/é™æµ # ä¸ºäº†é˜²æ­¢å¤§é‡æ¶Œå…¥è¯·æ±‚ä½¿å¾—æœåŠ¡å´©æºƒï¼Œå¼•å…¥ç†”æ–­åŠŸèƒ½ã€‚ç†”æ–­ï¼Œå¯ä»¥é™åˆ¶å½“å‰è¯·æ±‚è¿æ¥æ•°åœ¨ä¸€ä¸ªç‰¹å®šèŒƒå›´å†…ã€‚
é…ç½®æœåŠ¡ VirtualService æ—¢å¯å®ç°ï¼š
apiVersion: networking.istio.io/v1beta1 kind: VirtualService metadata: name: myapp spec: hosts: - myapp http: - route: - destination: host: myapp subset: v1 timeout: 1s timeoutï¼šè¯·æ±‚è¶…è¿‡è®¾å®šçš„è¶…æ—¶æ—¶é—´ï¼Œå“åº”è¿”å› 504 è¯·æ±‚è¶…æ—¶ã€‚
Â« Istio 0-1 ä½¿ç”¨Istioå®ç°Cors
Â» åº”ç”¨å±‚çº§è®¾ç½®è®¿é—®ç™½åå•</description></item><item><title/><link>https://blog.poneding.com/istio/istio-white-manifest/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/istio-white-manifest/</guid><description>ğŸ  é¦–é¡µ / Istio / åº”ç”¨å±‚çº§è®¾ç½®è®¿é—®ç™½åå•
åº”ç”¨å±‚çº§è®¾ç½®è®¿é—®ç™½åå• # éœ€æ±‚ # ä¸¤ä¸ªåº”ç”¨ï¼Œfoo å’Œ barï¼Œåº”ç”¨ foo åªå…è®¸ IP åœ°å€ä¸º 1.2.3.4 è®¿é—®ï¼Œåº”ç”¨ bar åªå…è®¸ IP åœ°å€ä¸º 5.6.7.8 è®¿é—®ã€‚
å®ç° # åŸºäº istio çš„ AuthorizationPolicy å®ç°ã€‚
å‡è®¾ï¼Œç°åœ¨ K8s é›†ç¾¤ä¸­å·²ç»å®‰è£… istioï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæ­£åœ¨è¿è¡Œç€çš„ istio-ingressgateway è½¬å‘åº”ç”¨ foo å’Œ barï¼š
é€šè¿‡ï¼š https://www.example.com/foo è®¿é—® foo;
é€šè¿‡ï¼š https://www.example.com/bar è®¿é—® bar;
æ’æ›² # æŒ‰ç…§ istio å®˜æ–¹æ–‡æ¡£ï¼Œä½¿ç”¨ AuthorizationPolicy å³å¯å®ç°åŸºäºåº”ç”¨å±‚çº§çš„è®¿é—®ç™½åå•è®¾ç½®ï¼š
apiVersion: security.istio.io/v1beta1 kind: AuthorizationPolicy metadata: name: foo spec: selector: matchLabels: app: foo action: ALLOW rules: - from: - source: ipBlocks: [&amp;#34;1.</description></item><item><title/><link>https://blog.poneding.com/istio/Istio/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/Istio/</guid><description>ğŸ  é¦–é¡µ / Istio / Istio
Istio # ç®€ä»‹ # Istioï¼Œæ˜¯ä¸€ç§æœåŠ¡ç½‘æ ¼çš„å¹³å°ã€‚åœ¨å¾®æœåŠ¡ç³»ç»Ÿä¸­èµ·ç€è¿æ¥ï¼Œä¿æŠ¤ï¼Œæ§åˆ¶å’Œè§‚å¯ŸæœåŠ¡çš„ä½œç”¨ã€‚å®ƒå¯ä»¥é™ä½å¾®æœåŠ¡éƒ¨ç½²çš„å¤æ‚ç¨‹åº¦ï¼Œå‡è½»å¼€å‘å›¢é˜Ÿå‹åŠ›ï¼Œæ— ç¼æ¥å…¥ç°æœ‰åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œå¯ä»¥é›†æˆæ—¥å¿—ï¼Œé¥æµ‹ï¼Œå’Œç­–ç•¥ç³»ç»Ÿçš„ API æ¥å£ã€‚
æœåŠ¡ç½‘æ ¼ï¼š
Service Mesh æ˜¯ä¸€ä¸ªåŸºç¡€è®¾æ–½å±‚ï¼Œç”¨äºå¤„ç†æœåŠ¡é—´é€šä¿¡ã€‚äº‘åŸç”Ÿåº”ç”¨æœ‰ç€å¤æ‚çš„æœåŠ¡æ‹“æ‰‘ï¼ŒService Mesh ä¿è¯è¯·æ±‚å¯ä»¥åœ¨è¿™äº›æ‹“æ‰‘ä¸­å¯é åœ°ç©¿æ¢­ã€‚åœ¨å®é™…åº”ç”¨å½“ä¸­ï¼ŒService Mesh é€šå¸¸æ˜¯ç”±ä¸€ç³»åˆ—è½»é‡çº§çš„ç½‘ç»œä»£ç†ç»„æˆçš„ï¼Œå®ƒä»¬ä¸åº”ç”¨ç¨‹åºéƒ¨ç½²åœ¨ä¸€èµ·ï¼Œä½†åº”ç”¨ç¨‹åºä¸éœ€è¦çŸ¥é“å®ƒä»¬çš„å­˜åœ¨ã€‚
ç”¨æ¥æè¿°ç»„æˆåº”ç”¨ç¨‹åºçš„å¾®æœåŠ¡ç½‘ç»œä»¥åŠå®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚
å®ç°éœ€æ±‚åŒ…æ‹¬ï¼š
æœåŠ¡å‘ç° è´Ÿè½½å‡è¡¡ æ•…éšœæ¢å¤ æŒ‡æ ‡å’Œç›‘æ§ A/B æµ‹è¯• é‡‘ä¸é›€å‘å¸ƒ é€Ÿç‡æ§åˆ¶ è®¿é—®æ§åˆ¶ ç«¯åˆ°ç«¯è®¤è¯ istioctl # ç®¡ç† istio çš„å‘½ä»¤è¡Œå·¥å…·ã€‚
å®‰è£… # curl -L https://istio.io/downloadIstio | sh - cp istio-x.x.x /usr/local cd istio-x.x.x export PATH=$PWD/bin:$PATH Istio çš„ç»å¤§å¤šæ•°æ²»ç†èƒ½åŠ›éƒ½æ˜¯åœ¨ Sidecar è€Œéåº”ç”¨ç¨‹åºä¸­å®ç°ï¼Œå› æ­¤æ˜¯éä¾µå…¥çš„ï¼› Istio çš„è°ƒç”¨é“¾åŸ‹ç‚¹é€»è¾‘ä¹Ÿæ˜¯åœ¨ Sidecar ä»£ç†ä¸­å®Œæˆï¼Œå¯¹åº”ç”¨ç¨‹åºéä¾µå…¥ï¼Œä½†åº”ç”¨ç¨‹åºéœ€åšé€‚å½“çš„ä¿®æ”¹ï¼Œå³é…åˆåœ¨è¯·æ±‚å¤´ä¸Šä¼ é€’ç”Ÿæˆçš„ Trace ç›¸å…³ä¿¡æ¯ã€‚ å…³é”®åŠŸèƒ½ï¼š
æµé‡ç®¡ç† å¯è§‚å¯Ÿæ€§ ç­–ç•¥æ‰§è¡Œ æœåŠ¡èº«ä»½å’Œå®‰å…¨ å¹³å°æ”¯æŒ é›†æˆå’Œå®šåˆ¶ æ¶æ„ # æ•°æ®é¢æ¿ # Envoy # Envoy æ˜¯ç”¨ C++ å¼€å‘çš„é«˜æ€§èƒ½ä»£ç†ï¼Œç”¨äºåè°ƒæœåŠ¡ç½‘æ ¼ä¸­æ‰€æœ‰æœåŠ¡çš„å…¥ç«™å’Œå‡ºç«™æµé‡ã€‚Envoy ä»£ç†æ˜¯å”¯ä¸€ä¸æ•°æ®å¹³é¢æµé‡äº¤äº’çš„ Istio ç»„ä»¶ã€‚</description></item><item><title/><link>https://blog.poneding.com/istio/tls-transform/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/tls-transform/</guid><description>ğŸ  é¦–é¡µ / Istio / å®ç° Https åè®®çš„è½¬å‘
å®ç° Https åè®®çš„è½¬å‘ # apiVersion: networking.istio.io/v1beta1 kind: VirtualService metadata: name: demo spec: http: - headers: request: set: X-Forwarded-Proto: https match: - uri: prefix: / name: demo.default Â« åº”ç”¨å±‚çº§è®¾ç½®è®¿é—®ç™½åå•
Â» Istio 0-1 æµé‡ç®¡ç†æ–¹æ¡ˆ</description></item><item><title/><link>https://blog.poneding.com/istio/traffic-management/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/istio/traffic-management/</guid><description>ğŸ  é¦–é¡µ / Istio / Istio 0-1 æµé‡ç®¡ç†æ–¹æ¡ˆ
Istio 0-1 æµé‡ç®¡ç†æ–¹æ¡ˆ # è®¾ç½® istio-system å‘½åç©ºé—´ä¸‹ istiod Deployment çš„ç¯å¢ƒå˜é‡ï¼š
PILOT_ENABLE_VIRTUAL_SERVICE_DELEGATE =trueï¼š
Â« å®ç° Https åè®®çš„è½¬å‘</description></item><item><title/><link>https://blog.poneding.com/kubernetes/anti-affinity-improves-service-availability/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/anti-affinity-improves-service-availability/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / åäº²å’Œæ€§æé«˜æœåŠ¡å¯ç”¨æ€§
åäº²å’Œæ€§æé«˜æœåŠ¡å¯ç”¨æ€§ # åœ¨ Kubernetes ä¸­éƒ¨ç½²æœåŠ¡æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šéƒ¨ç½²å¤šå‰¯æœ¬æ¥æé«˜æœåŠ¡çš„å¯ç”¨æ€§ã€‚ä½†æ˜¯å½“è¿™äº›å‰¯æœ¬é›†ä¸­éƒ¨ç½²åœ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸”å¾ˆä¸å¹¸ï¼Œè¯¥èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œé‚£ä¹ˆæœåŠ¡å¾ˆå®¹æ˜“é™·å…¥ä¸å¯ç”¨çŠ¶æ€ã€‚
ä¸‹é¢ä»‹ç»ä¸€ç§æ–¹æ³•ï¼Œå°†æœåŠ¡å‰¯æœ¬åˆ†æ•£éƒ¨ç½²åœ¨ä¸åŒçš„èŠ‚ç‚¹ï¼ˆæŠŠé¸¡è›‹æ”¾åœ¨ä¸åŒçš„ç¯®å­é‡Œï¼‰ï¼Œé¿å…å•ä¸ªèŠ‚ç‚¹æ•…éšœå¯¼è‡´æœåŠ¡å¤šå‰¯æœ¬æ¯åï¼Œæé«˜æœåŠ¡å¯ç”¨æ€§ã€‚
åäº²å’Œ # apiVersion: apps/v1 kind: Deployment metadata: name: nginx labels: app: nginx spec: selector: matchLabels: app: nginx replicas: 5 template: metadata: labels: app: nginx spec: affinity: podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: podAffinityTerm: labelSelector: matchExpressions: - key: app operator: In values: - nginx topologyKey: kubernetes.io/hostname containers: - name: nginx image: nginx ports: - name: tcp containerPort: 80 ä½¿ç”¨ kubernetes.io/hostname ä½œä¸ºæ‹“æ‰‘åŸŸ,æŸ¥çœ‹åŒ¹é…è§„åˆ™ï¼Œå³åŒä¸€æ‰“æœ‰åŒæ ·æ ‡ç­¾ app=nginx çš„ pod ä¼šè°ƒåº¦åˆ°ä¸åŒçš„èŠ‚ç‚¹ã€‚</description></item><item><title/><link>https://blog.poneding.com/kubernetes/apiserver-builder/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/apiserver-builder/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / apiserver-builder
apiserver-builder # å®‰è£… # go install sigs.k8s.io/apiserver-builder-alpha/cmd/apiserver-boot@v1.23.0 æ­å»º # åˆå§‹åŒ–é¡¹ç›®ï¼š
âš ï¸ æ³¨æ„ï¼šç”±äºå†å²åŸå› éœ€è¦è¿›å…¥ $(go env GOPATH)/src/&amp;lt;package&amp;gt; åŒ…ç›®å½•ä¸‹æ‰§è¡Œåˆå§‹åŒ–å‘½ä»¤ã€‚
mkdir -p $(go env GOPATH)/src/github.com/poneding/apiserver-demo &amp;amp;&amp;amp; cd $(go env GOPATH)/src/github.com/poneding/apiserver-demo apiserver-boot init repo --domain k8sdev.poneding.com åˆ›å»º APIï¼š
# apiserver-boot create &amp;lt;group&amp;gt; &amp;lt;version&amp;gt; &amp;lt;resource&amp;gt; apiserver-boot create demo v1alpha1 User apiserver-boot create group version resource --group demo --version v1alpha1 --kind User å‚è€ƒ # https://github.com/kubernetes-sigs/apiserver-builder-alpha/blob/master/docs/tools_user_guide.md https://github.com/kubernetes-sigs/apiserver-builder-alpha/blob/master/README.md Â« åäº²å’Œæ€§æé«˜æœåŠ¡å¯ç”¨æ€§
Â» apiserver</description></item><item><title/><link>https://blog.poneding.com/kubernetes/apiserver/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/apiserver/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / apiserver
apiserver # æ¯ä¸€ä¸ª api ç‰ˆæœ¬å‡æœ‰ä¸€ä¸ª apiservice ä¸ä¹‹å¯¹åº”
k api-versions | wc -l 30 k get apiservices.apiregistration.k8s.io| wc -l 30 Â« apiserver-builder
Â» äºŒè¿›åˆ¶æ­å»º K8s - 1 æœºå™¨å‡†å¤‡</description></item><item><title/><link>https://blog.poneding.com/kubernetes/binary-build-k8s-01-prepare-nodes/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/binary-build-k8s-01-prepare-nodes/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / äºŒè¿›åˆ¶æ­å»º K8s - 1 æœºå™¨å‡†å¤‡
äºŒè¿›åˆ¶æ­å»º K8s - 1 æœºå™¨å‡†å¤‡ # å†™åœ¨å‰é¢ # è®°å½•å’Œåˆ†äº«ä½¿ç”¨äºŒè¿›åˆ¶æ­å»º K8s é›†ç¾¤çš„è¯¦ç»†è¿‡ç¨‹ï¼Œç”±äºæ“ä½œæ¯”è¾ƒå†—é•¿ï¼Œå¤§æ¦‚ä¼šåˆ†å››ç¯‡å†™å®Œï¼š
æœºå™¨å‡†å¤‡ï¼š éƒ¨ç½² etcd é›†ç¾¤ï¼š éƒ¨ç½² Masterï¼š éƒ¨ç½² Nodeï¼š æ•´ä¸ªç›®æ ‡æ˜¯ä½¿ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼æ­å»ºä¸€ä¸ªå°å‹ K8s é›†ç¾¤ï¼ˆ1 ä¸ª Masterï¼Œ2 ä¸ª Nodeï¼‰ï¼Œä¾›è‡ªå·±å­¦ä¹ æµ‹è¯•ã€‚
è‡³äºä¸ºä»€ä¹ˆè¦è‡ªå·±å»ç”¨äºŒè¿›åˆ¶çš„æ–¹å¼å»æ­å»º K8sï¼Œè€Œä¸æ˜¯é€‰ç”¨ minikube æˆ–è€… kubeadm å»æ­å»ºï¼Ÿ
å› ä¸ºä½¿ç”¨äºŒè¿›åˆ¶æ­å»ºï¼ŒK8s çš„æ¯ä¸ªç»„ä»¶ï¼Œæ¯ä¸ªå·¥å…·éƒ½éœ€è¦ä½ æ‰‹åŠ¨çš„å®‰è£…å’Œé…ç½®ï¼Œå¸®åŠ©ä½ åŠ æ·±å¯¹ K8s ç»„ç»‡æ¶æ„å’Œå·¥ä½œåŸç†çš„äº†è§£ã€‚
å‡†å¤‡å·¥ä½œ # ä¸‰å° centos7 è™šæ‹Ÿæœºï¼Œè‡ªå·±å­¦ä¹ ä½¿ç”¨çš„è¯ 1 æ ¸ 1G åº”è¯¥å°±å¤Ÿäº†ã€‚
è™šæ‹Ÿæœºèƒ½å¤Ÿè¿ç½‘ï¼Œç›¸å…³çš„å®‰è£…åŒ…æ–‡ä»¶ä¸‹è½½å’Œ Docker ä¸‹è½½é•œåƒéœ€è¦ä½¿ç”¨åˆ°å¤–ç½‘ã€‚
å½“å‰è™šæ‹Ÿæœºï¼š
k8s-master01: 192.168.115.131 k8s-node01: 192.168.115.132 k8s-node02: 192.168.115.133 è™šæ‹Ÿæœºåˆå§‹åŒ– # ä¸åšç‰¹æ®Šè¯´æ˜çš„è¯ï¼š
ä»¥ä¸‹æ“ä½œéœ€è¦åœ¨ Master å’Œ Node çš„æ‰€æœ‰æœºå™¨ä¸Šæ‰§è¡Œ</description></item><item><title/><link>https://blog.poneding.com/kubernetes/binary-build-k8s-02-deploy-etcd/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/binary-build-k8s-02-deploy-etcd/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / äºŒè¿›åˆ¶æ­å»º K8s - 2 éƒ¨ç½² etcd é›†ç¾¤
äºŒè¿›åˆ¶æ­å»º K8s - 2 éƒ¨ç½² etcd é›†ç¾¤ # å†™åœ¨å‰é¢ # è®°å½•å’Œåˆ†äº«ä½¿ç”¨äºŒè¿›åˆ¶æ­å»º K8s é›†ç¾¤çš„è¯¦ç»†è¿‡ç¨‹ï¼Œç”±äºæ“ä½œæ¯”è¾ƒå†—é•¿ï¼Œå¤§æ¦‚ä¼šåˆ†å››ç¯‡å†™å®Œï¼š
æœºå™¨å‡†å¤‡ï¼š éƒ¨ç½² etcd é›†ç¾¤ï¼š éƒ¨ç½² Masterï¼š éƒ¨ç½² Nodeï¼š etcd ä½œä¸º K8s çš„æ•°æ®åº“ï¼Œéœ€è¦é¦–å…ˆå®‰è£…ï¼Œä¸ºå…¶ä»–ç»„ä»¶åšæœåŠ¡åŸºç¡€ã€‚
etcd æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æ•°æ®åº“ç³»ç»Ÿï¼Œä¸ºäº†æ¨¡æ‹Ÿ etcd çš„é«˜å¯ç”¨ï¼Œæˆ‘ä»¬å°† etcd éƒ¨ç½²åœ¨ä¸‰å°è™šæ‹Ÿæœºä¸Šï¼Œæ­£å¥½å°±éƒ¨ç½²åœ¨ K8s é›†ç¾¤æ‰€ä½¿ç”¨çš„ä¸‰å°æœºå™¨ä¸Šå§ã€‚
etcd é›†ç¾¤ï¼ŒK8s ç»„ä»¶ä¹‹é—´é€šä¿¡ï¼Œä¸ºäº†å®‰å…¨å¯é ï¼Œæˆ‘ä»¬æœ€å¥½å¯ç”¨ HTTPS å®‰å…¨æœºåˆ¶ã€‚K8s æä¾›äº†åŸºäº CA ç­¾åçš„åŒå‘æ•°å­—è¯ä¹¦è®¤è¯æ–¹å¼å’Œç®€å•çš„åŸºäº HTTP Base æˆ– Token çš„è®¤è¯æ–¹å¼ï¼Œå…¶ä¸­ CA è¯ä¹¦æ–¹å¼çš„å®‰å…¨æ€§æœ€é«˜ã€‚æˆ‘ä»¬ä½¿ç”¨ cfssl ä¸ºæˆ‘ä»¬çš„ K8s é›†ç¾¤é…ç½® CA è¯ä¹¦ï¼Œæ­¤å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨ opensslã€‚
å®‰è£… cfssl # åœ¨ Master æœºå™¨æ‰§è¡Œï¼š</description></item><item><title/><link>https://blog.poneding.com/kubernetes/binary-build-k8s-03-deploy-master/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/binary-build-k8s-03-deploy-master/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / äºŒè¿›åˆ¶æ­å»º K8s - 3 éƒ¨ç½² Master
äºŒè¿›åˆ¶æ­å»º K8s - 3 éƒ¨ç½² Master # å†™åœ¨å‰é¢ # è®°å½•å’Œåˆ†äº«ä½¿ç”¨äºŒè¿›åˆ¶æ­å»º K8s é›†ç¾¤çš„è¯¦ç»†è¿‡ç¨‹ï¼Œç”±äºæ“ä½œæ¯”è¾ƒå†—é•¿ï¼Œå¤§æ¦‚ä¼šåˆ†å››ç¯‡å†™å®Œï¼š
æœºå™¨å‡†å¤‡ï¼š éƒ¨ç½² etcd é›†ç¾¤ï¼š éƒ¨ç½² Masterï¼š éƒ¨ç½² Nodeï¼š æˆ‘ä»¬å·²ç»çŸ¥é“åœ¨ K8s çš„ Master ä¸Šå­˜åœ¨ç€ kube-apiserverã€kube-controller-managerã€kube-scheduler ä¸‰å¤§ç»„ä»¶ã€‚æœ¬ç¯‡ä»‹ç»åœ¨ Master æœºå™¨å®‰è£…è¿™äº›ç»„ä»¶ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœæƒ³åœ¨ Master æœºå™¨ä¸Šæ“ä½œé›†ç¾¤ï¼Œè¿˜éœ€è¦å®‰è£… kubectl å·¥å…·ã€‚
å®‰è£… kubectl # kubernetes çš„å®‰è£…åŒ…é‡Œå·²ç»å°† kubectl åŒ…å«è¿›å»äº†ï¼Œéƒ¨ç½²å¾ˆç®€å•ï¼š
cd /root/kubernetes/resources/ tar -zxvf ./kubernetes-server-linux-amd64.tar.gz cp kubernetes/server/bin/kubectl /usr/bin kubectl api-versions åˆ¶ä½œ kubernetes è¯ä¹¦ # mkdir /root/kubernetes/resources/cert/kubernetes /etc/kubernetes/{ssl,bin} -p cp kubernetes/server/bin/kube-apiserver kubernetes/server/bin/kube-controller-manager kubernetes/server/bin/kube-scheduler /etc/kubernetes/bin cd /root/kubernetes/resources/cert/kubernetes æ¥ä¸‹æ¥éƒ½åœ¨ Master æœºå™¨ä¸Šæ‰§è¡Œï¼Œç¼–è¾‘ ca-config.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/binary-build-k8s-04-deploy-worker/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/binary-build-k8s-04-deploy-worker/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / äºŒè¿›åˆ¶æ­å»º K8s - 4 éƒ¨ç½² Node
äºŒè¿›åˆ¶æ­å»º K8s - 4 éƒ¨ç½² Node # å†™åœ¨å‰é¢ # è®°å½•å’Œåˆ†äº«ä½¿ç”¨äºŒè¿›åˆ¶æ­å»º K8s é›†ç¾¤çš„è¯¦ç»†è¿‡ç¨‹ï¼Œç”±äºæ“ä½œæ¯”è¾ƒå†—é•¿ï¼Œå¤§æ¦‚ä¼šåˆ†å››ç¯‡å†™å®Œï¼š
æœºå™¨å‡†å¤‡ï¼š éƒ¨ç½² etcd é›†ç¾¤ï¼š éƒ¨ç½² Masterï¼š éƒ¨ç½² Nodeï¼š K8s çš„ Node ä¸Šéœ€è¦è¿è¡Œ kubelet å’Œ kube-proxyã€‚æœ¬ç¯‡ä»‹ç»åœ¨ Node æœºå™¨å®‰è£…è¿™ä¸¤ä¸ªç»„ä»¶ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå®‰è£…é€šä¿¡éœ€è¦çš„ cni æ’ä»¶ã€‚
æœ¬ç¯‡çš„æ‰§è¡Œå‘½ä»¤éœ€è¦åœ¨å‡†å¤‡çš„ä¸¤å°Nodeæœºå™¨ä¸Šæ‰§è¡Œã€‚
å®‰è£… docker # å¯ä»¥å‚ç…§å®˜ç½‘ï¼š https://docs.docker.com/engine/install/
# å¸è½½è€ç‰ˆæœ¬æˆ–é‡è£… docker æ—¶æ‰§è¡Œç¬¬ä¸€è¡Œ yum remove docker \ docker-client \ docker-client-latest \ docker-common \ docker-latest \ docker-latest-logrotate \ docker-logrotate \ docker-engine -y # å®‰è£… docker yum install -y yum-utils yum-config-manager \ --add-repo \ https://download.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/cloud-native-understood/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/cloud-native-understood/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 å°è¯•ç†è§£äº‘åŸç”Ÿ
Kubernetes 0-1 å°è¯•ç†è§£äº‘åŸç”Ÿ # æœ€åˆçš„äº‘åŸç”Ÿå®šä¹‰ï¼š
åº”ç”¨å®¹å™¨åŒ– é¢å‘å¾®æœåŠ¡æ¶æ„ åº”ç”¨æ”¯æŒå®¹å™¨ç¼–æ’è°ƒåº¦ é‡æ–°å®šä¹‰äº‘åŸç”Ÿï¼š
äº‘åŸç”ŸæŠ€æœ¯æœ‰åˆ©äºå„ç»„ç»‡åœ¨å…¬æœ‰äº‘ã€ç§æœ‰äº‘å’Œæ··åˆäº‘ç­‰æ–°å‹åŠ¨æ€ç¯å¢ƒä¸­ï¼Œæ„å»ºå’Œè¿è¡Œå¯å¼¹æ€§æ‰©å±•çš„åº”ç”¨ã€‚äº‘åŸç”Ÿçš„ä»£è¡¨æŠ€æœ¯åŒ…æ‹¬å®¹å™¨ã€æœåŠ¡ç½‘æ ¼ã€å¾®æœåŠ¡ã€ä¸å¯å˜åŸºç¡€è®¾æ–½å’Œå£°æ˜å¼APIã€‚
è¿™äº›æŠ€æœ¯èƒ½å¤Ÿæ„å»ºå®¹é”™æ€§å¥½ã€æ˜“äºç®¡ç†å’Œä¾¿äºè§‚å¯Ÿçš„æ¾è€¦åˆç³»ç»Ÿã€‚ç»“åˆå¯é çš„è‡ªåŠ¨åŒ–æ‰‹æ®µï¼Œäº‘åŸç”ŸæŠ€æœ¯ä½¿å·¥ç¨‹å¸ˆèƒ½å¤Ÿè½»æ¾åœ°å¯¹ç³»ç»Ÿä½œå‡ºé¢‘ç¹å’Œå¯é¢„æµ‹çš„é‡å¤§å˜æ›´ã€‚
äº‘åŸç”Ÿæœ¬èº«ä¸èƒ½ç§°ä¸ºæ˜¯ä¸€ç§æ¶æ„ï¼Œå®ƒé¦–å…ˆæ˜¯ä¸€ç§åŸºç¡€è®¾æ–½ï¼Œè¿è¡Œåœ¨å…¶ä¸Šçš„åº”ç”¨ç§°ä½œäº‘åŸç”Ÿåº”ç”¨ï¼Œåªæœ‰ç¬¦åˆäº‘åŸç”Ÿè®¾è®¡å“²å­¦çš„åº”ç”¨æ¶æ„æ‰å«äº‘åŸç”Ÿåº”ç”¨æ¶æ„ã€‚
Â« äºŒè¿›åˆ¶æ­å»º K8s - 4 éƒ¨ç½² Node
Â» é›†ç¾¤è”é‚¦</description></item><item><title/><link>https://blog.poneding.com/kubernetes/cluster-federation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/cluster-federation/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / é›†ç¾¤è”é‚¦
é›†ç¾¤è”é‚¦ # äº‘æœåŠ¡æä¾›å•†çš„é›†ç¾¤è”é‚¦æ˜¯ä¸€ç§å°†å¤šä¸ªç‹¬ç«‹çš„ Kubernetes é›†ç¾¤ç»„åˆåœ¨ä¸€èµ·çš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•å…è®¸ç”¨æˆ·åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´å…±äº«èµ„æºï¼Œä¾‹å¦‚ Podsã€Servicesã€Deployments ç­‰ã€‚é›†ç¾¤è”é‚¦çš„ç›®æ ‡æ˜¯åœ¨å¤šä¸ªé›†ç¾¤ä¸Šå¼•å…¥æ–°çš„æ§åˆ¶é¢æ¿ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„è§†å›¾ï¼Œä½¿ç”¨æˆ·å¯ä»¥åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´æ— ç¼åœ°éƒ¨ç½²å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚
æ¦‚å¿µ # æ•°æ®ä¸­å¿ƒï¼šRegionï¼Œæ˜¯ä¸€ä¸ªç‰©ç†ä½ç½®ï¼ŒåŒ…å«å¤šä¸ªå¯ç”¨æ€§åŒºåŸŸã€‚ å¯ç”¨æ€§åŒºåŸŸï¼šAvailability Zoneï¼ˆAZï¼‰ï¼Œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®ä¸­å¿ƒï¼ŒåŒ…å« N å¤šæœåŠ¡å™¨èŠ‚ç‚¹ã€‚ ç®¡ç†é›†ç¾¤ï¼šæˆ–è€…å®¿ä¸»é›†ç¾¤ï¼Œæ˜¯ä¸€ä¸ªé›†ç¾¤è”é‚¦çš„æ ¸å¿ƒï¼Œç”¨äºç®¡ç†å¤šä¸ªå·¥ä½œé›†ç¾¤ã€‚ è”é‚¦é›†ç¾¤ï¼šæˆ–è€…å·¥ä½œé›†ç¾¤ï¼Œæ˜¯ä¸€ä¸ªæ™®é€šçš„ Kubernetes é›†ç¾¤ï¼Œç”¨äºéƒ¨ç½²å·¥ä½œè´Ÿè½½ã€‚ é›†ç¾¤è”é‚¦éœ€è¦è§£å†³çš„é—®é¢˜ # è·¨é›†ç¾¤æœåŠ¡å‘ç°ï¼šè¿é€šå¤šä¸ªé›†ç¾¤ï¼Œä½¿å¾—æœåŠ¡å¯ä»¥åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´å‘ç°ï¼Œè®©è¯·æ±‚è·¨è¶Šé›†ç¾¤è¾¹ç•Œã€‚ è·¨é›†ç¾¤è°ƒåº¦ï¼šå°†è´Ÿè½½è°ƒåº¦åˆ°å¤šä¸ªé›†ç¾¤ï¼Œä¿è¯æœåŠ¡çš„ç¨³å®šæ€§ä»¥åŠå¯ç”¨æ€§ã€‚ é›†ç¾¤è”é‚¦å¼€æºé¡¹ç›® # Kubefed # é¡¹ç›®åœ°å€
ä¹‹å‰ç”± Kubernetes å®˜æ–¹å¤šé›†ç¾¤å…´è¶£å°ç»„å¼€å‘ï¼Œç›®å‰å·²ç»åœæ­¢ç»´æŠ¤ã€‚
æ¶æ„åŸç†ï¼š
å°†è”é‚¦èµ„æºï¼ˆFederationResourceï¼‰ä»ç®¡ç†é›†ç¾¤åŒæ­¥åˆ°å·¥ä½œé›†ç¾¤ã€‚
è¿™å…¶ä¸­é€šè¿‡ä¸‰ä¸ªæ¦‚å¿µæ¥å®ç°ï¼š
Templateï¼šå®šä¹‰äº†è”é‚¦èµ„æºçš„æ¨¡æ¿ï¼Œç”¨äºæŒ‡å®šè”é‚¦èµ„æºçš„å±æ€§ Placementï¼šå®šä¹‰äº†è”é‚¦é›†ç¾¤èµ„æºçš„éƒ¨ç½²ä½ç½®ï¼Œç”¨äºæŒ‡å®šè”é‚¦èµ„æºçš„éƒ¨ç½²ä½ç½®ã€‚ Overridesï¼šå®šä¹‰äº†è”é‚¦é›†ç¾¤èµ„æºçš„è¦†ç›–è§„åˆ™ï¼Œç”¨äºè¦†ç›–è”é‚¦èµ„æºçš„å±æ€§ã€‚ kubefed ä¸ºæ‰€æœ‰çš„ Kubernetes åŸç”Ÿèµ„æºæä¾›äº†å¯¹åº”çš„è”é‚¦èµ„æºï¼Œä¾‹å¦‚ FederatedServiceã€FederatedDeployment ç­‰ã€‚
è”é‚¦èµ„æºä¸­å®šä¹‰äº†åŸç”Ÿèµ„æºçš„ Templateã€åˆé€šè¿‡ Overrides å®šä¹‰äº†èµ„æºåŒæ­¥åˆ°ä¸åŒçš„å·¥ä½œé›†ç¾¤æ—¶éœ€è¦åšçš„å˜æ›´ï¼Œä¾‹å¦‚ï¼š
kind: FederatedDeployment ... spec: ... overrides: # Apply overrides to cluster1 - clusterName: cluster1 clusterOverrides: # Set the replicas field to 5 - path: &amp;#34;/spec/replicas&amp;#34; value: 5 # Set the image of the first container - path: &amp;#34;/spec/template/spec/containers/0/image&amp;#34; value: &amp;#34;nginx:1.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/configmap-understood/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/configmap-understood/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / äº†è§£ ConfigMap
äº†è§£ ConfigMap # å‡ ä¹æ‰€æœ‰çš„åº”ç”¨éƒ½éœ€è¦é…ç½®ä¿¡æ¯ï¼Œåœ¨ K8s éƒ¨ç½²åº”ç”¨ï¼Œæœ€ä½³å®è·µæ˜¯å°†åº”ç”¨çš„é…ç½®ä¿¡æ¯ï¼ˆç¯å¢ƒå˜é‡æˆ–è€…é…ç½®æ–‡ä»¶ï¼‰å’Œç¨‹åºæœ¬èº«åˆ†ç¦»ï¼Œè¿™æ ·é…ç½®ä¿¡æ¯çš„æ›´æ–°å’Œå¤ç”¨éƒ½å¯ä»¥æ›´ç®€å•ï¼Œä¹Ÿä½¿å¾—ç¨‹åºæ›´åŠ çµæ´»ã€‚
Kubernetes å…è®¸å°†é…ç½®é€‰é¡¹åˆ†ç¦»åˆ°å•ç‹¬çš„èµ„æºå¯¹è±¡ ConfigMap ä¸­ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé”®å€¼å¯¹æ˜ å°„ï¼Œå€¼å¯ä»¥æ˜¯ä¸€ä¸ªçŸ­ string ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„é…ç½®æ–‡ä»¶ã€‚
æœ¬ç¯‡ä¸»è¦ä»‹ç» ConfigMap èµ„æºçš„åˆ›å»ºå’Œä½¿ç”¨ã€‚
ConfigMap çš„åˆ›å»º # å¯ä»¥ç›´æ¥é€šè¿‡ kubectl create configmap å‘½ä»¤åˆ›å»ºï¼Œä¹Ÿå¯ä»¥å…ˆç¼–å†™ configmap çš„ yaml æ–‡ä»¶å†ä½¿ç”¨kubectl apply -f &amp;lt;filename&amp;gt;åˆ›å»ºï¼Œæ¨èä½¿ç”¨åè€…ã€‚
å•è¡Œå‘½ä»¤åˆ›å»º ConfigMap # åˆ›å»ºä¸€ä¸ªé”®å€¼å¯¹çš„ ConfigMapï¼š kubectl create configmap first-config --from-literal=user=admin åˆ›å»ºå®Œæˆä¹‹åï¼Œä½¿ç”¨ kubectl describe configmap first-config æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ª configmap çš„é”®å€¼å†…å®¹ã€‚
å¯ä»¥ä½¿ç”¨å¤šç»„ --from-literal=&amp;lt;key&amp;gt;=&amp;lt;value&amp;gt; å‚æ•°ï¼Œåœ¨ configmap ä¸­å®šä¹‰å¤šç»„é”®å€¼å¯¹ã€‚
åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å†…å®¹çš„ ConfigMap å‡å¦‚æˆ‘å½“å‰æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ app.jsonï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š
{ &amp;#34;App&amp;#34;: &amp;#34;MyApp&amp;#34;, &amp;#34;Version&amp;#34;: &amp;#34;v1.0&amp;#34; } ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»º ConfigMapï¼š</description></item><item><title/><link>https://blog.poneding.com/kubernetes/delete-es-log-index-scheduler/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/delete-es-log-index-scheduler/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / å®šæœŸåˆ é™¤ ElasticSearch æ—¥å¿—ç´¢å¼•
å®šæœŸåˆ é™¤ ElasticSearch æ—¥å¿—ç´¢å¼• # èƒŒæ™¯ # å½“å‰åœ¨ K8s é›†ç¾¤ä¸­éƒ¨ç½²äº†ä¸€å¥— EFK æ—¥å¿—ç›‘æ§ç³»ç»Ÿï¼Œæ—¥å¤ä¸€æ—¥ï¼ŒElasticSearchæ”¶é›†çš„æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œå†…å­˜ä»¥åŠå­˜å‚¨å ç”¨è¶Šæ¥è¶Šé«˜ï¼Œéœ€è¦å®šæœŸæ¥åˆ é™¤è€æ—§çš„æ—¥å¿—æ•°æ®ï¼Œæ¥è§£æ”¾å†…å­˜å’Œå­˜å‚¨ç©ºé—´ï¼Œè€ƒè™‘åˆ° K8s ä¸­ cronjob çš„åŠŸèƒ½ç‰¹æ€§ï¼Œæ‰“ç®—ä½¿ç”¨å®ƒåˆ¶å®šä¸€ä¸ªesæ—¥å¿—ç´¢å¼•æ¸…é™¤è„šæœ¬ï¼Œå®šæ—¶æ¸…é™¤æ—¥å¿—æ•°æ®ã€‚
ConfigMap # è¿™ä¸ªconfigMapç”¨æ¥å­˜å‚¨ä¸€ä¸ªshellè„šæœ¬ï¼Œè¯¥shellè„šæœ¬æ‰§è¡Œæ—¥å¿—ç´¢å¼•æ¸…é™¤æ“ä½œï¼š
apiVersion: v1 kind: ConfigMap metadata: name: es-log-indices-clear-configmap namespace: efk data: clean-indices.sh: | #/bin/bash LAST_MONTH_DATE=`date -d &amp;#34;1 month ago&amp;#34; +&amp;#34;%Y.%m.%d&amp;#34;` echo Start clear es indices *-${LAST_MONTH_DATE} curl -XDELETE http://elasticsearch:9200/*-${LAST_MONTH_DATE} --- è¯´æ˜ï¼šè¿™é‡Œæˆ‘é…ç½®çš„configmapæ‰€åœ¨å‘½åç©ºé—´å’Œefkéƒ¨ç½²çš„å‘½åç©ºé—´ä¸€è‡´ï¼Œå¹¶ä¸”esçš„Serviceçš„åç§°æ˜¯elasticsearchï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ http://elasticsearch:9200è®¿é—®åˆ°esæœåŠ¡ï¼Œå¦åˆ™çš„è¯éœ€è¦æ˜¯æ— æ³•è®¿é—®åˆ°çš„ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µé…ç½®esçš„æœåŠ¡åœ°å€ï¼›
CronJob # CronJobä½¿ç”¨äº† poneding/sparrow
apiVersion: batch/v1beta1 kind: CronJob metadata: name: clean-indices namespace: efk spec: schedule: &amp;#34;0 0 1/1 * *&amp;#34; jobTemplate: spec: template: spec: containers: - name: auto-recycle-job image: poneding/sparrow args: [&amp;#34;/bin/sh&amp;#34;, &amp;#34;/job/clean-indices.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/delete-k8s-resource-force/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/delete-k8s-resource-force/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / å¼ºåˆ¶åˆ é™¤ K8s èµ„æº
å¼ºåˆ¶åˆ é™¤ K8s èµ„æº # å¼ºåˆ¶åˆ é™¤ Pod # kubectl delete po &amp;lt;pod&amp;gt; -n &amp;lt;namespace&amp;gt; --force --grace-period=0 å¼ºåˆ¶åˆ é™¤ PVC # kubectl patch pv &amp;lt;pv&amp;gt; -n &amp;lt;namespace&amp;gt; -p &amp;#39;{&amp;#34;metadata&amp;#34;:{&amp;#34;finalizers&amp;#34;:null}}&amp;#39; å¼ºåˆ¶åˆ é™¤ PV # kubectl patch pvc &amp;lt;pvc&amp;gt; -n &amp;lt;namespace&amp;gt; -p &amp;#39;{&amp;#34;metadata&amp;#34;:{&amp;#34;finalizers&amp;#34;:null}}&amp;#39; å¼ºåˆ¶åˆ é™¤å‘½åç©ºé—´ # åœ¨åˆ é™¤ kubesphere çš„å‘½åç©ºé—´æ—¶é‡åˆ°æ— æ³•åˆ é™¤æˆåŠŸçš„ç°è±¡ï¼Œå‘½åç©ºé—´ä¸€ç›´å¤„äº Terminating çŠ¶æ€ã€‚
$ kubectl get ns |grep kubesphere NAME STATUS AGE kubesphere-controls-system Terminating 22d kubesphere-monitoring-system Terminating 21d åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚
é¦–å…ˆè·å–å‘½åç©ºé—´çš„ json æ–‡ä»¶ï¼Œ</description></item><item><title/><link>https://blog.poneding.com/kubernetes/gateway-api-practice/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/gateway-api-practice/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Gateway API å®è·µ
Gateway API å®è·µ # Gateway API è¿˜åœ¨ç§¯æå¼€å‘ä¸­ï¼Œç›®å‰å·²ç»å‘å¸ƒäº† v1.0.0 ç‰ˆæœ¬ã€‚å¯ä»¥é€šè¿‡ gateway-api æ–‡æ¡£ è·å–æœ€æ–°è¿›å±•ã€‚
Gateway API æ¦‚è¿° # Gateway API æ˜¯ä¸€ä¸ª Kubernetes çš„æ‰©å±• APIï¼Œå®ƒå®šä¹‰äº†ä¸€å¥— API æ¥ç®¡ç†ç½‘å…³ã€è·¯ç”±ã€TLS ç­‰èµ„æºå¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥æ›¿ä»£ä¼ ç»Ÿçš„ Ingressã€‚
å’Œ Ingress ä¸€æ ·ï¼ŒGateway API ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå®ƒå®šä¹‰äº†ä¸€å¥— API æ¥å£ï¼Œè¿™äº›æ¥å£ç”±ç¤¾åŒºä¸­çš„ä¸åŒå‚å•†æ¥å®ç°ï¼Œæ¯”å¦‚ nginxã€envoyã€traefik ç­‰ã€‚
API æ¸…å• # GatewayClass Gateway HTTPRoute GRPCRoute BackendTLSPolicy ReferenceGrant å®‰è£… Gateway API # # å®‰è£…æœ€æ–°ç‰ˆ gateway-api CRDs export LATEST=$(curl -s https://api.github.com/repos/kubernetes-sigs/gateway-api/releases/latest | jq -r .tag_name) kubectl apply -f https://github.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/helm-k8s-package-management-tool/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/helm-k8s-package-management-tool/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 Helm Kubernetes çš„åŒ…ç®¡ç†å·¥å…·
Kubernetes 0-1 Helm Kubernetes çš„åŒ…ç®¡ç†å·¥å…· # Helm is the best way to find, share, and use software built for Kubernetes.
Helmæ˜¯ä¸ºKuberneteså¯»æ‰¾ï¼Œå…±äº«å’Œä½¿ç”¨è½¯ä»¶æ„å»ºçš„æœ€ä½³æ–¹å¼ã€‚
ç®€ä»‹ # Helmå¸®åŠ©ç®¡ç†Kubernetesåº”ç”¨ç¨‹åºï¼Œå³ä½¿æ˜¯é¢å¯¹å¤æ‚çš„K8så¼•ç”¨ï¼ŒHelm Chartsä¹Ÿå¯ä»¥è½»æ¾å®ç°å®šä¹‰ï¼Œå®‰è£…å’Œå‡çº§ã€‚
Helmæ˜¯CNCFçš„æ¯•ä¸šé¡¹ç›®ï¼Œç”±Helmç¤¾åŒºç»´æŠ¤ã€‚
Chartsï¼š
Chartså¯ä»¥çœ‹ä½œæ˜¯Helmçš„ç¨‹åºåŒ…ï¼Œä¸€ä¸ªChartæ˜¯æè¿°Kubernetesèµ„æºé›†çš„æ–‡ä»¶é›†åˆã€‚
Repositoryï¼š
å­˜å‚¨å’Œå…±äº«Chartsï¼Œå¯ä»¥çœ‹ä½œæ˜¯Kubernetesç¨‹åºåŒ…çš„å­˜å‚¨ä¸­å¿ƒã€‚
Releaseï¼š
ç”±ä¸€ä¸ªChartè¿è¡Œèµ·æ¥çš„å®ä¾‹ï¼Œè¿™å°†åœ¨kubernetesé›†ç¾¤ä¸­ç”Ÿæˆæˆ–æ›´æ–°ä¸€ç»„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªchartè¿è¡Œæˆå¤šä¸ªreleaseã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³è¿è¡Œå¤šä¸ªredisæœåŠ¡ï¼Œä½ å¯ä»¥é€šè¿‡å¤šæ¬¡å®‰è£…redisçš„chartå¾—åˆ°ã€‚
çœ‹åˆ°ä»¥ä¸Šä¸‰ä¸ªæ¦‚å¿µï¼Œä½ å¯èƒ½ä¼šè§‰å¾—ä¼¼æ›¾ç›¸è¯†ï¼Œæ²¡é”™ï¼Œä¸dockerä¸‰ä¸ªæ¦‚å¿µâ€”â€”imageï¼Œregistryï¼Œcontainerå¦‚å‡ºä¸€è¾™ï¼Œä¹Ÿè®¸ç°åœ¨ä½ ä¼šåŠ æ·±ç‚¹ç†è§£äº†ã€‚
å®‰è£… # å¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨è„šæœ¬å®‰è£…
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 chmod 700 ./get-helm.sh ./get-helm.sh ä¹Ÿå¯ä»¥ä¸‹è½½æŒ‡å®šç‰ˆæœ¬æ‰‹åŠ¨å®‰è£…
ä¸‹è½½åœ°å€ï¼š https://github.com/helm/helm/releases
wget https://get.helm.sh/helm-v3.5.2-linux-amd64.tar.gz tar -zxvf ./helm-v3.5.2-linux-amd64.tar.gz sudo mv linux-amd64/helm /usr/local/bin/helm ç¬¬ä¸€ä¸ªhelmå‘½ä»¤
helm help æ›´å¤šå®‰è£…æ–¹å¼å¯æŸ¥çœ‹ï¼š https://helm.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/hpa-usage/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/hpa-usage/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 å®ç°Podè‡ªåŠ¨æ‰©ç¼©HPA
Kubernetes 0-1 å®ç°Podè‡ªåŠ¨æ‰©ç¼©HPA # https://blog.51cto.com/14143894/2458468?source=dra
å‰è¨€ # åœ¨K8sé›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡éƒ¨ç½²Metrics Serveræ¥æŒç»­æ”¶é›†Podçš„èµ„æºåˆ©ç”¨æŒ‡æ ‡æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®æ”¶é›†åˆ°çš„æŒ‡æ ‡æ•°æ®æ¥è¯„ä¼°æ˜¯å¦éœ€è¦è°ƒæ•´Podçš„æ•°é‡ä»¥è´´åˆå®ƒçš„ä½¿ç”¨éœ€æ±‚ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬è§‚å¯Ÿåˆ°Podçš„CPUåˆ©ç”¨ç‡è¿‡é«˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€‚å½“ä¸Šè°ƒDeploymentçš„Replicaså­—æ®µå€¼ï¼Œæ¥æ‰‹åŠ¨å®ç°Podçš„æ¨ªå‘æ‰©å®¹ã€‚
Metrics Serverçš„æŒ‡æ ‡æ•°æ®å¯ä»¥é€šè¿‡DashboardæŸ¥çœ‹åˆ°ï¼› å®‰è£…Metrics Server # HPAä»‹ç» # HPAï¼ˆHorizontal Pod Autoscalerï¼ŒPodæ°´å¹³è‡ªåŠ¨æ‰©ç¼©ï¼‰ï¼Œæ ¹æ®Podçš„èµ„æºåˆ©ç”¨ç‡è‡ªåŠ¨è°ƒæ•´Podç®¡ç†å™¨ä¸­å‰¯æœ¬æ•°ï¼šPodèµ„æºåˆ©ç”¨ç‡ä½ï¼Œé™ä½Podå‰¯æœ¬æ•°ï¼Œé™ä½èµ„æºçš„ä½¿ç”¨ï¼ŒèŠ‚çº¦æˆæœ¬ï¼›Podèµ„æºåˆ©ç”¨ç‡é«˜ï¼Œå¢åŠ Podå‰¯æœ¬æ•°ï¼Œæé«˜åº”ç”¨çš„è´Ÿè½½èƒ½åŠ›ã€‚
ç¤ºä¾‹ # ä»¥éƒ¨ç½²redisä¸ºä¾‹ï¼Œç°ä½¿ç”¨redis
Â« Kubernetes 0-1 Helm Kubernetes çš„åŒ…ç®¡ç†å·¥å…·
Â» HTTP å®¢æˆ·ç«¯è°ƒç”¨ Kubernetes APIServer</description></item><item><title/><link>https://blog.poneding.com/kubernetes/http-call-k8s-apiserver/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/http-call-k8s-apiserver/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / HTTP å®¢æˆ·ç«¯è°ƒç”¨ Kubernetes APIServer
HTTP å®¢æˆ·ç«¯è°ƒç”¨ Kubernetes APIServer # æœ¬ç¯‡ä»‹ç»å‡ ç§å¦‚ä½•é€šè¿‡ HTTP å®¢æˆ·ç«¯è°ƒç”¨ Kubernetes APIServer çš„å§¿åŠ¿ã€‚
å¦‚ä½•è·å– Kubernetes api-server åœ°å€ # æŸ¥çœ‹ api-server çš„å‡ ç§æ–¹å¼ï¼š
# 1. ç›´æ¥æŸ¥çœ‹ kubeconfig æ–‡ä»¶ $ cat ~/.kube/config apiVersion: v1 clusters: - cluster: server: https://192.168.58.2:8443 ... # 2. kubectl æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯ $ kubectl cluster-info Kubernetes control plane is running at https://192.168.58.2:8443 ... # 3. kubectl æŸ¥çœ‹é›†ç¾¤é…ç½® $ kubectl config view clusters: - cluster: .</description></item><item><title/><link>https://blog.poneding.com/kubernetes/informer/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/informer/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Informer
Informer # Informeræ˜¯client-goä¸­å®ç°çš„ä¸€ä¸ªå·¥å…·åŒ…ï¼Œç›®å‰å·²ç»è¢«kubernetesä¸­å„ä¸ªç»„ä»¶æ‰€ä½¿ç”¨ï¼Œä¾‹å¦‚controller-managerã€‚Informeræœ¬è´¨æ˜¯ä¸€ä¸ªapièµ„æºçš„ç¼“å­˜ã€‚
ä¸»è¦åŠŸèƒ½ï¼š
å°†etcdæ•°æ®åŒæ­¥è‡³æœ¬åœ°ç¼“å­˜ï¼Œå®¢æˆ·ç«¯é€šè¿‡æœ¬åœ°ç¼“å­˜è¯»å–å’Œç›‘å¬èµ„æº
æ³¨å†Œèµ„æºAddï¼ŒUpdateï¼ŒDeleteçš„è§¦å‘äº‹ä»¶
ç›®çš„ï¼š
æœ¬åœ°ç¼“å­˜ï¼Œé¿å…ç»„ä»¶ç›´æ¥ä¸api-serveräº¤äº’ï¼Œå‡ç¼“å¯¹api-serveråŠetcdçš„è®¿é—®å‹åŠ›ã€‚
ç»„ä»¶ # Reflector
Delta FIFO Queue
Indexerï¼ˆlocal strorageï¼‰
ä¸‹é¢ç»“åˆæµç¨‹ç¤ºæ„å›¾ç®€å•ä»‹ç»è¿™äº›ç»„ä»¶çš„è§’è‰²ã€‚
æµç¨‹ç¤ºæ„å›¾ # è¿™å¼ ç¤ºæ„å›¾å±•ç¤ºäº†client-goç±»åº“ä¸­å„ä¸ªç»„ä»¶çš„å·¥ä½œæœºåˆ¶ï¼Œä»¥åŠå®ƒä»¬ä¸å’±ä»¬å°†è¦ç¼–å†™çš„è‡ªå®šä¹‰æ§åˆ¶å™¨çš„äº¤äº’ç‚¹ï¼ˆé»„é¢œè‰²æ ‡æ³¨çš„å—æ˜¯éœ€è¦è‡ªè¡Œå¼€å‘çš„éƒ¨åˆ†ï¼‰ã€‚
Reflectorï¼š
è´Ÿè´£ç›‘å¬ï¼ˆWatchï¼‰ç‰¹å®šKubernetesèµ„æºå¯¹è±¡ï¼Œç›‘å¬çš„èµ„æºå¯¹è±¡å¯ä»¥æ˜¯å†…ç½®çš„èµ„æºä¾‹å¦‚Podï¼ŒIngressç­‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å®šåˆ¶çš„CRå¯¹è±¡ã€‚
Reflettorä¸ApiServerå»ºç«‹è¿æ¥ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨List&amp;amp;Watchæœºåˆ¶ä»ApiServerä¸­Listç‰¹å®šèµ„æºçš„æ‰€æœ‰å®ä¾‹ï¼Œè¿™äº›å®ä¾‹é™„å¸¦çš„ResourceVersionå­—æ®µå¯ä»¥ç”¨æ¥åŒºåˆ†å®ä¾‹æ˜¯å¦æ›´æ–°ã€‚åç»­åœ¨ä½¿ç”¨List&amp;amp;Watchæœºåˆ¶ä»ApiServerä¸­Watchç‰¹å®šèµ„æºçš„æ–°å¢ï¼Œæ›´æ–°ï¼Œåˆ é™¤ç­‰å˜åŒ–ï¼ˆå¢é‡Deltaï¼‰ã€‚
å°†ç›‘å¬åˆ°çš„èµ„æºçš„æ–°å¢ï¼Œæ›´æ–°ï¼Œåˆ é™¤é¡ºåºå†™å…¥åˆ°DeltaFIFOé˜Ÿåˆ—ä¸­ã€‚
DeltaFIFOï¼š
ä¸€ä¸ªå¢é‡çš„å…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—ï¼Œå­˜å‚¨ç›‘å¬åˆ°çš„èµ„æºï¼Œä»¥åŠèµ„æºäº‹ä»¶ç±»å‹ï¼Œä¾‹å¦‚Addedï¼ŒUpdatedï¼ŒDeletedï¼ŒReplacedï¼ŒSyncã€‚
Informerï¼š
Indexerï¼š
ä¸€ä¸ªè‡ªå¸¦ç´¢å¼•åŠŸèƒ½çš„æœ¬åœ°å­˜å‚¨ï¼Œç”¨äºå­˜å‚¨èµ„æºå¯¹è±¡ã€‚Informerä»DeltaFIFOä¸­Popå‡ºèµ„æºï¼Œå­˜å‚¨åˆ°Indexerã€‚Indexerä¸­èµ„æºä¸k8s etcdæ•°æ®ä¿æŒä¸€è‡´ã€‚æœ¬åœ°è¯»å–æ—¶ç›´æ¥æŸ¥è¯¢æœ¬åœ°å­˜å‚¨ï¼Œä»è€Œå‡å°‘k8s apiserverå’Œetcdçš„å‹åŠ›ã€‚
ä½¿ç”¨ç¤ºä¾‹ # è‡ªå®šä¹‰æ§åˆ¶å™¨
clientset, err := kubernetes.NewForConfig(config) stopCh := make(chan struct{}) defer close(stopch) sharedInformers := informers.NewSharedInformerFactory(clientset, time.Minute) informer := sharedInformer.Core().V1().Pods().Informer() informer.AddEventHandler(cache.ResourceEventHandlerFuncs{ AddFunc: func(obj interface{} { // ... }, UpdateFunc: func(obj interface{} { // .</description></item><item><title/><link>https://blog.poneding.com/kubernetes/ingress-gray-deploy/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/ingress-gray-deploy/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / é€šè¿‡ Ingress è¿›è¡Œç°åº¦å‘å¸ƒ
é€šè¿‡ Ingress è¿›è¡Œç°åº¦å‘å¸ƒ # https://start.aliyun.com/handson/Tn0HcdCZ/grap_publish_by_ingress
Step 1 ï¼šå®éªŒä»‹ç» # æœ¬å®éªŒï¼Œä½ å°†è¿è¡Œè¿è¡Œä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œéƒ¨ç½²ä¸€ä¸ªæ–°çš„åº”ç”¨ç”¨äºæ–°çš„å‘å¸ƒï¼Œå¹¶é€šè¿‡ Ingress èƒ½åŠ›å®ç°ç°åº¦å‘å¸ƒã€‚
ç°åº¦åŠè“ç»¿å‘å¸ƒæ˜¯ä¸ºæ–°ç‰ˆæœ¬åˆ›å»ºä¸€ä¸ªä¸è€ç‰ˆæœ¬å®Œå…¨ä¸€è‡´çš„ç”Ÿäº§ç¯å¢ƒï¼Œåœ¨ä¸å½±å“è€ç‰ˆæœ¬çš„å‰æä¸‹ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™æŠŠéƒ¨åˆ†æµé‡åˆ‡æ¢åˆ°æ–°ç‰ˆæœ¬ï¼Œå½“æ–°ç‰ˆæœ¬è¯•è¿è¡Œä¸€æ®µæ—¶é—´æ²¡æœ‰é—®é¢˜åï¼Œå°†ç”¨æˆ·çš„å…¨é‡æµé‡ä»è€ç‰ˆæœ¬è¿ç§»è‡³æ–°ç‰ˆæœ¬ã€‚
é€šè¿‡æœ¬å®éªŒï¼Œä½ å°†å­¦ä¹ ï¼š
é€šè¿‡ Ingress æŒ‰æƒé‡è¿›è¡Œç°åº¦å‘å¸ƒ é€šè¿‡ Ingress æŒ‰ Header è¿›è¡Œç°åº¦å‘å¸ƒ å®¹å™¨æœåŠ¡ Kubernetes ç‰ˆï¼ˆç®€ç§° ACKï¼‰ æœ¬èŠ‚è¯¾ä½¿ç”¨çš„ Kubernetes(k8s) é›†ç¾¤å°±æ˜¯ç”± ACK æä¾›çš„ï¼Œæœ¬å®éªŒæ¶µç›–çš„éƒ½æ˜¯ä¸€äº›åŸºæœ¬æ“ä½œã€‚æ›´å¤šé«˜çº§ç”¨æ³•ï¼Œå¯ä»¥å» ACK çš„äº§å“é¡µé¢äº†è§£å“¦ã€‚
Step 2 ï¼šéƒ¨ç½² Deployment V1 åº”ç”¨ # åˆ›å»ºå¦‚ä¸‹ YAML æ–‡ä»¶(app-v1.yaml)
apiVersion: v1 kind: Service metadata: name: my-app-v1 labels: app: my-app spec: ports: - name: http port: 80 targetPort: http selector: app: my-app version: v1.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/installation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/installation/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / å®‰è£… Kubernetes
å®‰è£… Kubernetes # Â« é€šè¿‡ Ingress è¿›è¡Œç°åº¦å‘å¸ƒ
Â» K3s</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k3s/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k3s/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / K3s
K3s # k3s æ˜¯ä¸€æ¬¾è½»é‡çº§çš„ Kubernetes å‘è¡Œç‰ˆï¼Œä¸“ä¸ºç‰©è”ç½‘åŠè¾¹ç¼˜è®¡ç®—è®¾è®¡ã€‚
è¦æ±‚ # K3s æœ‰æœ›åœ¨å¤§å¤šæ•°ç°ä»£ Linux ç³»ç»Ÿä¸Šè¿è¡Œã€‚
è§„æ ¼è¦æ±‚ï¼š
CPU: 1 æ ¸ Memoryï¼š512M ç«¯å£è¦æ±‚ï¼š
K3s Server èŠ‚ç‚¹çš„å…¥ç«™è§„åˆ™å¦‚ä¸‹ï¼š
åè®® ç«¯å£ æº æè¿° TCP 6443 K3s agent èŠ‚ç‚¹ Kubernetes API Server UDP 8472 K3s server å’Œ agent èŠ‚ç‚¹ ä»…å¯¹ Flannel VXLAN éœ€è¦ UDP 51820 K3s server å’Œ agent èŠ‚ç‚¹ åªæœ‰ Flannel Wireguard åç«¯éœ€è¦ UDP 51821 K3s server å’Œ agent èŠ‚ç‚¹ åªæœ‰ä½¿ç”¨ IPv6 çš„ Flannel Wireguard åç«¯æ‰éœ€è¦ TCP 10250 K3s server å’Œ agent èŠ‚ç‚¹ Kubelet metrics TCP 2379-2380 K3s server èŠ‚ç‚¹ åªæœ‰åµŒå…¥å¼ etcd é«˜å¯ç”¨æ‰éœ€è¦ å¯åŠ¨ # curl -sfL https://rancher-mirror.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-deploy-coredns/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-deploy-coredns/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 K8séƒ¨ç½²coredns
Kubernetes 0-1 K8séƒ¨ç½²coredns # åœ¨K8sé›†ç¾¤æœªéƒ¨ç½²DNSä¹‹å‰ï¼ŒK8sä¸­è¿è¡Œçš„Podæ˜¯æ— æ³•è®¿é—®å¤–éƒ¨ç½‘ç»œçš„ï¼Œå› ä¸ºæ— æ³•å®ŒæˆåŸŸåè§£æã€‚
æ¯”å¦‚æˆ‘ä»¬è¿è¡Œä¸€ä¸ªbusyboxçš„Podï¼Œç„¶ååœ¨Podé‡Œé¢æ˜¯æ— æ³•pingé€šå¤–éƒ¨ç½‘ç»œçš„ï¼š
[root@k8s-master01 ~]# kubectl run -it --rm busybox --image=busybox sh If you don&amp;#39;t see a command prompt, try pressing enter. / # ping www.baidu.com ping: bad address &amp;#39;www.baidu.com&amp;#39; æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨K8sä¸­éƒ¨ç½²corednsè§£å†³è¿™ä¸€é—®é¢˜ã€‚
å‡†å¤‡coredns.yamlæ–‡ä»¶ï¼Œå†™å…¥æ–‡ä»¶å†…å®¹ï¼š
apiVersion: v1 kind: ServiceAccount metadata: name: coredns namespace: kube-system labels: kubernetes.io/cluster-service: &amp;#34;true&amp;#34; addonmanager.kubernetes.io/mode: Reconcile --- apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRole metadata: labels: kubernetes.io/bootstrapping: rbac-defaults addonmanager.kubernetes.io/mode: Reconcile name: system:coredns rules: - apiGroups: - &amp;#34;&amp;#34; resources: - endpoints - services - pods - namespaces verbs: - list - watch - apiGroups: - &amp;#34;&amp;#34; resources: - nodes verbs: - get --- apiVersion: rbac.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-deploy-dashboard/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-deploy-dashboard/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 K8séƒ¨ç½²Dashboard
Kubernetes 0-1 K8séƒ¨ç½²Dashboard # é¦–å…ˆä¸‹è½½éƒ¨ç½²çš„å¿…è¦æ–‡ä»¶ï¼š
wget https://raw.githubusercontent.com/kubernetes/dashboard/master/aio/deploy/recommended.yaml -O kube-dash.yaml --no-check-certificate é»˜è®¤Dashboardçš„Serviceç±»å‹æ˜¯ClusterIPï¼Œæˆ‘ä»¬é›†ç¾¤å¤–é¢ä¸æ–¹ä¾¿è®¿é—®ï¼Œæˆ‘ä»¬æœ€å¥½æ˜¯å°†Serviceç±»å‹ä¿®æ”¹ä¸ºNodePoartæˆ–LoadBalancerï¼ˆå‰ææ˜¯ä½ çš„é›†ç¾¤æ”¯æŒLoadBalancerï¼‰ï¼Œä»¥LoadBalancerä¸ºä¾‹ã€‚
ä¿®æ”¹æ–‡ä»¶kube-dash.yamlæ–‡ä»¶ï¼Œå°†kubernetes-dashboard Serviceéƒ¨åˆ†ä¿®æ”¹æˆå¦‚ä¸‹ï¼š
kind: Service apiVersion: v1 metadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard namespace: kubernetes-dashboard spec: type: LoadBalancer ports: - port: 443 targetPort: 8443 selector: k8s-app: kubernetes-dashboard åˆ›å»ºkube-dash-admin-user.yamlæ–‡ä»¶:
vim kube-dash-admin-user.yaml å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š
apiVersion: v1 kind: ServiceAccount metadata: name: admin-user namespace: kubernetes-dashboard --- apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata: name: admin-user roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: admin-user namespace: kubernetes-dashboard æ‰§è¡Œå‘½ä»¤ï¼š</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-deploy-efk/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-deploy-efk/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 K8séƒ¨ç½²EFK
Kubernetes 0-1 K8séƒ¨ç½²EFK # å†™åœ¨å‰é¢ # æœ¬ç¯‡ç›®æ ‡æ˜¯åœ¨K8sé›†ç¾¤ä¸­æ­å»ºEFKã€‚
EFKæ˜¯ç”±ElasticSearchï¼ŒFluentdï¼ŒKibaneç»„æˆçš„ä¸€å¥—ç›®å‰æ¯”è¾ƒä¸»æµçš„æ—¥å¿—ç›‘æ§ç³»ç»Ÿï¼Œä½¿ç”¨EFKç›‘æ§åº”ç”¨æ—¥å¿—ï¼Œå¯ä»¥è®©å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£æŸ¥çœ‹æ—¥å¿—ç„¶ååˆ†æåº”ç”¨è¿è¡Œæƒ…å†µã€‚
EFKç®€å•çš„å·¥ä½œåŸç†å¯ä»¥å‚è€ƒä¸‹å›¾ã€‚é€šè¿‡fluentdçš„agentæ”¶é›†æ—¥å¿—æ•°æ®ï¼Œå†™å…¥esï¼Œkibanaä»esä¸­è¯»å–æ—¥å¿—æ•°æ®å±•ç¤ºåˆ°uiã€‚
éƒ¨ç½²ElasticSearch # æœ€å¥½é€‰æ‹©éƒ¨ç½²ä¸€ä¸ªESé›†ç¾¤ï¼Œè¿™æ ·ä½ çš„ESå¯ç”¨æ€§æ›´é«˜ä¸€ç‚¹ã€‚
é‡‡ç”¨StatefulSetéƒ¨ç½²ESã€‚
ç¼–å†™es-statefulSet.yamlæ–‡ä»¶å¦‚ä¸‹ï¼š
apiVersion: apps/v1 kind: StatefulSet metadata: name: es-cluster namespace: dev spec: serviceName: elasticsearch replicas: 3 selector: matchLabels: app: elasticsearch template: metadata: labels: app: elasticsearch spec: containers: - name: elasticsearch image: docker.elastic.co/elasticsearch/elasticsearch:7.7.0 resources: limits: cpu: 1000m requests: cpu: 100m ports: - containerPort: 9200 name: rest protocol: TCP - containerPort: 9300 name: inter-node protocol: TCP volumeMounts: - name: data mountPath: /usr/share/elasticsearch/data env: - name: cluster.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-deploy-prometheus-grafana/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-deploy-prometheus-grafana/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / å¯èƒ½éœ€è¦è¿è¡Œå¤šæ¬¡ä»¥ä¸‹å‘½ä»¤ï¼Œç¡®ä¿k8sèµ„æºéƒ½åˆ›å»º
Step # ä¸‹è½½ç›¸å…³k8sèµ„æºæ–‡ä»¶ git clone https://github.com/coreos/kube-prometheus.git ä¿®æ”¹æ–‡ä»¶kube-prometheus/manifests/prometheus-prometheus.yamlï¼Œåšè¿™ä¸€æ­¥çš„ç›®çš„æ˜¯ä¸ºprometheusçš„è®¿é—®åˆ†é…å­è·¯å¾„ï¼Œè®¿é—®æ–¹å¼ä¸ºhttp(s)://xxx/prometheus
åœ¨prometheus.specä¸‹æ·»åŠ 
externalUrl: prometheus routePrefix: prometheus ä¿®æ”¹æ–‡ä»¶kube-prometheus/manifests/grafana-deployment.yamlï¼Œåšè¿™ä¸€æ­¥çš„ç›®çš„æ˜¯ä¸ºgrafanaçš„è®¿é—®åˆ†é…å­è·¯å¾„ï¼Œè®¿é—®æ–¹å¼ä¸ºï¼šhttp(s)://xxx/grafana
åœ¨deployment.spec.template.spec.container[0]ä¸‹æ·»åŠ 
env: - name: GF_SERVER_ROOT_URL value: &amp;#34;http://localhost:3000/grafana&amp;#34; - name: GF_SERVER_SERVE_FROM_SUB_PATH value: &amp;#34;true&amp;#34; Apply k8sèµ„æº # å¯èƒ½éœ€è¦è¿è¡Œå¤šæ¬¡ä»¥ä¸‹å‘½ä»¤ï¼Œç¡®ä¿k8sèµ„æºéƒ½åˆ›å»º kubectl create -f manifests/setup -f manifests # !å¦‚æœè¦åˆ é™¤ä»¥ä¸Šåˆ›å»ºçš„k8sèµ„æºï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ kubectl delete --ignore-not-found=true -f manifests/ -f manifests/setup Ingressè½¬å‘ apiVersion: extensions/v1beta1 kind: Ingress metadata: name: prometheus namespace: monitoring spec: rules: - host: dp.example.tech http: paths: - path: /prometheus backend: serviceName: prometheus-k8s servicePort: 9090 - path: /grafana backend: serviceName: grafana servicePort: 3000 - path: /alertmanager backend: serviceName: alertmanager-main servicePort: 9093 Â« Kubernetes 0-1 K8séƒ¨ç½²EFK</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-deploy-zookeeper-kafka/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-deploy-zookeeper-kafka/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 K8séƒ¨ç½²Zookeeperå’ŒKafka
Kubernetes 0-1 K8séƒ¨ç½²Zookeeperå’ŒKafka # æŒ‰ç…§å®˜æ–¹å®šä¹‰ï¼ŒKafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æµå¤„ç†å¹³å°ã€‚æ›´å¤šäº†è§£å®˜æ–¹æ–‡æ¡£ï¼š http://kafka.apachecn.org/intro.html
é‚£ä¹ˆç›´æ¥å¼€å§‹åœ¨K8sä¸­éƒ¨ç½²kafkaå§ã€‚
éƒ¨ç½²kafkaï¼Œé¦–å…ˆè¦æœ‰ä¸€ä¸ªå¯ç”¨çš„Zookeeperé›†ç¾¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å…ˆéƒ¨ç½²ä¸€ä¸ªZookeeperé›†ç¾¤ã€‚
é¦–å…ˆè¯´æ˜ï¼Œæˆ‘çš„K8sé›†ç¾¤æ˜¯ä½¿ç”¨çš„AWSçš„EKSæœåŠ¡ï¼Œä¸è‡ªå»ºçš„K8sé›†ç¾¤çš„é…ç½®æ–¹é¢å¯èƒ½ä¼šæœ‰æ‰€å·®åˆ«ã€‚
éƒ¨ç½²Zookeeper # ç¼–å†™zookeeper-statefulSet.yamlæ–‡ä»¶ï¼š
vim zookeeper-statefulSet.yaml å†™å…¥å†…å®¹:
kind: StatefulSet apiVersion: apps/v1beta1 metadata: name: zookeeper-1 namespace: dev spec: serviceName: zookeeper-1 replicas: 1 selector: matchLabels: app: zookeeper-1 template: metadata: labels: app: zookeeper-1 spec: containers: - name: zookeeper image: digitalwonderland/zookeeper ports: - containerPort: 2181 env: - name: ZOOKEEPER_ID value: &amp;#34;1&amp;#34; - name: ZOOKEEPER_SERVER_1 value: zookeeper-1 - name: ZOOKEEPER_SERVER_2 value: zookeeper-2 - name: ZOOKEEPER_SERVER_3 value: zookeeper-3 volumeMounts: - name: zookeeper-data mountPath: &amp;#34;/var/lib/zookeeper/data&amp;#34; subPath: zookeeper volumeClaimTemplates: - metadata: name: zookeeper-data labels: app: zookeeper-1 spec: accessModes: [&amp;#34;ReadWriteOnce&amp;#34;] storageClassName: gp2 resources: requests: storage: 30Gi --- kind: StatefulSet apiVersion: apps/v1beta1 metadata: name: zookeeper-2 namespace: dev spec: serviceName: zookeeper-2 replicas: 1 selector: matchLabels: app: zookeeper-2 template: metadata: labels: app: zookeeper-2 spec: containers: - name: zookeeper image: digitalwonderland/zookeeper ports: - containerPort: 2181 env: - name: ZOOKEEPER_ID value: &amp;#34;2&amp;#34; - name: ZOOKEEPER_SERVER_1 value: zookeeper-1 - name: ZOOKEEPER_SERVER_2 value: zookeeper-2 - name: ZOOKEEPER_SERVER_3 value: zookeeper-3 volumeMounts: - name: zookeeper-data mountPath: &amp;#34;/var/lib/zookeeper/data&amp;#34; subPath: zookeeper-data volumeClaimTemplates: - metadata: name: zookeeper-data labels: app: zookeeper-2 spec: accessModes: [&amp;#34;ReadWriteOnce&amp;#34;] storageClassName: gp2 resources: requests: storage: 30Gi --- kind: StatefulSet apiVersion: apps/v1beta1 metadata: name: zookeeper-3 namespace: dev spec: serviceName: zookeeper-3 replicas: 1 selector: matchLabels: app: zookeeper-3 template: metadata: labels: app: zookeeper-3 spec: containers: - name: zookeeper image: digitalwonderland/zookeeper ports: - containerPort: 2181 env: - name: ZOOKEEPER_ID value: &amp;#34;3&amp;#34; - name: ZOOKEEPER_SERVER_1 value: zookeeper-1 - name: ZOOKEEPER_SERVER_2 value: zookeeper-2 - name: ZOOKEEPER_SERVER_3 value: zookeeper-3 volumeMounts: - name: zookeeper-data mountPath: &amp;#34;/var/lib/zookeeper/data&amp;#34; subPath: zookeeper volumeClaimTemplates: - metadata: name: zookeeper-data labels: app: zookeeper-3 spec: accessModes: [&amp;#34;ReadWriteOnce&amp;#34;] storageClassName: gp2 resources: requests: storage: 30Gi ç¼–å†™zookeeper-service.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-dev-01-api-concept/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-dev-01-api-concept/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes å®šåˆ¶å¼€å‘ 01ï¼šK8s API æ¦‚å¿µ
Kubernetes å®šåˆ¶å¼€å‘ 01ï¼šK8s API æ¦‚å¿µ # åœ¨ K8s é›†ç¾¤ä¸­ï¼ŒAPI æ˜¯ä¸€åˆ‡çš„åŸºç¡€ï¼ŒK8s çš„æ‰€æœ‰èµ„æºå¯¹è±¡éƒ½æ˜¯é€šè¿‡ API æ¥ç®¡ç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å®šåˆ¶å¼€å‘çš„æ—¶å€™ï¼Œé¦–å…ˆè¦äº†è§£ K8s çš„ API æ¦‚å¿µã€‚
åŸºæœ¬æ¦‚å¿µ # Groupï¼ˆGï¼‰ï¼š
API ç»„ï¼Œä¾‹å¦‚ï¼šappsã€networking.k8s.io ç­‰
Versionï¼ˆVï¼‰ï¼š
API ç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼šv1alpha1ã€v1ã€v2 ç­‰
Resourceï¼ˆRï¼‰ï¼š
API èµ„æºï¼Œä¾‹å¦‚ï¼špodsï¼Œconfigmaps ç­‰
Kindï¼ˆKï¼‰ï¼š
API ç±»å‹ï¼Œä¾‹å¦‚ï¼šDeploymentï¼ŒService ç­‰ é€šè¿‡ kubectl api-versions è·å–é›†ç¾¤ä¸­æ‰€æœ‰ API çš„ç‰ˆæœ¬åˆ—è¡¨ï¼š
$ kubectl api-versions acme.cert-manager.io/v1 admissionregistration.k8s.io/v1 apiextensions.k8s.io/v1 apiregistration.k8s.io/v1 apps/v1 authentication.k8s.io/v1 é€šè¿‡ kubectl api-resources å‘½ä»¤è·å–é›†ç¾¤æ‰€æœ‰ API çš„èµ„æºåˆ—è¡¨ï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°èµ„æºçš„ç®€å†™åç§°ï¼Œç‰ˆæœ¬ä»¥åŠç±»å‹ï¼š
$ kubectl api-resources NAME SHORTNAMES APIVERSION NAMESPACED KIND bindings v1 true Binding componentstatuses cs v1 false ComponentStatus configmaps cm v1 true ConfigMap endpoints ep v1 true Endpoints events ev v1 true Event limitranges limits v1 true LimitRange namespaces ns v1 false Namespace nodes no v1 false Node API èµ„æºç«¯ç‚¹ # GVR ç«¯ç‚¹ï¼š</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-dev-02-crd/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-dev-02-crd/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes å®šåˆ¶å¼€å‘ 02ï¼šCRD
Kubernetes å®šåˆ¶å¼€å‘ 02ï¼šCRD # Â« Kubernetes å®šåˆ¶å¼€å‘ 01ï¼šK8s API æ¦‚å¿µ
Â» Kubernetes å®šåˆ¶å¼€å‘ 50ï¼šæ‰©å±•è°ƒåº¦å™¨</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-dev-50-extend-kube-scheduler/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-dev-50-extend-kube-scheduler/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes å®šåˆ¶å¼€å‘ 50ï¼šæ‰©å±•è°ƒåº¦å™¨
Kubernetes å®šåˆ¶å¼€å‘ 50ï¼šæ‰©å±•è°ƒåº¦å™¨ # ç®€ä»‹ # Kubernetes Schedulerï¼ˆè°ƒåº¦å™¨ï¼‰æ˜¯ä¸€ä¸ªæ§åˆ¶é¢è¿›ç¨‹ï¼Œè´Ÿè´£å°† Pods æŒ‡æ´¾åˆ°èŠ‚ç‚¹ä¸Šã€‚è°ƒåº¦å™¨åŸºäºçº¦æŸå’Œå¯ç”¨èµ„æºä¸ºè°ƒåº¦é˜Ÿåˆ—ä¸­æ¯ä¸ª Pod ç¡®å®šå…¶å¯åˆæ³•æ”¾ç½®çš„èŠ‚ç‚¹ã€‚è°ƒåº¦å™¨ä¹‹åå¯¹æ‰€æœ‰åˆæ³•çš„èŠ‚ç‚¹è¿›è¡Œæ’åºï¼Œå°† Pod ç»‘å®šåˆ°ä¸€ä¸ªåˆé€‚çš„èŠ‚ç‚¹ã€‚
kube-scheduler æ˜¯ Kubernetes è‡ªå¸¦çš„ä¸€ä¸ªé»˜è®¤è°ƒåº¦å™¨ï¼Œå®ƒä¼šæ ¹æ® Pod çš„èµ„æºéœ€æ±‚å’ŒèŠ‚ç‚¹çš„èµ„æºå®¹é‡ï¼Œå°† Pod è°ƒåº¦åˆ°åˆé€‚çš„èŠ‚ç‚¹ä¸Šã€‚
å¦‚æœé»˜è®¤è°ƒåº¦å™¨ä¸ç¬¦åˆä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥å®ç°è‡ªå·±çš„è°ƒåº¦å™¨ï¼Œå¹¶ä¸”ä½ çš„è°ƒåº¦å™¨å¯ä»¥å’Œé»˜è®¤è°ƒåº¦å™¨æˆ–å…¶ä»–è°ƒåº¦å™¨ä¸€èµ·è¿è¡Œåœ¨é›†ç¾¤ä¸­ã€‚ä½ å¯ä»¥é€šè¿‡å£°æ˜ Pod çš„ spec.schedulerName å­—æ®µæ¥æŒ‡å®šè¦ä½¿ç”¨çš„è°ƒåº¦å™¨ã€‚
æ‰©å±•è°ƒåº¦å™¨ # æœ‰ä¸‰ç§æ–¹å¼å¯ä»¥å®ç°è‡ªå®šä¹‰è°ƒåº¦å™¨ï¼š
ä¿®æ”¹ kube-scheduler æºç è°ƒåº¦é€»è¾‘ï¼Œç„¶åç¼–è¯‘æˆå®šåˆ¶çš„è°ƒåº¦å™¨é•œåƒï¼Œç„¶åä½¿ç”¨è¿™ä¸ªé•œåƒéƒ¨ç½²è°ƒåº¦è¿›ç¨‹ è‡ªå®šä¹‰ Pod æ§åˆ¶å™¨ï¼Œç›‘å¬ Pod çš„ spec.schedulerName å­—æ®µï¼Œåœ¨ Pod è¢«åˆ›å»ºæ—¶ï¼Œä¸ºå…¶ç»‘å®šèŠ‚ç‚¹ ä½¿ç”¨ Scheduler Extender çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼ä¸éœ€è¦ä¿®æ”¹é»˜è®¤è°ƒåº¦å™¨çš„é…ç½®æ–‡ä»¶ ç¼–è¯‘å®šåˆ¶è°ƒåº¦å™¨é•œåƒ # å…‹éš† kubernetes æºç ï¼Œç„¶åä¿®æ”¹ kube-scheduler æºç ï¼Œç„¶åç¼–è¯‘æˆå®šåˆ¶çš„è°ƒåº¦å™¨é•œåƒã€‚
git clone https://github.com/kubernetes/kubernetes.git cd kubernetes # ä¿®æ”¹æºç  make ç¼–å†™ Dockerfileï¼š</description></item><item><title/><link>https://blog.poneding.com/kubernetes/k8s-get-started/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/k8s-get-started/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / ç®€å•ä»‹ç» K8s
ç®€å•ä»‹ç» K8s # ç®€ä»‹ # æˆ‘ä»¬çš„åº”ç”¨éƒ¨ç½²è¶‹åŠ¿ç”±å¤§å‹å•ä½“åº”ç”¨å‘å¾®æœåŠ¡æ¼”å˜ï¼Œå¾®æœåŠ¡åº”ç”¨ä¹‹é—´è§£è€¦ï¼Œå½¢æˆå¯è¢«ç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²ã€å‡çº§ã€ä¼¸ç¼©çš„è½¯ä»¶å•å…ƒã€‚
å¦ä¸€æ–¹é¢å®¹å™¨æŠ€æœ¯ç”±äºå®ƒçš„è½»é‡çº§ï¼Œèµ„æºéš”ç¦»ï¼Œå¯ç§»æ¤ã€éƒ¨ç½²é«˜æ•ˆç­‰ç‰¹æ€§å¾—åˆ°äº†è¿…é€Ÿçš„å‘å±•å’Œæ™®åŠã€‚è¶Šæ¥è¶Šå¤šçš„åº”ç”¨é€‰æ‹©ä½¿ç”¨å®¹å™¨æ¥éƒ¨ç½²ï¼Œå¾®æœåŠ¡æ›´ä¸ä¾‹å¤–ã€‚
è¿™æ—¶ï¼Œä¾¿æœ‰äº†ç®¡ç†å¾®æœåŠ¡+å®¹å™¨çš„éœ€æ±‚ï¼ŒKubernetes å¼€å§‹å¤§æ”¾å¼‚å½©ã€‚
Kubernetes æ˜¯åŸºäºå®¹å™¨æŠ€æœ¯çš„æœåŠ¡å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿï¼Œé€šè¿‡å®ƒï¼Œå¯ä»¥æ‰˜ç®¡æ•°é‡åºå¤§çš„åº”ç”¨é›†ï¼Œå¹¶ä¸”å†…ç½®å®Œå¤‡çš„é›†ç¾¤ç®¡ç†èƒ½åŠ›ï¼Œå®ƒæœ‰èƒ½åŠ›å¸®ä½ åšåˆ°è¿™äº›ï¼š
åº”ç”¨çš„å®¹å™¨åŒ–éƒ¨ç½²ã€å¥åº·æ£€æŸ¥ã€è‡ªæˆ‘ä¿®å¤ã€è‡ªåŠ¨ä¼¸ç¼©ã€æ»šåŠ¨æ›´æ–°ã€èµ„æºåˆ†é…ç­‰ æœåŠ¡çš„æ³¨å†Œã€å‘ç°ã€å‡è¡¡è´Ÿè½½ç­‰ Kubernetes å¯¹äºè¿ç»´å›¢é˜Ÿæ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¸®æ‰‹ï¼Œæ›´è‡ªåŠ¨åŒ–çš„éƒ¨ç½²å’Œç®¡ç†åº”ç”¨ï¼Œæ›´é«˜æ•ˆçš„åˆ©ç”¨ç¡¬ä»¶èµ„æºã€‚
åŸºæœ¬æ¦‚å¿µ # Kubernetes é›†ç¾¤ï¼Œåé¢ç®€ç§°ä¸ºK8sï¼Œä¸»è¦æ˜¯ç”±æ§åˆ¶èŠ‚ç‚¹ï¼ˆMasterï¼‰å’Œå·¥ä½œèŠ‚ç‚¹ï¼ˆNodeï¼‰ç»„æˆã€‚
åœ¨ Master èŠ‚ç‚¹ä¸­è¿è¡Œç€ä¸‰å¤§ç»„ä»¶ï¼škube-api-serverã€kube-controller-managerã€kube-schedulerï¼Œé€šå¸¸ä¹Ÿä¼šå°† etcd æ•°æ®åº“éƒ¨ç½²åœ¨ Master èŠ‚ç‚¹ã€‚
åœ¨ Node èŠ‚ç‚¹ä¸­ï¼Œä¹Ÿæ˜¯éœ€è¦éƒ¨ç½²ä¸‰ä¸ªä¸»è¦ç»„ä»¶ï¼Œå®¹å™¨å¼•æ“ï¼ˆåŸºæœ¬é»˜è®¤ docker äº†ï¼‰ã€kubeletã€kube-proxyã€‚
K8s çš„ç»„æˆç»“æ„å¤§è‡´å¦‚ä¸‹å›¾ï¼š
Master èŠ‚ç‚¹ # è´Ÿè´£ K8s èµ„æºçš„è°ƒåº¦ç®¡ç†ï¼Œç”± Master å‘ Node ä¸‹è¾¾æ§åˆ¶å‘½ä»¤ï¼Œå¹¶ä¸”ä¸€èˆ¬è¿ç»´äººå‘˜ä½¿ç”¨ Master æ“ä½œå’Œæ‰§è¡Œå‘½ä»¤ã€‚
Master èŠ‚ç‚¹æ‰®æ¼”çš„è§’è‰²ç›¸å½“äº K8s çš„å¤§è„‘ï¼Œå…¶é‡è¦æ€§å¯æƒ³è€ŒçŸ¥ï¼Œå› æ­¤å»ºè®®éƒ¨ç½² 3 å° Master èŠ‚ç‚¹ä¿è¯ K8s çš„é«˜å¯ç”¨æ€§ã€‚
kube-api-serverï¼šhttp rest æ¥å£æœåŠ¡ï¼Œä¸ K8s å…¶ä»–ç»„ä»¶é€šä¿¡ï¼Œè´Ÿè´£ K8s èµ„æºçš„ CURD çš„æ“ä½œå…¥å£ï¼›</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubeadm-install-k8s-docker/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubeadm-install-k8s-docker/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / kubeadm å®‰è£… Kubernetes (Docker)
kubeadm å®‰è£… Kubernetes (Docker) # ä½¿ç”¨ kubeadm å®‰è£… k8s é›†ç¾¤ï¼Œæ˜¯ç¤¾åŒºæ¨èçš„å®‰è£…æ–¹å¼ï¼Œæœ¬æ–‡æ¡£å°†ä»‹ç»ä½¿ç”¨ kubeadm å®‰è£… k8s é›†ç¾¤ï¼ˆä½¿ç”¨ Docker ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶ï¼‰çš„è¯¦ç»†è¿‡ç¨‹ã€‚
Notes:
éšç€ kubeadm &amp;amp; k8s ç‰ˆæœ¬çš„æ›´æ–°ï¼Œå®‰è£…è¿‡ç¨‹å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œæˆªè‡³ç›®å‰ï¼Œæœ¬æ–‡æ¡£ä½¿ç”¨çš„æ˜¯ kubeadm v1.28.3 &amp;amp; k8s v1.28.3 ç‰ˆæœ¬ï¼› æœ¬æ–‡æ¡£ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿæ˜¯ Ubuntu 22.04ï¼Œå…¶ä»–æ“ä½œç³»ç»Ÿå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ è¦æ±‚ # è‡³å°‘ä¸€å°ç‰©ç†æœºæˆ–è™šæ‹Ÿæœºï¼ˆä¾‹å¦‚ï¼šUbuntu 22.04ï¼‰ä½œä¸ºé›†ç¾¤èŠ‚ç‚¹ï¼Œæœ€å°‘ 2 æ ¸ 2G å†…å­˜ï¼› å¤šèŠ‚ç‚¹ä¹‹å‰ç½‘ç»œäº’é€šï¼Œä¸”èŠ‚ç‚¹ä¸»æœºåä¸å†²çªï¼› Master èŠ‚ç‚¹éœ€è¦å¼€æ”¾ä»¥ä¸‹ç«¯å£ï¼š6443ã€2379-2380ã€10250ã€10251ã€10252ï¼› å‡†å¤‡å·¥ä½œ # ç¦ç”¨äº¤æ¢åˆ†åŒºï¼š
# ä¸´æ—¶ç¦ç”¨äº¤æ¢åˆ†åŒº sudo swapoff -a vim /etc/fstab # æ³¨é‡Šæ‰ swap åˆ†åŒºçš„é…ç½® é…ç½®ç³»ç»Ÿï¼š
cat &amp;lt;&amp;lt;EOF | sudo tee /etc/modules-load.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubeadm-install-k8s/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubeadm-install-k8s/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / kubeadm å®‰è£… k8s (containerd)
kubeadm å®‰è£… k8s (containerd) # ä½¿ç”¨ kubeadm å®‰è£… k8s é›†ç¾¤ï¼Œæ˜¯ç¤¾åŒºæ¨èçš„å®‰è£…æ–¹å¼ï¼Œæœ¬æ–‡æ¡£å°†ä»‹ç»ä½¿ç”¨ kubeadm å®‰è£… k8s é›†ç¾¤çš„è¯¦ç»†è¿‡ç¨‹ã€‚
Notes:
éšç€ kubeadm &amp;amp; k8s ç‰ˆæœ¬çš„æ›´æ–°ï¼Œå®‰è£…è¿‡ç¨‹å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œæˆªè‡³ç›®å‰ï¼Œæœ¬æ–‡æ¡£ä½¿ç”¨çš„æ˜¯ kubeadm v1.28.3 &amp;amp; k8s v1.28.3 ç‰ˆæœ¬ï¼› æœ¬æ–‡æ¡£ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿæ˜¯ Ubuntu 22.04ï¼Œå…¶ä»–æ“ä½œç³»ç»Ÿå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ è¦æ±‚ # è‡³å°‘ä¸€å°ç‰©ç†æœºæˆ–è™šæ‹Ÿæœºï¼ˆä¾‹å¦‚ï¼šUbuntu 22.04ï¼‰ä½œä¸ºé›†ç¾¤èŠ‚ç‚¹ï¼Œæœ€å°‘ 2 æ ¸ 2G å†…å­˜ï¼› å¤šèŠ‚ç‚¹ä¹‹å‰ç½‘ç»œäº’é€šï¼Œä¸”èŠ‚ç‚¹ä¸»æœºåä¸å†²çªï¼› Master èŠ‚ç‚¹éœ€è¦å¼€æ”¾ä»¥ä¸‹ç«¯å£ï¼š6443ã€2379-2380ã€10250ã€10251ã€10252ï¼› å‡†å¤‡å·¥ä½œ # ç¦ç”¨äº¤æ¢åˆ†åŒºï¼š
# ä¸´æ—¶ç¦ç”¨äº¤æ¢åˆ†åŒº sudo swapoff -a vim /etc/fstab # æ³¨é‡Šæ‰ swap åˆ†åŒºçš„é…ç½® é…ç½®ç³»ç»Ÿï¼š
cat &amp;lt;&amp;lt;EOF | sudo tee /etc/modules-load.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubeadm-upgrade/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubeadm-upgrade/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubeadm å‡çº§ K8s
Kubeadm å‡çº§ K8s # æœ¬ç¯‡ä»¥å‡çº§ 1.29.0ï¼ˆæ—§ç‰ˆæœ¬ï¼š1.28.x ï¼‰ ç‰ˆæœ¬ä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•é€šè¿‡ kubeadm å·¥å…·æ¥å‡çº§ K8s é›†ç¾¤ã€‚
æ³¨æ„ï¼š
ä¸æ”¯æŒè·¨ä¸»ç‰ˆæœ¬å‡çº§ï¼Œå¦‚ 1.27.x å‡çº§åˆ° 1.29.xï¼Œä¸­é—´å¿…é¡»å…ˆå‡çº§åˆ° 1.28.x ä¸»ç‰ˆæœ¬æ›´æ–°å¿…é¡»å…ˆå‡çº§åˆ°æœ€æ–°çš„æ¬¡ç‰ˆæœ¬ï¼Œå¦‚ 1.28.3 å‡çº§åˆ° 1.28.4ï¼Œç„¶åå†å‡çº§åˆ° 1.29.x å‡çº§æ­¥éª¤ # æ§åˆ¶èŠ‚ç‚¹ï¼ˆcontrol plane nodeï¼‰å‡çº§ å·¥ä½œèŠ‚ç‚¹ï¼ˆworker nodeï¼‰å‡çº§ å‡çº§è¿‡ç¨‹ # 1ã€å‡çº§è‡³å½“å‰ä¸»ç‰ˆæœ¬çš„æœ€æ–°æ¬¡ç‰ˆæœ¬ # sudo apt update sudo apt-cache madison kubeadm ä»¥ä¸Šå‘½ä»¤åï¼Œå°†å¯ä»¥å¾—åˆ°ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºï¼š
$ sudo apt-cache madison kubeadm kubeadm | 1.28.4-1.1 | https://pkgs.k8s.io/core:/stable:/v1.28/deb Packages kubeadm | 1.28.3-1.1 | https://pkgs.k8s.io/core:/stable:/v1.28/deb Packages kubeadm | 1.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubebuilder-inaction/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubebuilder-inaction/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / kubebuilder å®æˆ˜
kubebuilder å®æˆ˜ # ç®€ä»‹ # kubebuilder æ˜¯ä¸€ä¸ªæ„å»º Operatorï¼ˆCRD + Controllerï¼‰çš„æ¡†æ¶çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„æ„å»ºä¸€ä¸ª Operator é¡¹ç›®ï¼Œå¹¶æä¾›äº†ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤ï¼Œä¾‹å¦‚ï¼šåˆ›å»º APIã€åˆ›å»º Controllerã€Webhook ç­‰ã€‚
å®‰è£… # æ¡ä»¶ # kustomize curl -s &amp;#34;https://raw.githubusercontent.com/kubernetes-sigs/kustomize/master/hack/install_kustomize.sh&amp;#34; | bash controller-gen go install sigs.k8s.io/controller-tools/cmd/controller-gen@latest âš ï¸ æ³¨æ„ï¼šä»¥ä¸Šå‘½ä»¤éƒ½æ˜¯ç›´æ¥ä¸‹è½½äº†å¯¹åº”å‘½ä»¤å·¥å…·æœ€æ–°çš„ç‰ˆæœ¬ï¼Œåœ¨ä½¿ç”¨ kubebuilder åˆ›å»ºé¡¹ç›®ä¹‹åï¼Œåœ¨ Makefile æ–‡ä»¶ä¸­ä¼šæŒ‡å®š kustomize å’Œ controller-gen çš„ç‰ˆæœ¬ï¼Œä¸ºäº†é¿å…ä¸å…¼å®¹ï¼Œæ¨èä¸‹è½½å¯¹åº”æŒ‡å®šçš„ç‰ˆæœ¬ã€‚
ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… kubebuilderï¼š
# download kubebuilder and install locally. GOOS=$(go env GOOS) GOARCH=$(go env GOARCH) curl -L -o kubebuilder https://go.kubebuilder.io/dl/latest/$GOOS/$GOARCH chmod +x kubebuilder &amp;amp;&amp;amp; mv kubebuilder /usr/local/bin/ ä»£ç è‡ªåŠ¨è¡¥å…¨ï¼š</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubectl/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubectl/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / kubectl
kubectl # å®‰è£… # å‚è€ƒæ–‡æ¡£ï¼š kubectl å®‰è£…æ–‡æ¡£
å¸¸ç”¨å‘½ä»¤ # è‡ªåŠ¨è¡¥å…¨ # source &amp;lt;(kubectl completion bash) å¯ä»¥å°†ä¸Šé¢çš„å‘½ä»¤å†™å…¥ ~/.bashrc æˆ– /etc/bash.bashrc ä¸­ï¼Œè¿™æ ·æ¯æ¬¡ç™»å½•éƒ½ä¼šè‡ªåŠ¨è¡¥å…¨ã€‚
$ vim ~/.bashrc ... source &amp;lt;(kubectl completion bash) å‘½ä»¤åˆ«å # alias k=kubectl complete -F __start_kubectl k Troubleshooting # Q1. _get_comp_words_by_ref: command not found # è§£å†³æ–¹æ³•ï¼š
apt install bash-completion -y source /usr/share/bash-completion/bash_completion source &amp;lt;(kubectl completion bash) Â« kubebuilder å®æˆ˜
Â» Kubernetes 0-1 Kubernetesæœ€ä½³å®è·µ</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubernetes-best-practice/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubernetes-best-practice/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 Kubernetesæœ€ä½³å®è·µ
Kubernetes 0-1 Kubernetesæœ€ä½³å®è·µ # https://github.com/learnk8s/kubernetes-production-best-practices
Â« kubectl
Â» Kubernetes Dashboard</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubernetes-dashboard/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubernetes-dashboard/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes Dashboard
Kubernetes Dashboard # Installation # Steps # ç™»å…¥Kubernetes Masteræœºå™¨ã€‚
Copyæœ€æ–°çš„recommended.yamlæ–‡ä»¶å†…å®¹ï¼Œå†™å…¥æœ¬åœ°kubernetes-dashboard.yamlæ–‡ä»¶ã€‚recommended.yamlæ–‡ä»¶åœ°å€ï¼š kubernetes dashboard github
![image-20191223173827866](
C:\Users\dp\AppData\Roaming\Typora\typora-user-images\image-20191223173827866.png)
# Copyright 2017 The Kubernetes Authors. # # Licensed under the Apache License, Version 2.0 (the &amp;#34;License&amp;#34;); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an &amp;#34;AS IS&amp;#34; BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubernetes-naming-constraints/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubernetes-naming-constraints/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes ä¸­èµ„æºåç§°è§„èŒƒ
Kubernetes ä¸­èµ„æºåç§°è§„èŒƒ # åœ¨Kubernetesä¸­ï¼ŒåŒä¸€ç§èµ„æºï¼ˆGVRï¼‰åœ¨åŒä¸€ä¸ªå‘½åç©ºé—´ä¸‹åç§°æ˜¯å”¯ä¸€ã€‚ä½†æ˜¯åç§°ä¹Ÿéœ€è¦éµå¾ªå‘½åè§„åˆ™ã€‚æœ¬ç¯‡ä¸»è¦ä»‹ç» Kubernetes ä¸­ä¸‰ç§èµ„æºåç§°çš„å‘½åè§„èŒƒã€‚
DNS1123Subdomain # ä¸èƒ½è¶…è¿‡ 253 ä¸ªå­—ç¬¦ åªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—ï¼Œä»¥åŠ &amp;lsquo;-&amp;rsquo; å’Œ &amp;lsquo;.&amp;rsquo; å¿…é¡»ä»¥å­—æ¯æ•°å­—å¼€å¤´ å¿…é¡»ä»¥å­—æ¯æ•°å­—ç»“å°¾ ä»¥æ­¤è§„èŒƒçº¦æŸçš„èµ„æºæœ‰ï¼š
Ingress Pod ConfigMap NetworkPolicy DNS1123Label # æœ€å¤š 63 ä¸ªå­—ç¬¦ åªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—ï¼Œä»¥åŠ &amp;lsquo;-&amp;rsquo; å¿…é¡»ä»¥å­—æ¯æ•°å­—å¼€å¤´ å¿…é¡»ä»¥å­—æ¯æ•°å­—ç»“å°¾ ä»¥æ­¤è§„èŒƒçº¦æŸçš„èµ„æºæœ‰ï¼š
Namespace Service DNS1035Label # æœ€å¤š 63 ä¸ªå­—ç¬¦ åªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—ï¼Œä»¥åŠ &amp;lsquo;-&amp;rsquo; å¿…é¡»ä»¥å­—æ¯å¼€å¤´ å¿…é¡»ä»¥å­—æ¯æ•°å­—ç»“å°¾ ä»¥æ­¤è§„èŒƒçº¦æŸçš„èµ„æºæœ‰ï¼š
Deployment StatefulSet å»ºè®® # å¦‚æœèµ„æºå‘½åç¬¦åˆ DNS1035Label è§„èŒƒï¼Œé‚£ä¹ˆä¸€å®šç¬¦åˆ Kubernetes èµ„æºå‘½åè§„èŒƒã€‚å‡å¦‚åœ¨å®¹å™¨å¹³å°å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†å‘½åçº¦æŸæ›´åŠ ç»Ÿä¸€ï¼Œå»ºè®®ä½¿ç”¨ DNS1035Label è§„èŒƒæ¥çº¦æŸèµ„æºå‘½åã€‚
å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼ˆGoï¼‰æ¥æ£€æŸ¥èµ„æºåç§°æ˜¯å¦ç¬¦åˆè§„èŒƒï¼š
å¼•å…¥åŒ…ï¼š
go get k8s.io/apimachinery/pkg/util/validation ç¤ºä¾‹ä»£ç ï¼š
package main import ( &amp;#34;k8s.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubernetes/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubernetes/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kuberentes
Kuberentes # Â« Kubernetes ä¸­èµ„æºåç§°è§„èŒƒ
Â» KubeVirt åˆ›å»º Windows è™šæ‹Ÿæœº</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubevirt-create-windows-vm/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubevirt-create-windows-vm/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / KubeVirt åˆ›å»º Windows è™šæ‹Ÿæœº
KubeVirt åˆ›å»º Windows è™šæ‹Ÿæœº # virtctl image-upload --image-path windows-10.iso --pvc-name=windows-10-iso --size 10G --uploadproxy-url https://&amp;lt;cdi-uploadproxy.cdi.svc&amp;gt; --insecure --wait-secs 240 apiVersion: v1 kind: PersistentVolumeClaim metadata: name: windows-10-data spec: accessModes: - ReadWriteOnce resources: requests: storage: 40G storageClassName: longhorn volumeMode: Filesystem --- apiVersion: kubevirt.io/v1 kind: VirtualMachine metadata: name: windows-10 spec: running: true template: metadata: labels: kubevirt.io/domain: windows-10 spec: domain: cpu: cores: 4 devices: networkInterfaceMultiqueue: true #å¼€å¯ç½‘å¡å¤šé˜Ÿåˆ—æ¨¡å¼ blockMultiQueue: true #å¼€å¯ç£ç›˜å¤šé˜Ÿåˆ—æ¨¡å¼ disks: - cdrom: bus: sata name: virtiocontainerdisk - cdrom: bus: sata name: cdromiso bootOrder: 1 - disk: bus: virtio name: harddrive bootOrder: 2 interfaces: - masquerade: {} model: virtio name: default resources: requests: memory: 8G networks: - name: default pod: {} volumes: - name: cdromiso persistentVolumeClaim: claimName: windows-10-iso - name: harddrive persistentVolumeClaim: claimName: windows-10-data - containerDisk: image: kubevirt/virtio-container-disk name: virtiocontainerdisk Â« Kuberentes</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kubevirt-practice/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kubevirt-practice/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubevirt å®è·µ
Kubevirt å®è·µ # ç®€ä»‹ # Kubevirt æ˜¯ Redhat å¼€æºçš„ä»¥å®¹å™¨æ–¹å¼è¿è¡Œè™šæ‹Ÿæœºçš„é¡¹ç›®ï¼Œä»¥ k8s add-on æ–¹å¼ï¼Œåˆ©ç”¨ k8s CRD ä¸ºå¢åŠ èµ„æºç±»å‹ VirtualMachineInstanceï¼ˆVMIï¼‰ï¼Œ ä½¿ç”¨å®¹å™¨çš„ image registry å»åˆ›å»ºè™šæ‹Ÿæœºå¹¶æä¾› VM ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚ CRD çš„æ–¹å¼ä½¿å¾— kubevirt å¯¹è™šæ‹Ÿæœºçš„ç®¡ç†ä¸å±€é™äº pod ç®¡ç†æ¥å£ï¼Œä½†æ˜¯ä¹Ÿæ— æ³•ä½¿ç”¨ pod çš„ RS DS Deployment ç­‰ç®¡ç†èƒ½åŠ›ï¼Œä¹Ÿæ„å‘³ç€ kubevirt å¦‚æœæƒ³è¦åˆ©ç”¨ pod ç®¡ç†èƒ½åŠ›ï¼Œè¦è‡ªä¸»å»å®ç°ï¼Œç›®å‰ kubevirt å®ç°äº†ç±»ä¼¼ RS çš„åŠŸèƒ½ã€‚ kubevirt ç›®å‰æ”¯æŒçš„ runtime æ˜¯ docker å’Œ runcã€‚
å®‰è£… # éƒ¨ç½² K8s èµ„æº # æœ€æ–°ç‰ˆæœ¬ export KUBEVIRT_VERSION=$(curl -s https://api.github.com/repos/kubevirt/kubevirt/releases/latest | jq -r .</description></item><item><title/><link>https://blog.poneding.com/kubernetes/kustomize/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/kustomize/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kustomize
Kustomize # Kustomize æ˜¯ä¸€ä¸ªé€šè¿‡ kustomization æ–‡ä»¶ å®šåˆ¶ Kubernetes å¯¹è±¡çš„å·¥å…·ã€‚å®ƒæä¾›ä»¥ä¸‹åŠŸèƒ½ç‰¹æ€§æ¥ç®¡ç†åº”ç”¨é…ç½®æ–‡ä»¶ï¼š
ä»å…¶ä»–æ¥æºç”Ÿæˆèµ„æº ä¸ºèµ„æºè®¾ç½®è´¯ç©¿æ€§ï¼ˆCross-Cuttingï¼‰å­—æ®µ ç»„ç»‡å’Œå®šåˆ¶èµ„æºé›†åˆ ä» 1.14 ç‰ˆæœ¬å¼€å§‹ï¼Œkubectl ä¹Ÿå¼€å§‹æ”¯æŒä½¿ç”¨ kustomization æ–‡ä»¶æ¥ç®¡ç† Kubernetes å¯¹è±¡ã€‚ è¦æŸ¥çœ‹åŒ…å« kustomization æ–‡ä»¶çš„ç›®å½•ä¸­çš„èµ„æºï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š
kubectl kustomize &amp;lt;kustomization_directory&amp;gt; è¦åº”ç”¨è¿™äº›èµ„æºï¼Œä½¿ç”¨ --kustomize æˆ– -k å‚æ•°æ¥æ‰§è¡Œ kubectl applyï¼š
kubectl apply -k &amp;lt;kustomization_directory&amp;gt; ç”Ÿæˆèµ„æº # ConfigMap å’Œ Secret åŒ…å«å…¶ä»– Kubernetes å¯¹è±¡ï¼ˆå¦‚ Podï¼‰æ‰€éœ€è¦çš„é…ç½®æˆ–æ•æ„Ÿæ•°æ®ã€‚ ConfigMap æˆ– Secret ä¸­æ•°æ®çš„æ¥æºå¾€å¾€æ˜¯é›†ç¾¤å¤–éƒ¨ï¼Œä¾‹å¦‚æŸä¸ª .properties æ–‡ä»¶æˆ–è€… SSH å¯†é’¥æ–‡ä»¶ã€‚ Kustomize æä¾› secretGenerator å’Œ configMapGeneratorï¼Œå¯ä»¥åŸºäºæ–‡ä»¶æˆ–å­—é¢å€¼æ¥ç”Ÿæˆ Secret å’Œ ConfigMapã€‚
configMapGenerator # è¦åŸºäºæ–‡ä»¶æ¥ç”Ÿæˆ ConfigMapï¼Œå¯ä»¥åœ¨ configMapGenerator çš„ files åˆ—è¡¨ä¸­æ·»åŠ è¡¨é¡¹ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªæ ¹æ® .</description></item><item><title/><link>https://blog.poneding.com/kubernetes/liveness-readiness-probe/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/liveness-readiness-probe/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 Podä¸­çš„livenessProbeå’ŒreadinessProbeè§£è¯»
Kubernetes 0-1 Podä¸­çš„livenessProbeå’ŒreadinessProbeè§£è¯» # å†™åœ¨å‰é¢ # K8så¯¹Podçš„å¥åº·çŠ¶æ€å¯ä»¥é€šè¿‡ä¸¤ç±»æ¢é’ˆæ¥æ£€æŸ¥ï¼šlivenessProbeå’ŒreadinessProbeï¼Œkubeleté€šè¿‡å®šæœŸæ‰§è¡Œè¿™ä¸¤ç±»æ¢é’ˆæ¥è¯Šæ–­å®¹å™¨çš„å¥åº·çŠ¶å†µã€‚
livenessProbeç®€ä»‹ # å­˜æ´»æŒ‡é’ˆï¼Œåˆ¤æ–­Podï¼ˆä¸­çš„åº”ç”¨å®¹å™¨ï¼‰æ˜¯å¦å¥åº·ï¼Œå¯ä»¥ç†è§£ä¸ºå¥åº·æ£€æŸ¥ã€‚æˆ‘ä»¬ä½¿ç”¨livenessProbeæ¥å®šæœŸçš„å»æ¢æµ‹ï¼Œå¦‚æœæ¢æµ‹æˆåŠŸï¼Œåˆ™PodçŠ¶æ€å¯ä»¥åˆ¤å®šä¸ºRunningï¼›å¦‚æœæ¢æµ‹å¤±è´¥ï¼Œå¯kubectlä¼šæ ¹æ®Podçš„é‡å¯ç­–ç•¥æ¥é‡å¯å®¹å™¨ã€‚
å¦‚æœæœªç»™Podè®¾ç½®livenessProbeï¼Œåˆ™é»˜è®¤æ¢é’ˆæ°¸è¿œè¿”å›Successã€‚
å½“æˆ‘ä»¬æ‰§è¡Œkubectl get podså‘½ä»¤ï¼Œè¾“å‡ºä¿¡æ¯ä¸­STATUSä¸€åˆ—æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Podæ˜¯å¦å¤„äºRunningçŠ¶æ€ã€‚
readinessProbeç®€ä»‹ # å°±ç»ªæŒ‡é’ˆï¼Œå°±ç»ªçš„æ„æ€æ˜¯å·²ç»å‡†å¤‡å¥½äº†ï¼ŒPodçš„å°±ç»ªæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºè¿™ä¸ªPodå¯ä»¥æ¥å—è¯·æ±‚å’Œè®¿é—®ã€‚æˆ‘ä»¬ä½¿ç”¨readinessProbeæ¥å®šæœŸçš„å»æ¢æµ‹ï¼Œå¦‚æœæ¢æµ‹æˆåŠŸï¼Œåˆ™Pod çš„ReadyçŠ¶æ€åˆ¤å®šä¸ºTrueï¼›å¦‚æœæ¢æµ‹å¤±è´¥ï¼ŒPodçš„ReadyçŠ¶æ€åˆ¤å®šä¸ºFalseã€‚
ä¸livenessProbeä¸åŒçš„æ˜¯ï¼Œkubeletä¸ä¼šå¯¹readinessProbeçš„æ¢æµ‹æƒ…å†µæœ‰é‡å¯æ“ä½œã€‚
å½“æˆ‘ä»¬æ‰§è¡Œkubectl get podså‘½ä»¤ï¼Œè¾“å‡ºä¿¡æ¯ä¸­READYä¸€åˆ—æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Podçš„READYçŠ¶æ€æ˜¯å¦ä¸ºTrueã€‚
å®šä¹‰å‚æ•° # livenessProbeå’ŒreadinessProbeçš„å®šä¹‰å‚æ•°æ˜¯ä¸€è‡´çš„ï¼Œå¯ä»¥é€šè¿‡kubectl explain pods.spec.containers.readinessProbeæˆ–kubectl explain pods.spec.containers.livenessProbeå‘½ä»¤äº†è§£ï¼š
å°±ç»ªæ¢é’ˆçš„å‡ ç§ç±»å‹ï¼š
httpGetï¼š
å‘å®¹å™¨å‘é€Http Getè¯·æ±‚ï¼Œè°ƒç”¨æˆåŠŸï¼ˆé€šè¿‡HttpçŠ¶æ€ç åˆ¤æ–­ï¼‰åˆ™ç¡®å®šPodå°±ç»ªï¼›
ä½¿ç”¨æ–¹å¼ï¼š
livenessProbe: httpGet: path: /app/healthz port: 80 execï¼š
åœ¨å®¹å™¨å†…æ‰§è¡ŒæŸå‘½ä»¤ï¼Œå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼ˆé€šè¿‡å‘½ä»¤é€€å‡ºçŠ¶æ€ç ä¸º0åˆ¤æ–­ï¼‰åˆ™ç¡®å®šPodå°±ç»ªï¼›
ä½¿ç”¨æ–¹å¼ï¼š
livenessProbe: exec: command: - cat - /app/healthz tcpSocketï¼š
æ‰“å¼€ä¸€ä¸ªTCPè¿æ¥åˆ°å®¹å™¨çš„æŒ‡å®šç«¯å£ï¼Œè¿æ¥æˆåŠŸå»ºç«‹åˆ™ç¡®å®šPodå°±ç»ªã€‚
ä½¿ç”¨æ–¹å¼ï¼š
livenessProbe: tcpSocket: port: 80 ä¸€èˆ¬å°±ç»ªæ¢é’ˆä¼šåœ¨å¯åŠ¨å®¹å™¨ä¸€æ®µæ—¶é—´åæ‰å¼€å§‹ç¬¬ä¸€æ¬¡çš„å°±ç»ªæ¢æµ‹ï¼Œä¹‹ååšå‘¨æœŸæ€§æ¢æµ‹ã€‚æ‰€ä»¥åœ¨å®šä¹‰å°±ç»ªæŒ‡é’ˆæ—¶ï¼Œä¼šç»™ä»¥ä¸‹å‡ ä¸ªå‚æ•°ï¼š
initialDelaySecondsï¼šåœ¨åˆå§‹åŒ–å®¹å™¨å¤šå°‘ç§’åå¼€å§‹ç¬¬ä¸€æ¬¡å°±ç»ªæ¢æµ‹ï¼› timeoutSecondsï¼šå¦‚æœè¯¥æ¬¡å°±ç»ªæ¢æµ‹è¶…è¿‡å¤šå°‘ç§’åè¿˜æœªæˆåŠŸï¼Œåˆ¤å®šä¸ºè¶…æ—¶ï¼Œè¯¥æ¬¡æ¢æµ‹å¤±è´¥ï¼ŒPodä¸å°±ç»ªã€‚é»˜è®¤å€¼1ï¼Œæœ€å°å€¼1ï¼› periodSecondsï¼šå¦‚æœPodæœªå°±ç»ªï¼Œåˆ™æ¯éš”å¤šå°‘ç§’å‘¨æœŸæ€§çš„åšå°±ç»ªæ¢æµ‹ã€‚é»˜è®¤å€¼10ï¼Œæœ€å°å€¼1ï¼› failureThresholdï¼šå¦‚æœå®¹å™¨ä¹‹å‰æ¢æµ‹æˆåŠŸï¼Œåç»­è¿ç»­å‡ æ¬¡æ¢æµ‹å¤±è´¥ï¼Œåˆ™ç¡®å®šå®¹å™¨æœªå°±ç»ªã€‚é»˜è®¤å€¼3ï¼Œæœ€å°å€¼1ï¼› successThresholdï¼šå¦‚æœå®¹å™¨ä¹‹å‰æ¢æµ‹å¤±è´¥ï¼Œåç»­è¿ç»­å‡ æ¬¡æ¢æµ‹æˆåŠŸï¼Œåˆ™ç¡®å®šå®¹å™¨å°±ç»ªã€‚é»˜è®¤å€¼1ï¼Œæœ€å°å€¼1ã€‚ ä½¿ç”¨ç¤ºä¾‹ # ç›®å‰æˆ‘åœ¨docker hubæœ‰ä¸€ä¸ªæµ‹è¯•é•œåƒï¼šponeding/helloweb:v1ï¼Œå®¹å™¨å¯åŠ¨åï¼Œæœ‰ä¸€ä¸ªå¥åº·æ£€æŸ¥è·¯ç”±/healthz/return200ï¼Œè®¿é—®è¯¥è·¯ç”±çŠ¶æ€ç è¿”å›200ï¼›æœ‰ä¸€ä¸ªæ£€æŸ¥è·¯ç”±/health/return404ï¼Œè®¿é—®è¯¥è·¯ç”±çŠ¶æ€ç è¿”å›404ã€‚</description></item><item><title/><link>https://blog.poneding.com/kubernetes/local-storageclass/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/local-storageclass/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / local å­˜å‚¨å·å®è·µ
local å­˜å‚¨å·å®è·µ # åœ¨ Kubernetes ä¸­æœ‰ä¸€ç§å­˜å‚¨å·ç±»å‹ä¸º localã€‚
local å·æ‰€ä»£è¡¨çš„æ˜¯æŸä¸ªè¢«æŒ‚è½½çš„æœ¬åœ°å­˜å‚¨è®¾å¤‡ï¼Œä¾‹å¦‚ç£ç›˜ã€åˆ†åŒºæˆ–è€…ç›®å½•ã€‚
local å·åªèƒ½ç”¨ä½œé™æ€åˆ›å»ºçš„æŒä¹…å·ã€‚ä¸æ”¯æŒåŠ¨æ€é…ç½®ã€‚
ä¸ hostPath å·ç›¸æ¯”ï¼Œlocal å·èƒ½å¤Ÿä»¥æŒä¹…å’Œå¯ç§»æ¤çš„æ–¹å¼ä½¿ç”¨ï¼Œè€Œæ— éœ€æ‰‹åŠ¨å°† Pod è°ƒåº¦åˆ°èŠ‚ç‚¹ã€‚ç³»ç»Ÿé€šè¿‡æŸ¥çœ‹ PersistentVolume çš„èŠ‚ç‚¹äº²å’Œæ€§é…ç½®ï¼Œå°±èƒ½äº†è§£å·çš„èŠ‚ç‚¹çº¦æŸã€‚
ç„¶è€Œï¼Œlocal å·ä»ç„¶å–å†³äºåº•å±‚èŠ‚ç‚¹çš„å¯ç”¨æ€§ï¼Œå¹¶ä¸é€‚åˆæ‰€æœ‰åº”ç”¨ç¨‹åºã€‚ å¦‚æœèŠ‚ç‚¹å˜å¾—ä¸å¥åº·ï¼Œé‚£ä¹ˆ local å·ä¹Ÿå°†å˜å¾—ä¸å¯è¢« Pod è®¿é—®ã€‚ä½¿ç”¨å®ƒçš„ Pod å°†ä¸èƒ½è¿è¡Œã€‚ ä½¿ç”¨ local å·çš„åº”ç”¨ç¨‹åºå¿…é¡»èƒ½å¤Ÿå®¹å¿è¿™ç§å¯ç”¨æ€§çš„é™ä½ï¼Œä»¥åŠå› åº•å±‚ç£ç›˜çš„è€ç”¨æ€§ç‰¹å¾è€Œå¸¦æ¥çš„æ½œåœ¨çš„æ•°æ®ä¸¢å¤±é£é™©ã€‚
åˆ›å»º local-storage å­˜å‚¨ç±» # apiVersion: storage.k8s.io/v1 kind: StorageClass metadata: name: local-storage provisioner: kubernetes.io/no-provisioner volumeBindingMode: WaitForFirstConsumer æ‰‹åŠ¨åˆ›å»º PV/PVC # 1ã€ä½¿ç”¨ local å·æ—¶ï¼Œä½ éœ€è¦è®¾ç½® PersistentVolume å¯¹è±¡çš„ nodeAffinity å­—æ®µã€‚ Kubernetes è°ƒåº¦ï¨¸ä½¿ç”¨ PersistentVolume çš„ nodeAffinity ä¿¡æ¯æ¥å°†ä½¿ç”¨ local å·çš„ Pod è°ƒåº¦åˆ°æ­£ç¡®çš„èŠ‚ç‚¹ï¼›</description></item><item><title/><link>https://blog.poneding.com/kubernetes/metallb/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/metallb/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 K8sè‡ªå»ºLoadBalancer
Kubernetes 0-1 K8sè‡ªå»ºLoadBalancer # Metallbä»‹ç» # ä¸€èˆ¬åªæœ‰äº‘å¹³å°æ”¯æŒLoadBalancerï¼Œå¦‚æœè„±ç¦»äº‘å¹³å°ï¼Œè‡ªå·±æ­å»ºçš„K8sé›†ç¾¤ï¼ŒServiceçš„ç±»å‹ä½¿ç”¨LoadBalanceræ˜¯æ²¡æœ‰ä»»ä½•æ•ˆæœçš„ã€‚ä¸ºäº†è®©ç§æœ‰ç½‘ç»œä¸­çš„K8sé›†ç¾¤ä¹Ÿèƒ½ä½“éªŒåˆ°LoadBalabcerï¼ŒMetallbæˆä¸ºäº†è§£å†³æ–¹æ¡ˆã€‚
Metallbè¿è¡Œåœ¨K8sé›†ç¾¤ä¸­ï¼Œç›‘è§†é›†ç¾¤å†…LoadBalancerç±»å‹çš„æœåŠ¡ï¼Œç„¶åä»é…ç½®çš„IPæ± ä¸­ä¸ºå…¶åˆ†é…ä¸€ä¸ªå¯ç”¨IPï¼Œä»¥ARP/NDPæˆ–BGPçš„æ–¹å¼å°†å…¶å¹¿æ’­å‡ºå»ï¼Œè¿™ä¸ªå¯ç”¨IPæˆä¸ºäº†LoadBalancerçš„Urlï¼Œå¯ä¾›é›†ç¾¤å¤–è®¿é—®ã€‚
Metallbæ­å»ºè¿‡ç¨‹ # åˆ›å»ºå‘½åç©ºé—´ metallb-systemï¼š
vim metallb-namespace.yaml å†™å…¥æ–‡ä»¶å†…å®¹ï¼š
apiVersion: v1 kind: Namespace metadata: name: metallb-system ä¸‹è½½metallb.yamlæ–‡ä»¶
wget https://raw.githubusercontent.com/metallb/metallb/v0.9.3/manifests/metallb.yaml -O metallb.yaml --no-check-certificate å®šä¹‰LoadBalancerçš„IPæ± ï¼Œå…ˆåˆ›å»ºconfigmap
vim metallb-configMap.yaml å†™å…¥æ–‡ä»¶å†…å®¹ï¼š
apiVersion: v1 kind: ConfigMap metadata: namespace: metallb-system name: config data: config: | address-pools: - name: default protocol: layer2 addresses: - 192.168.115.140-192.168.115.199 æ³¨æ„ï¼šIPæ± çš„ç½‘ç»œéœ€è¦å’ŒK8sé›†ç¾¤çš„IPå¤„äºåŒä¸€ç½‘æ®µï¼Œæˆ‘çš„K8sé›†ç¾¤ç½‘ç»œæ˜¯192.168.115.13xï¼Œè¿™é‡ŒIPæ± åˆ™æ˜¯ç»™åˆ°192.168.115.140-192.168.115.199çš„èŒƒå›´ã€‚
æ‰§è¡Œå‘½ä»¤ï¼š
kubectl apply -f metallb-namespace.yaml kubectl create secret generic -n metallb-system memberlist --from-literal=secretkey=&amp;#34;$(openssl rand -base64 128)&amp;#34; kubectl apply -f metallb.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/nfs-as-pvc/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/nfs-as-pvc/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / ä½¿ç”¨ nfs æŒä¹…åŒ–å­˜å‚¨
ä½¿ç”¨ nfs æŒä¹…åŒ–å­˜å‚¨ # ä¸€èˆ¬äº‘å¹³å°éƒ½ä¼šæä¾›äº‘å­˜å‚¨æœåŠ¡ï¼Œå¦‚ AWS EBS æœåŠ¡ï¼ŒK8s å¯ä»¥ç›´æ¥ä½¿ç”¨äº‘å­˜å‚¨æœåŠ¡åˆ›å»º PV å’Œ PVC ä½œä¸º Volume çš„å­˜å‚¨åç«¯ã€‚å‡è®¾ä½ æ²¡æœ‰ä½¿ç”¨åˆ°äº‘å­˜å‚¨ï¼Œé‚£ä¹ˆ NFS å¯èƒ½ä¼šé€‚åˆä½ ã€‚
NFSï¼ˆNetwork File Systemï¼‰ï¼Œç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œå…è®¸è®¡ç®—æœºä¹‹é—´å…±äº«å­˜å‚¨èµ„æºï¼Œè¿™é‡Œä¹Ÿå°±ä¸å…·ä½“ä»‹ç»äº†ã€‚
éƒ¨ç½² nfs # ä»¥ä¸‹å‘½ä»¤éœ€è¦rootæƒé™ï¼Œç¤ºä¾‹ä¸­æœºå™¨IPä¸º192.168.115.137ã€‚
å®‰è£… nfsï¼š # Ubuntu &amp;amp; Debian apt install nfs-kernel-server -y # CentOS yum install nfs-util -y åˆ›å»ºå…±äº«ç›®å½•ï¼š mkdir /nfs/data -p ä¿®æ”¹ nfs çš„é»˜è®¤é…ç½®ï¼Œåœ¨æ–‡æœ«æ·»åŠ é…ç½®ï¼š vim /etc/exports /nfs/data *(rw,sync,no_root_squash) å…¶ä¸­ï¼š
/nfs/dataï¼šå…±äº«ç›®å½• *ï¼šå¯¹æ‰€æœ‰å¼€æ”¾è®¿é—®ï¼Œå¯ä»¥é…ç½®æˆç½‘æ®µï¼ŒIPï¼ŒåŸŸåç­‰ rwï¼šè¯»å†™æƒé™ syncï¼šæ–‡ä»¶åŒæ—¶å†™å…¥ç£ç›˜å’Œå†…å­˜ no_root_squashï¼šå½“ç™»å½• NFS ä¸»æœºä½¿ç”¨å…±äº«ç›®å½•çš„ä½¿ç”¨è€…æ˜¯ root æ—¶ï¼Œå…¶æƒé™å°†è¢«è½¬æ¢æˆä¸ºåŒ¿åä½¿ç”¨è€…ï¼Œé€šå¸¸å®ƒçš„ UID ä¸ GIDï¼Œéƒ½ä¼šå˜æˆ nobody èº«ä»½ é‡å¯ rpcï¼Œnfs éœ€è¦å‘ rpc æ³¨å†Œï¼š systemctl restart rpcbind.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/pod-understood/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/pod-understood/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 äº†è§£ Pod
Kubernetes 0-1 äº†è§£ Pod # Pod ä»‹ç» # Podï¼Œæ˜¯ K8s å¯¹è±¡æ¨¡å‹ä¸­çš„æœ€å°å•å…ƒï¼ŒPod é‡Œé¢åŒ…å«ç€ä¸€ç»„å®¹å™¨ï¼ˆå•ä¸ªå®¹å™¨æˆ–å¤šä¸ªç´§å¯†è€¦åˆçš„å®¹å™¨ï¼‰ï¼Œè¿™æ—¶å€™ Pod å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæœºå™¨ï¼Œè€Œ Pod é‡Œé¢çš„å®¹å™¨åˆ™ç†è§£ä¸ºè¯¥æœºå™¨é‡Œé¢çš„è¿›ç¨‹ã€‚
Pod çš„å®¹å™¨è¿è¡Œæ—¶ç”±å®¹å™¨å¼•æ“æä¾›ï¼Œé»˜è®¤çš„å®¹å™¨å¼•æ“æ˜¯ Dockerï¼›å¹¶ä¸” K8s ç®¡ç†çš„æ˜¯ Podï¼Œè€Œä¸æ˜¯å®¹å™¨ã€‚
ä¸€ä¸ª Pod å†…éƒ¨çš„å®¹å™¨å…±äº«ï¼š
å­˜å‚¨ï¼šä¸€ä¸ª Pod å¯ä»¥æŒ‡å®šä¸€ç»„å…±äº«å­˜å‚¨å·ã€‚ ç½‘ç»œï¼šæ¯ä¸ª Pod åˆ†é…ä¸€ä¸ªå”¯ä¸€ IPï¼ˆé›†ç¾¤å†… IPï¼‰ï¼Œå…±äº«ç½‘ç»œå‘½åç©ºé—´ï¼ŒåŒ…æ‹¬ IP åœ°å€å’Œç½‘ç»œç«¯å£ã€‚Pod å†…çš„å®¹å™¨å¯ä»¥ä½¿ç”¨ localhost äº’ç›¸é€šä¿¡ï¼Œé›†ç¾¤å†… Pod ä¸ Podé€šä¿¡å¯ä»¥ä½¿ç”¨ Pod åˆ†é…çš„ IPï¼Œä½†æ˜¯ç”±äº Pod çš„ IP æ˜¯éšæœºåˆ†é…çš„ï¼Œè¿™ç§äº’é€šä¿¡çš„æ–¹å¼ä¸å¤ªé€‚åˆä½¿ç”¨ã€‚ å°½ç®¡ä¸€ä¸ª Pod å†…å¯ä»¥åŒ…å«å¤šä¸ª Podï¼Œä½†æˆ‘ä»¬åœ¨éƒ¨ç½²åº”ç”¨å®¹å™¨æ—¶çš„æœ€ä½³å®è·µæ˜¯ä¸€ä¸ª Pod é‡Œé¢åªåŒ…å«ä¸€ä¸ªåº”ç”¨å®¹å™¨ä½œä¸ºä¸»å®¹å™¨ï¼Œå…¶ä»–å®¹å™¨ä¸ºä¸»å®¹å™¨æœåŠ¡ï¼Œç§°ä¹‹ä¸ºè¾…åŠ©å®¹å™¨ã€‚ä¾‹å¦‚ä¸»å®¹å™¨å´©æºƒäº†ï¼Œä¼šæœ‰ä¸€ä¸ªè¾…åŠ©å®¹å™¨å»é‡å¯ä¸»å®¹å™¨ã€‚è¾…åŠ©å®¹å™¨å¯ä»¥æœ‰ä¹Ÿå¯ä»¥æ²¡æœ‰ï¼Œå› ä¸º Pod é‡Œé¢å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥è¢« Pod çš„ç”Ÿå‘½å‘¨æœŸå–ä»£ï¼Œè€Œ Pod çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥é€šè¿‡ Pod ç®¡ç†å™¨æ¥ç®¡ç†ç»´æŠ¤ã€‚</description></item><item><title/><link>https://blog.poneding.com/kubernetes/prgramming-kubernetes/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/prgramming-kubernetes/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes ç¼–ç¨‹
Kubernetes ç¼–ç¨‹ # å¼€å§‹ Kuberntes ç¼–ç¨‹ä¹‹æ—…ï½
mkdir programming-kubernetes &amp;amp;&amp;amp; cd programming-kubernetes git mod init programming-kubernetes å¸¸ç”¨åŒ…ï¼š
kubeconfig å¯¹åº”çš„ç»“æ„ clientcmdapi &amp;#34;k8s.io/client-go/tools/clientcmd/api&amp;#34; clientcmdapi.Config ç¼–å†™è‡ªå®šä¹‰ API # éšæœºç”Ÿæˆå­—ç¬¦ &amp;#34;k8s.io/apimachinery/pkg/util/rand&amp;#34; rand.String(5) å‚è€ƒï¼š
kubernetes/code-generator: Generators for kube-like API types (github.com)
code-generator ä½¿ç”¨
Bç«™ code-generator ä»‹ç»
mkdir hack vim hack/boilerplate.go.txt /* Copyright 2022 programming-kubernetes. Licensed under the Apache License, Version 2.0 (the &amp;#34;License&amp;#34;); you may not use this file except in compliance with the License.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/prometheus-collect-kong-metrics/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/prometheus-collect-kong-metrics/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Prometheus-ç›‘æ§Kongå®Œæ•´æ“ä½œ
Prometheus-ç›‘æ§Kongå®Œæ•´æ“ä½œ # æœ¬ç¯‡è®°å½•ä½¿ç”¨Prometheusæ”¶é›†Kongæš´éœ²çš„/metricsæ¥å£ï¼Œæ”¶é›†æŒ‡æ ‡æ•°æ®ï¼Œä»è€Œå®ç°å¯¹Kongçš„ç›‘æ§ã€‚
å…ˆå†³æ¡ä»¶ # Prometheuséƒ¨ç½²å®Œæˆï¼› Kongï¼ˆKong æœåŠ¡ï¼Œç«¯å£8000ï¼‰éƒ¨ç½²å®Œæˆï¼› Kong çš„Admin Apiï¼ˆç«¯å£8001ï¼‰éƒ¨ç½²å®Œæˆ Kongaï¼ˆKongçš„WebUIï¼Œç«¯å£1337ï¼‰éƒ¨ç½²å®Œæˆã€‚ Kongæ·»åŠ Prometheusæ’ä»¶ # ç™»å½•è¿›å…¥Kongaï¼› ç‚¹å‡»å³è¾¹èœå•æ â€PLUGINSâ€œï¼Œè¿›å…¥Pluginsç®¡ç†ï¼Œç‚¹å‡»â€œAnalytics &amp;amp; Monitoringâ€ï¼Œé€‰æ‹©æ·»åŠ Promethusæ’ä»¶ Kongæ·»åŠ metricsæ¥å£ # æˆ‘ä»¬çŸ¥é“Prometheusä¸»è¦é€šè¿‡è¯»å– http://host/metricsæ¥å£, æ¥æ”¶é›†ç›¸å…³æœåŠ¡çš„æ€§èƒ½æ•°æ®ï¼Œä½†æ˜¯Kongçš„metricsæ¥å£æœåŠ¡é»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆä¸ºKongæ·»åŠ /metricsã€‚
ç™»å½•è¿›å…¥Kongaï¼› ç‚¹å‡»å³è¾¹èœå•æ â€SERVICESâ€œï¼Œè¿›å…¥Servicesç®¡ç†ï¼Œç‚¹å‡»â€œADD NEW SERVICEâ€ æ·»åŠ é¡µé¢è¾“å…¥â€œNameâ€å’Œâ€œUrlâ€å‚æ•°å³å¯ï¼Œä¾‹å¦‚â€œNameâ€=â€œprometheusServiceâ€ï¼Œâ€œUrlâ€=â€œ http://localhost:8001/metricsâ€ æ·»åŠ å®ŒPrometheus Serviceä¹‹åï¼ŒServiceåˆ—è¡¨é€‰ä¸­å¹¶ç‚¹å‡»è¿›å…¥prometheusServiceï¼Œé€‰æ‹©â€Routesâ€œèœå•ï¼Œç‚¹å‡»â€œADD ROUTEâ€ æ·»åŠ é¡µé¢è¾“å…¥â€œPathsâ€å‚æ•°å³å¯ï¼Œä¾‹å¦‚â€œPathsâ€=[â€œ/metricsâ€]ï¼ˆPathå¿…é¡»ä»¥â€œ/â€ä¸ºé¦–ï¼‰ è¿™æ—¶å€™è®¿é—®â€œ http://localhost:8000/metricsâ€ï¼Œçœ‹åˆ°é¡µé¢å¦‚ä¸‹æ˜¾ç¤ºï¼Œè¯´æ˜å·²ç»æˆåŠŸçš„æ·»åŠ äº†metricsæ¥å£ Prometheusæ·»åŠ KongæŒ‡æ ‡æ”¶é›† # ä¿®æ”¹Prometheusé…ç½®æ–‡ä»¶ï¼Œprometheus.yml
scrape_configsé…ç½®é¡¹ä¸‹æ·»åŠ å¦‚ä¸‹é…ç½®
- job_name: &amp;#39;kong&amp;#39; scrape_interval: 5s static_configs: - targets: [&amp;#39;localhost:8000&amp;#39;] é…ç½®å®Œä¹‹åé‡å¯Prometheusï¼Œè®¿é—®â€œ http://localhost:9090/graphâ€
å¯ä»¥çœ‹åˆ°ä¸€å·²ç»ç”Ÿæˆäº†å¾ˆå¤škongçš„æŒ‡æ ‡é¡¹ï¼Œå¦‚httpè®¿é—®ï¼Œnginxå½“å‰è®¿é—®é‡ç­‰æŒ‡æ ‡
Â« Kubernetes ç¼–ç¨‹
Â» Prometheus</description></item><item><title/><link>https://blog.poneding.com/kubernetes/prometheus/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/prometheus/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Prometheus
Prometheus # Intro # æ˜¯ä¸€ä¸ªé¢å‘äº‘åŸç”Ÿåº”ç”¨ç¨‹åºçš„å¼€æºçš„ç›‘æ§&amp;amp;æŠ¥è­¦å·¥å…·ã€‚
å¼€æºï¼šç»§Kubernetesä¹‹åçš„ç¬¬äºŒä¸ªCNCFå¼€æºé¡¹ç›®ï¼ŒGoè¯­è¨€å¼€å‘ ç›‘æ§ï¼šé€šè¿‡HTTPæœåŠ¡å®šæ—¶ä»é…ç½®çš„ç›®æ ‡æ”¶é›†æŒ‡æ ‡æ•°æ®ï¼Œè¯†åˆ«æ•°æ®å±•ç¤ºè§„åˆ™ï¼Œå±•ç¤ºç›‘æ§ç³»ç»Ÿå’ŒæœåŠ¡æŒ‡æ ‡æ•°æ® æŠ¥è­¦ï¼šç›‘æ§åˆ°çš„æŒ‡æ ‡æ•°æ®è¾¾åˆ°æŸä¸€è®¾å®šå¥½çš„æ¡ä»¶æ—¶ï¼Œè§¦å‘æŠ¥è­¦æœºåˆ¶ æ—¶é—´åºåˆ—æ•°æ®åº“ï¼š æ—¶é—´åºåˆ—æ˜¯ç”±å”¯ä¸€çš„æŒ‡æ ‡åç§°ï¼ˆMetricsï¼‰å’Œä¸€ç»„æ ‡ç­¾ï¼ˆkey=valueï¼‰çš„å½¢å¼ç»„æˆ PromeQLï¼šåŸºäºPrometheusæ—¶é—´åºåˆ—æ•°æ®åº“çš„ä¸€ä¸ªçµæ´»çš„æŸ¥è¯¢è¯­è¨€ Prometheusçš„ç›‘æ§å¯¹è±¡ # èµ„æºç›‘æ§ï¼š
æœåŠ¡å™¨çš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œåœ¨Kubernetesé›†ç¾¤ä¸­ï¼Œåˆ™å¯ä»¥åšåˆ°å¯¹Kubernetes Nodeã€ Deployment ã€Podçš„èµ„æºåˆ©ç”¨ä»¥åŠapiserverï¼Œcontroller-managerï¼Œetcdç­‰ç»„ä»¶çš„ç›‘æ§ã€‚
åº”ç”¨ç›‘æ§ï¼š
ä¸šåŠ¡åº”ç”¨æš´éœ²ç«¯å£ä¾›Prometheusè°ƒç”¨å®ç°ç›‘æµ‹ï¼Œæ¯”å¦‚å®æ—¶çš„ç”¨æˆ·åœ¨çº¿äººæ•°ï¼Œæ•°æ®åº“çš„å½“å‰è¿æ¥æ•°ç­‰ã€‚
Prometheusä¼˜åŠ¿ # æ”¯æŒæœºå™¨èµ„æºå’ŒåŠ¨æ€é…ç½®çš„åº”ç”¨ç›‘æ§ï¼› å¤šç»´æ•°æ®æ”¶é›†å’ŒæŸ¥è¯¢ï¼› æœåŠ¡ç‹¬ç«‹ï¼Œå°‘ä¾èµ–ã€‚ Prometheusç»„ä»¶ # Prometheus Serverï¼šé‡‡é›†ç›‘æ§æ•°æ®ï¼Œå­˜å‚¨æ—¶åºæŒ‡æ ‡ï¼Œæä¾›æ•°æ®æŸ¥è¯¢ï¼› Prometheus Client SDKï¼šå¯¹æ¥å¼€å‘å·¥å…·åŒ…ï¼Œæä¾›è‡ªå®šä¹‰çš„æŒ‡æ ‡æ•°æ®ç­‰ï¼› Push Gatewayï¼šæ¨é€æŒ‡æ ‡æ•°æ®çš„ç½‘å…³ç»„ä»¶ï¼› Third-part Exporterï¼šå¤–éƒ¨æŒ‡æ ‡é‡‡é›†ç³»ç»Ÿï¼Œæš´éœ²æ¥å£ä¾›Prometheusé‡‡é›†ï¼› AlertManagerï¼šæŒ‡æ ‡æ•°æ®çš„åˆ†æå‘Šè­¦ç®¡ç†å™¨ï¼› Architecture overview # ä¸Šå›¾æ¥æºäºå®˜ç½‘ï¼š
å¤„ç†æµç¨‹ï¼š é…ç½®èµ„æºç›®æ ‡æˆ–åº”ç”¨æŠ“å–ï¼› æŠ“å–èµ„æºæˆ–åº”ç”¨æŒ‡æ ‡æ•°æ®ï¼› åˆ¶å®šæŠ¥è­¦è§„åˆ™ï¼Œæ¨é€æŠ¥è­¦ï¼› çµæ´»æŸ¥è¯¢è¯­è¨€ï¼Œç»“åˆGrafanaå±•ç¤º Installation &amp;amp; Start Up # 1. ä»¥æœåŠ¡è¿›ç¨‹è¿è¡ŒPrometheus # â€‹ åœ¨ubuntuç³»ç»Ÿä¸Šå®‰è£…Prometheusï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼
ç¬¬ä¸€ç§ï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š
wget https://github.com/prometheus/prometheus/releases/download/v2.13.1/prometheus-2.13.1.linux-amd64.tar.gz tar xvfz prometheus-2.13.1.linux-amd64.tar.gz # å¯åŠ¨Prometheus cd prometheus-2.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/pvc-expansion/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/pvc-expansion/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / PVC æ‰©å®¹
PVC æ‰©å®¹ # K8s éƒ¨ç½²çš„ Kafka ç¨‹åºçªç„¶æŒ‚äº†ï¼ŒæŸ¥çœ‹ç›¸å…³æ—¥å¿—å‘ç°åŸæ¥æ˜¯æŒ‚æ—¥å¿—çš„ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œé‚£ä¹ˆç°åœ¨éœ€è¦å¯¹ç£ç›˜è¿›è¡Œæ‰©å®¹ã€‚
ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œ PVC æ‰©å®¹çš„æ“ä½œï¼š
kubectl edit pvc &amp;lt;pvc-name&amp;gt; -n &amp;lt;namespace&amp;gt; æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç°ï¼Œæ— æ³•å¯¹è¯¥ PVC è¿›è¡ŒåŠ¨æ€æ‰©å®¹ï¼Œéœ€è¦åˆ†é… PVC å­˜å‚¨çš„ StorageClass æ”¯æŒåŠ¨æ€æ‰©å®¹ã€‚
é‚£ä¹ˆæ€ä¹ˆæ˜¯çš„ StorageClass æ”¯æŒåŠ¨æ€æ‰©å®¹å‘¢ï¼Œå¾ˆç®€å•ï¼Œæ›´æ–° StorageClass å³å¯ã€‚
kubectl edit storageclass &amp;lt;storageclass-name&amp;gt; æ·»åŠ å±æ€§ï¼š
allowVolumeExpansion: true # å…è®¸å·æ‰©å…… ä¹‹åå†æ¬¡æ‰§è¡Œ PVC æ‰©å®¹çš„æ“ä½œå³å¯ã€‚
Â« Prometheus
Â» äº†è§£ Secret</description></item><item><title/><link>https://blog.poneding.com/kubernetes/secret-understood/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/secret-understood/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / äº†è§£ Secret
äº†è§£ Secret # é€šå¸¸æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„é…ç½®éƒ½ä¼šåŒ…å«ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œè¯ä¹¦ï¼Œç§é’¥ç­‰ï¼Œä¸ºäº†ä¿è¯å…¶å®‰å…¨æ€§ï¼ŒK8s æä¾›äº† Secret èµ„æºå¯¹è±¡æ¥ä¿å­˜æ•æ„Ÿæ•°æ®ï¼Œå®ƒå’Œ CongfigMap ç±»ä¼¼ï¼Œä¹Ÿæ˜¯é”®å€¼å¯¹çš„æ˜ å°„ï¼Œå¹¶ä¸”ä½¿ç”¨æ–¹å¼ä¹Ÿå‡ ä¹ä¸€æ ·ã€‚
ä»‹ç» Secret # Secret ä¸­å­˜å‚¨ç€é”®å€¼å¯¹æ•°æ®ï¼Œå¯ä»¥
ä½œä¸ºç¯å¢ƒå˜é‡ä¼ é€’ç»™å®¹å™¨ ä½œä¸ºæ–‡ä»¶æŒ‚è½½åˆ°å®¹å™¨çš„ Volume Secret ä¼šå­˜å‚¨åœ¨ Pod æ‰€è°ƒåº¦çš„èŠ‚ç‚¹çš„å†…å­˜ä¸­ï¼Œè€Œä¸æ˜¯å†™å…¥ç£ç›˜ã€‚
Pod é»˜è®¤ç”Ÿæˆçš„ Secret # æ¯ä¸ª Pod éƒ½ä¼šè¢«è‡ªåŠ¨æŒ‚è½½ä¸€ä¸ª Secret å·ï¼Œåªéœ€è¦ä½¿ç”¨ kubectl desribe pod å‘½ä»¤å°±èƒ½çœ‹åˆ°ä¸€ä¸ªåç§°ç±»ä¼¼ default-token-n4q6m çš„ Secretï¼ŒSecret ä¹Ÿæ˜¯ä¸€ç§ K8s èµ„æºï¼Œæ‰€ä»¥ï¼Œå¯ä»¥ä½¿ç”¨ kubectl get secret æˆ– kubectl describe secret è·å–æŸ¥çœ‹ã€‚
ä»ä¸Šé¢å›¾ä¾‹å¯ä»¥çœ‹å‡ºï¼ŒPod é»˜è®¤ç”Ÿæˆçš„ Secret ä¼šåŒ…å«ä¸‰ä¸ªé…ç½®é¡¹ï¼šca.crtã€namespaceã€tokenã€‚å…¶å®è¿™ä¸‰ä¸ªé…ç½®é¡¹æ˜¯ Pod å†…éƒ¨å®‰å…¨è®¿é—®Kubernetes API æœåŠ¡çš„æ‰€æœ‰ä¿¡æ¯ï¼Œè€Œåœ¨ kubectl describe pod çš„æ—¶å€™ï¼Œä½ å¯ä»¥çœ‹åˆ° Secret æ‰€æŒ‚è½½çš„å…·ä½“ç›®å½•åœ¨ /var/run/secrets/kubernetes.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/service-understood/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/service-understood/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / äº†è§£ Service
äº†è§£ Service # Service ä»‹ç» # æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„è¯´æ³•ï¼Œåœ¨ K8s ä¸­ï¼ŒService æ˜¯å°†è¿è¡Œåœ¨é›†ç¾¤ä¸­çš„ä¸€ç»„ Pod çš„åº”ç”¨å…¬å¼€ä¸ºç½‘ç»œæœåŠ¡çš„æŠ½è±¡æ–¹æ³•ï¼Œæ˜¯ K8s çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ï¼ŒService çš„ä¸»è¦ä½œç”¨æ˜¯ä½¿å®¢æˆ·ç«¯å‘ç° Pod å¹¶ä¸ä¹‹é€šä¿¡ã€‚
ç®€å•ç†è§£èµ·æ¥å°±æ˜¯ï¼Œç”± Service æä¾›ç»Ÿä¸€çš„å…¥å£åœ°å€ï¼Œç„¶åå°†è¯·æ±‚è´Ÿè½½åˆ†å‘åˆ°åç«¯ Pod çš„å®¹å™¨åº”ç”¨ã€‚
ä¸ºä»€ä¹ˆæœ‰ Service # é›†ç¾¤ä¸­éƒ¨ç½²äº† Podï¼Œåº”ç”¨æ˜¯æˆåŠŸçš„éƒ¨ç½²èµ·æ¥äº†ï¼Œä½†æ˜¯åªæ˜¯è‡³æ­¤çš„è¯ï¼ŒPod æä¾›æœåŠ¡è®¿é—®å­˜åœ¨ä»¥ä¸‹ä¸€äº›é—®é¢˜ã€‚
Pod æ˜¯çŸ­æš‚çš„ï¼Œå¯èƒ½ä¼šè¢«é”€æ¯æˆ–é‡æ–°è°ƒåº¦ï¼Œè¿™ä½¿å¾— Pod çš„ IP æ˜¯éšæ—¶å˜åŠ¨å’Œæ›´æ–°çš„ï¼› éƒ¨ç½²å¤šä¸ª Pod çš„ä¼¸ç¼©é—®é¢˜ï¼Œæµé‡åˆ†é…é—®é¢˜ï¼› é›†ç¾¤å¤–éƒ¨å®¢æˆ·ç«¯æ— æ³•ç›´æ¥è®¿é—® Podã€‚ è¿™æ—¶å€™å°±éœ€è¦ Serviceï¼ŒPod ä½œä¸º Service çš„åç«¯æä¾›æœåŠ¡ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼ŒService éœ€è¦å®Œæˆçš„äº‹æƒ…ï¼š
æœåŠ¡å‘ç°ï¼Œé€šè¿‡ Pod çš„ lable æŸ¥æ‰¾ç›®æ ‡ Podï¼Œå°†æŸ¥æ‰¾çš„ Pod çš„æ³¨å†Œåˆ°è‡ªå·±çš„åç«¯åˆ—è¡¨ï¼ŒPod çš„ IP ä¿¡æ¯å‘ç”Ÿæ›´æ”¹ï¼Œåç«¯åˆ—è¡¨ä¹ŸåŒæ­¥æ›´æ–°ï¼› è´Ÿè½½å‡è¡¡ï¼Œè¯·æ±‚åˆ°è¾¾ Service ä¹‹åï¼Œå°†è¯·æ±‚å‡è¡¡è½¬å‘çš„åç«¯åˆ—è¡¨ï¼› æœåŠ¡æš´éœ²ï¼šå¯¹å¤–æä¾›ç»Ÿä¸€çš„è¯·æ±‚åœ°å€ã€‚ åˆ›å»º Service # åœ¨åˆ›å»º Sercvice ä¹‹å‰æˆ‘ä»¬é¦–å…ˆåˆ›å»º service ä»£ç†çš„ Podï¼Œnginx-pod.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/telepresence/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/telepresence/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Telepresence
Telepresence # Telepresenceæ˜¯ä¸€æ¬¾
Â« äº†è§£ Service
Â» Kubernetes 0-1 ä½¿ç”¨preStopä¼˜é›…ç»ˆæ­¢Pod</description></item><item><title/><link>https://blog.poneding.com/kubernetes/terminate-pod-gracefully/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/terminate-pod-gracefully/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Kubernetes 0-1 ä½¿ç”¨preStopä¼˜é›…ç»ˆæ­¢Pod
Kubernetes 0-1 ä½¿ç”¨preStopä¼˜é›…ç»ˆæ­¢Pod # Kuberneteså…è®¸Podç»ˆæ­¢ä¹‹å‰ï¼Œæ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚
å­—æ®µå®šä¹‰ # å­—æ®µå®šä¹‰ï¼špod.spec.containers.lifecycle.preStop
$ kubectl explain pod.spec.containers.lifecycle.preStop KIND: Pod VERSION: v1 RESOURCE: preStop &amp;lt;Object&amp;gt; DESCRIPTION: PreStop is called immediately before a container is terminated due to an API request or management event such as liveness/startup probe failure, preemption, resource contention, etc. The handler is not called if the container crashes or exits. The reason for termination is passed to the handler.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/terraform/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/terraform/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Terraform
Terraform # åˆ›å»ºec2åŒæ—¶å®‰è£…åº”ç”¨çš„ä¸‰ç§æ–¹å¼ # Mode 1: userdata # éœ€è¦shellè„šæœ¬æ–‡ä»¶install_nginx.sh resource &amp;#34;aws_instance&amp;#34; &amp;#34;demo&amp;#34; { # ... # Mode 1: userdata user_data = &amp;#34;${file(&amp;#34;../templates/install_nginx.sh&amp;#34;)}&amp;#34; # ... } Mode 2: remote-exec # éœ€è¦è¿æ¥ä¸»æœºï¼Œconnection; å¯†é’¥æ–‡ä»¶xxx.pem resource &amp;#34;aws_instance&amp;#34; &amp;#34;demo&amp;#34; { # ... # Mode 2: remote-exec connection { host = &amp;#34;${self.private_ip}&amp;#34; private_key = &amp;#34;${file(&amp;#34;xxx.pem&amp;#34;)}&amp;#34; user = &amp;#34;${var.ansible_user}&amp;#34; } provisioner &amp;#34;remote-exec&amp;#34; { inline = [ &amp;#34;sudo apt-get update&amp;#34;, &amp;#34;sudo apt-get install -y nginx&amp;#34;, &amp;#34;sudo service nginx start&amp;#34; ] } # .</description></item><item><title/><link>https://blog.poneding.com/kubernetes/velero-minio-backup-restore-volume/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/velero-minio-backup-restore-volume/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / Velero + Minio å¤‡ä»½ä¸æ¢å¤
Velero + Minio å¤‡ä»½ä¸æ¢å¤ # å®‰è£… Minio # docker run -d --name minio \\ -p 9000:9000 \\ -p 9001:9001 \\ -e MINIO_ROOT_USER=minio \\ -e MINIO_ROOT_PASSWORD=minio \\ -v /minio-data:/data \\ quay.io/minio/minio:latest server /data --console-address &amp;#34;:9001&amp;#34; åˆ›å»º Bucket # è®¾ç½® Region # ç‚¹å‡»ä¿å­˜åï¼Œä¼šå‡ºç°ä¸€ä¸ªæ¨ªå¹…ï¼Œç‚¹å‡»æ¨ªå¹…ä¸Šçš„ Restart å³å¯ã€‚
åˆ›å»º AccessKey # ä¿å­˜ AccessKey å’Œ SecretKey åˆ°æ–‡ä»¶ credentials-veleroï¼š
[default] aws_access_key_id = &amp;lt;access_key&amp;gt; aws_secret_access_key = &amp;lt;secret_key&amp;gt; å®‰è£… Velero CLI # # linux wget &amp;lt;https://github.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/volume-understood/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/volume-understood/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / äº†è§£ Volume
äº†è§£ Volume # æˆ‘ä»¬çŸ¥é“å®¹å™¨ä¸å®¹å™¨ä¹‹é—´æ˜¯éš”ç¦»çš„ï¼Œæœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚å¹¶ä¸”å­˜å‚¨çš„æ–‡ä»¶æ€§è´¨æ—¶ä¸´æ—¶çš„ï¼Œå½“å®¹å™¨è¢«é”€æ¯æ—¶ï¼Œå®¹å™¨å†…çš„æ–‡ä»¶ä¸€å¹¶è¢«æ¸…é™¤ã€‚
åœ¨ Pod å†…å¯èƒ½è¿è¡Œç€å¤šä¸ªå®¹å™¨ï¼Œè¿™å¯èƒ½éœ€è¦å®¹å™¨å…±äº«æ–‡ä»¶ã€‚åœ¨ K8s ä¸­ï¼ŒæŠ½è±¡é™¤äº† Volume çš„æ¦‚å¿µæ¥æ»¡è¶³è¿™ç§éœ€æ±‚ã€‚
Volume ä»‹ç» # åœ¨ Docker ä¸­ï¼Œä¹Ÿæœ‰ Volume çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å°†å®¹å™¨å†…æŸæ–‡ä»¶ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºçš„ç›®å½•ã€‚
åœ¨ K8s ä¸­ï¼ŒVolume ä¾› Pod å†…çš„å®¹å™¨ä½¿ç”¨ï¼Œä¸€ä¸ªå®¹å™¨å¯ä»¥ä½¿ç”¨å¤šä¸ª Volumeï¼ŒåŒä¸€ Pod å†…çš„å¤šä¸ªå®¹å™¨å¯ä»¥åŒæ—¶ä½¿ç”¨ä¸€ä¸ª Volumeï¼Œå®ç°æ–‡ä»¶å…±äº«ï¼Œæˆ–æ•°æ®æŒä¹…å­˜å‚¨ã€‚
å®¹å™¨ä¸ Volume çš„ç®€å•å…³ç³»ï¼š
Volume å®šä¹‰ # å®šä¹‰åœ¨ pod.spec.container å±æ€§ä¸‹ï¼š
kind: Pod ... spec: container: ... volumeMounts: - mountPath: &amp;lt;path&amp;gt; name: &amp;lt;volume-name&amp;gt; subPath: &amp;lt;volume-path&amp;gt; volumes: - name: &amp;lt;volume-name&amp;gt; &amp;lt;volume-type&amp;gt;: ... mountPathï¼š å®¹å™¨å†…çš„ç›®å½•ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºè¯¥ç›®å½• subPathï¼šé»˜è®¤ä¼šå°† mountPath ç›´æ¥æ˜ å°„åˆ° volume çš„æ ¹ç›®å½•ï¼Œä½¿ç”¨ subpath æ˜ å°„åˆ° volume ç‰¹å®šçš„ç›®å½•ã€‚ Volume ç±»å‹ # Volume æœ‰å¤šç§ç±»å‹ï¼Œæœ‰çš„å¯ä»¥ç›´æ¥åœ¨é›†ç¾¤ä¸­ä½¿ç”¨ï¼Œæœ‰çš„åˆ™éœ€è¦ç¬¬ä¸‰æ–¹æœåŠ¡æˆ–äº‘å¹³å°çš„æ”¯æŒã€‚ç®€å•ç½—åˆ—å‡ ç§å¸¸è§ç±»å‹ï¼Œæ›´å¤šäº†ç±»å‹å‚è€ƒï¼š https://kubernetes.</description></item><item><title/><link>https://blog.poneding.com/kubernetes/vpa/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/kubernetes/vpa/</guid><description>ğŸ  é¦–é¡µ / Kubernetes / VPA
VPA # å®‰è£… # git clone https://github.com/kubernetes/autoscaler.git cd ./autoscaler/vertical-pod-autoscaler ./hack/vpa-up.sh å¸è½½ï¼š
./hack/vpa-down.sh VPAè¿è¡Œæ¨¡å¼ # Autoï¼ˆé»˜è®¤æ¨¡å¼ï¼‰ï¼šVPAåœ¨podåˆ›å»ºæ—¶åˆ†é…èµ„æºè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨é¦–é€‰çš„æ›´æ–°æœºåˆ¶åœ¨ç°æœ‰çš„podä¸Šæ›´æ–°å®ƒä»¬ã€‚ç›®å‰ï¼Œè¿™ç›¸å½“äºâ€œé‡å»ºâ€(è§ä¸‹æ–‡)ã€‚ä¸€æ—¦podè¯·æ±‚çš„å…è´¹é‡å¯(â€œåŸä½â€)æ›´æ–°å¯ç”¨ï¼Œå®ƒå°±å¯ä»¥è¢«â€œAutoâ€æ¨¡å¼ç”¨ä½œé¦–é€‰çš„æ›´æ–°æœºåˆ¶ã€‚æ³¨æ„:VPAçš„è¿™ä¸ªç‰¹æ€§æ˜¯å®éªŒæ€§çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„åº”ç”¨ç¨‹åºåœæœºã€‚
Recreateï¼šVPAåœ¨podåˆ›å»ºæ—¶åˆ†é…èµ„æºè¯·æ±‚ï¼Œå¹¶åœ¨ç°æœ‰podä¸Šæ›´æ–°å®ƒä»¬ï¼Œå½“è¯·æ±‚çš„èµ„æºä¸æ–°å»ºè®®æœ‰æ˜¾è‘—å·®å¼‚æ—¶(å¦‚æœå®šä¹‰äº†podä¸­æ–­é¢„ç®—ï¼Œåˆ™è€ƒè™‘åˆ°å®ƒä»¬)ï¼Œå°†å®ƒä»¬èµ¶å‡ºç°æœ‰podã€‚è¿™ç§æ¨¡å¼åº”è¯¥å¾ˆå°‘ä½¿ç”¨ï¼Œåªæœ‰å½“æ‚¨éœ€è¦ç¡®ä¿åœ¨èµ„æºè¯·æ±‚æ›´æ”¹æ—¶é‡æ–°å¯åŠ¨podsæ—¶æ‰ä¼šä½¿ç”¨ã€‚å¦åˆ™æ›´å–œæ¬¢â€œè‡ªåŠ¨â€æ¨¡å¼ï¼Œè¿™å¯èƒ½ä¼šåˆ©ç”¨é‡æ–°å¯åŠ¨å…è´¹æ›´æ–°ï¼Œä¸€æ—¦ä»–ä»¬å¯ç”¨ã€‚æ³¨æ„:VPAçš„è¿™ä¸ªç‰¹æ€§æ˜¯å®éªŒæ€§çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„åº”ç”¨ç¨‹åºåœæœºã€‚
Initialï¼šVPAåªåœ¨podåˆ›å»ºæ—¶åˆ†é…èµ„æºè¯·æ±‚ï¼Œä»¥åä¸ä¼šæ›´æ”¹å®ƒä»¬ã€‚
Offï¼šVPAä¸ä¼šè‡ªåŠ¨æ›´æ”¹podsçš„èµ„æºéœ€æ±‚ã€‚è®¡ç®—å¹¶å¯ä»¥åœ¨VPAå¯¹è±¡ä¸­æ£€æŸ¥å»ºè®®ã€‚
ç¤ºä¾‹ # Â« äº†è§£ Volume</description></item><item><title/><link>https://blog.poneding.com/linux/certbot-auto-gen-cert/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/certbot-auto-gen-cert/</guid><description>ğŸ  é¦–é¡µ / Linux / certbot-auto ç”Ÿæˆè¯ä¹¦
certbot-auto ç”Ÿæˆè¯ä¹¦ # å®‰è£… # wget https://dl.eff.org/certbot-auto chmod a+x ./certbot-auto cp ./certbot-auto /usr/local/bin ç”Ÿæˆè¯ä¹¦ # æ¡ä»¶ï¼š
æå‰å·²ç»å°†åŸŸåè§£æåˆ°æœ¬æœåŠ¡å™¨ï¼› æœ¬æœåŠ¡å™¨ç«¯å£ 80ã€443 å¤„äºæœªè¢«å ç”¨çš„çŠ¶æ€ï¼Œå¦‚æœ web æœåŠ¡å ç”¨äº† 80 ç«¯å£ï¼Œéœ€è¦ä¸´æ—¶å…³é—­ã€‚ certbot-auto certonly --standalone --email poneding@gmail.com -d test.poneding.com ä»¥ä¸Šå‘½ä»¤æ‰§è¡Œå®Œæˆåï¼Œå°†ä¼šåœ¨ /etc/letsencrypt/live ç›®å½•ä¸‹ç”ŸæˆåŸŸåè¯ä¹¦æ–‡ä»¶ã€‚é»˜è®¤è¯ä¹¦æœ‰æ•ˆæœŸä¸º 3 ä¸ªæœˆã€‚
nginx é…ç½®è¯ä¹¦ # å‚è€ƒç¤ºä¾‹ï¼š
server { listen 80; server_name abc.com; rewrite ^(.*) https://test.poneding.com permanent; } server{ listen 443 ssl default_server; listen [::]:443 ssl default_server; ssl_certificate /etc/letsencrypt/live/test.poneding.com/fullchain.pem; ssl_certificate_key /etc/letsencrypt/live/test.</description></item><item><title/><link>https://blog.poneding.com/linux/history-with-date/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/history-with-date/</guid><description>ğŸ  é¦–é¡µ / Linux / Linux-history è¾“å‡ºé™„å¸¦æ—¥æœŸ
Linux-history è¾“å‡ºé™„å¸¦æ—¥æœŸ # å¦‚æœæˆ‘ä»¬åœ¨ linux ç³»ç»Ÿä¸­æƒ³çœ‹å†å²çš„å‘½ä»¤è®°å½•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ command å‘½ä»¤æ¥è·å–ã€‚
history è¾“å‡ºå¤§æ¦‚ä¼šæ˜¯ä¸‹é¢è¿™ç§æ ·å­ï¼Œåªæœ‰ç®€å•çš„ command åˆ—è¡¨ã€‚
1 ls 2 top 4 docker ps 5 df 6 ls é‚£ä¹ˆï¼Œå¦‚æœæƒ³çŸ¥é“å†å²æ‰§è¡Œçš„ command çš„æ—¶é—´è¯¥æ€ä¹ˆåšå‘¢ã€‚
æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤ï¼Œä¸€æ­¥ä¸€æ­¥æ¥ã€‚
é¦–å…ˆè®¾ç½® HISTTIMEFORMAT å˜é‡ $ HISTTIMEFORMAT=&amp;#34;%d/%m/%y %T &amp;#34; # OR $ echo &amp;#39;export HISTTIMEFORMAT=&amp;#34;%d/%m/%y %T &amp;#34;&amp;#39; &amp;gt;&amp;gt; ~/.bash_profile ä½¿ç”¨ source å‘½ä»¤åŠ è½½ HISTTIMEFORMAT å˜é‡åˆ°å½“å‰ shell å‘½ä»¤çª— $ . ~/.bash_profile # OR $ source ~/.bash_profile å†æ¬¡è¿è¡Œ history å‘½ä»¤ï¼Œå·²ç»å¯ä»¥è¾“å‡ºé™„å¸¦æ‰§è¡Œæ—¶é—´çš„ history äº†ã€‚ 1 root 2020/02/18 11:28:19 ls 2 root 2020/02/18 11:28:21 top 4 root 2020/02/18 11:28:58 docker ps 5 root 2020/02/18 11:34:09 df 6 root 2020/02/18 11:34:15 ls Â« certbot-auto ç”Ÿæˆè¯ä¹¦</description></item><item><title/><link>https://blog.poneding.com/linux/linux-commands/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/linux-commands/</guid><description>ğŸ  é¦–é¡µ / Linux / Linux å‘½ä»¤
Linux å‘½ä»¤ # Linux å‘½ä»¤å¤§å…¨
cat # catå‘½ä»¤ç”¨äºæŠŠæ¡£æ¡ˆä¸²è¿æ¥åä¼ åˆ°åŸºæœ¬è¾“å‡ºï¼ˆè¤å¹•æˆ–åŠ  &amp;gt; fileName åˆ°å¦ä¸€ä¸ªæ¡£æ¡ˆï¼‰
ä½¿ç”¨æƒé™ # æ‰€æœ‰ä½¿ç”¨è€…
è¯­æ³•æ ¼å¼ # cat [-AbeEnstTuv] [--help] [--version] fileName å‚æ•°è¯´æ˜ # -n æˆ– &amp;ndash;number ç”± 1 å¼€å§‹å¯¹æ‰€æœ‰è¾“å‡ºçš„è¡Œæ•°ç¼–å·
-b æˆ– &amp;ndash;number-nonblank å’Œ -n ç›¸ä¼¼ï¼Œåªä¸è¿‡å¯¹äºç©ºç™½è¡Œä¸ç¼–å·
-s æˆ– &amp;ndash;squeeze-blank å½“é‡åˆ°æœ‰è¿ç»­ä¸¤è¡Œä»¥ä¸Šçš„ç©ºç™½è¡Œï¼Œå°±ä»£æ¢ä¸ºä¸€è¡Œçš„ç©ºç™½è¡Œ
-v æˆ– &amp;ndash;show-nonprinting
å®ä¾‹ # æŠŠ textfile1 çš„æ¡£æ¡ˆå†…å®¹åŠ ä¸Šè¡Œå·åè¾“å…¥ textfile2 è¿™ä¸ªæ¡£æ¡ˆé‡Œ
cat -n textfile1 &amp;gt; textfile2 æŠŠ textfile1 å’Œ textfile2 çš„æ¡£æ¡ˆå†…å®¹åŠ ä¸Šè¡Œå·ï¼ˆç©ºç™½è¡Œä¸åŠ ï¼‰ä¹‹åå°†å†…å®¹é™„åŠ åˆ° textfile3 é‡Œã€‚
cat -b textfile1 textfile2 &amp;gt;&amp;gt; textfile3 æ¸…ç©º/etc/test.</description></item><item><title/><link>https://blog.poneding.com/linux/linux-common-commands/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/linux-common-commands/</guid><description>ğŸ  é¦–é¡µ / Linux / Linuxå¸¸ç”¨å‘½ä»¤
Linuxå¸¸ç”¨å‘½ä»¤ # 1.æ–‡ä»¶å’Œç›®å½•ç›¸å…³ # cd .. åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½• cd ../.. åˆ‡æ¢åˆ°ä¸Šä¸¤çº§ç›®å½• cd [dir] è¿›å…¥ dir ç›®å½• cd è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• cd ~[username] è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½• cd - è¿›å…¥ä¸Šæ¬¡ç›®å½• pwd æŸ¥çœ‹ç›®å½•è·¯å¾„ ls æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„ç›®å½•å’Œæ–‡ä»¶ï¼ˆä¸åŒ…å«éšè—ç›®å½•æˆ–æ–‡ä»¶ï¼‰ ls -a æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ ls -F æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ ï¼ˆä¸åŒ…å«ç›®å½•å’Œéšè—æ–‡ä»¶ï¼‰ ls -l æŸ¥çœ‹æ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†èµ„æ–™ ls *[0-9]* æŸ¥çœ‹åŒ…å«å­—ç¬¦çš„æ–‡ä»¶å’Œç›®å½• mkdir dir1 åˆ›å»ºç›®å½• mkdir dir1 dir2 mkdir -p dir1/dir1/dir1 åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘ rm -f file1 åˆ é™¤æ–‡ä»¶ rmdir dir1 åˆ é™¤ç©º rm -rf dir1 åˆ é™¤åŒ…å«å†…å®¹çš„ç›®å½• rm -rf dir1 dir2 åˆ é™¤å¤šä¸ªç›®å½• mv dir1 dir2 é‡å‘½åæˆ–ç§»åŠ¨ä¸€ä¸ªç›®å½•ï¼ˆçœ‹ dir2 æ˜¯å¦å­˜åœ¨ï¼‰ cp file1 file2 å¤åˆ¶æ–‡ä»¶ cp dir/* .</description></item><item><title/><link>https://blog.poneding.com/linux/linux-enable-crontab-log/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/linux-enable-crontab-log/</guid><description>ğŸ  é¦–é¡µ / Linux / Linux å¯ç”¨ crontab æ—¥å¿—
Linux å¯ç”¨ crontab æ—¥å¿— # You can enable logging for cron jobs in order to track problems.
You need to edit the /etc/rsyslog.conf or /etc/rsyslog.d/50-default.conf (on Ubuntu) file and make sure you have the following line uncommented or add it if it is missing:
cron.* /var/log/cron.log Then restart rsyslog and cron:
sudo service rsyslog restart sudo service cron restart Cron jobs will log to /var/log/cron.</description></item><item><title/><link>https://blog.poneding.com/linux/linux-secure-login/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/linux-secure-login/</guid><description>ğŸ  é¦–é¡µ / Linux / Linux-å®‰å…¨ç™»å½•
Linux-å®‰å…¨ç™»å½• # æˆ‘ä»¬éƒ½çŸ¥é“
root æ˜¯ linux ç³»ç»Ÿé»˜è®¤çš„æœ€é«˜æƒé™è´¦å· linux ç³»ç»Ÿé»˜è®¤çš„ ssh ç«¯å£æ˜¯ 22 å¤§å¤šæ•°äººä¹ æƒ¯ä½¿ç”¨ user/password æ¥ç™»å½• linux ç³»ç»Ÿ å¾ˆé—æ†¾ï¼Œå¦‚æœä½ çš„ç³»ç»Ÿæ²¡æœ‰åšç‰¹æ®Šç­‰ç™»é™†é…ç½®ï¼Œé‚£ä¹ˆå…¶ä»–äººä¾¿å¯ä»¥åˆ©ç”¨ ssh ip:22 root/æš´åŠ›å¯†ç  æ¥ç ´è§£ç™»å…¥ä½  çš„ linux ç³»ç»Ÿï¼Œä¸€æ—¦è¢«ä»–ç ´è§£ï¼Œä½ çš„ç³»ç»Ÿå°±å¯ä»¥ä¸ºä»–æ‰€ç”¨äº†ã€‚
ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼æ¥é¿å…å‘ç”Ÿè¿™ç±»å®‰å…¨é—®é¢˜ã€‚
1. ç¦ç”¨ root è´¦å·ç™»å½• # ç¦ç”¨ root è´¦å·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¿…é¡»åˆ›å»ºå…¶ä»–ç™»å½•è´¦å·ï¼Œè¿™é‡Œå»ºè®®è´¦å·åä¸è¦ä¸º admin è¿™ç±»å¸¸è§ç”¨æˆ·åã€‚
åˆ›å»ºç”¨æˆ·ï¼ˆä»¥ä¸‹éƒ½åŸºäº ubuntu ç³»ç»Ÿæ“ä½œï¼‰ adduser dp ç”¨æˆ·èµ‹æƒ æ­¤æ—¶åˆ›å»ºçš„ç”¨æˆ·ä¸èƒ½ä½¿ç”¨ sudo æƒé™ï¼Œè€ƒè™‘å°†ç”¨æˆ·åŠ å…¥ sudo ç»„
usermod -a -G sudo dp å¹¶ä¸”ï¼Œä¸ºäº†é¿å…ä½¿ç”¨ sudo æƒé™éœ€è¦æ—¶ä¸æ—¶çš„è¾“å…¥å¯†ç çš„éº»çƒ¦ï¼Œè¿›è¡Œå…å¯†è®¾ç½®ã€‚åœ¨ /etc/sudoers æ–‡ä»¶ä¸­æ–°å¢è¡Œã€‚
dp ALL=(ALL) NOPASSWD: ALL åˆ°äº†è¿™ä¸€æ­¥ï¼Œåº”è¯¥å°è¯•ä½¿ç”¨æ–°ç”¨æˆ·ç™»å½•ç³»ç»Ÿï¼Œå¦‚æœæˆåŠŸç™»å½•å†å¾€ä¸‹ç»§ç»­ã€‚ ç¦ç”¨ root ç™»å½• æ‰“å¼€ /etc/ssh/sshd_config æ–‡ä»¶ï¼Œæ‰¾åˆ° PermitRootLogin é¡¹ï¼Œä¿®æ”¹è¯¥é¡¹æˆå¦‚ä¸‹ï¼š</description></item><item><title/><link>https://blog.poneding.com/linux/shell-command-interval-character/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/shell-command-interval-character/</guid><description>ğŸ  é¦–é¡µ / Linux / shell å‘½ä»¤é—´éš”ç¬¦
shell å‘½ä»¤é—´éš”ç¬¦ # æˆ‘ä»¬ç»å¸¸èƒ½çœ‹åˆ°Shellå‘½ä»¤é—´æœ‰å¾ˆå¤šä¸­é—´éš”ç¬¦ï¼š|ï¼Œ||ï¼Œ&amp;amp;&amp;amp; ç­‰ï¼Œå®ƒä»¬åˆ°åº•æœ‰ç€ä»€ä¹ˆæ ·çš„ä½œç”¨å‘¢ï¼Ÿä¸€ä¸€æ¥çœ‹ï¼š
1. |ï¼š
é—´éš”ç¬¦ | èµ·ç€ç®¡é“çš„ä½œç”¨ï¼Œæ˜¯å°†ä¸Šä¸€æ¡å‘½ä»¤çš„ stdout ä½œä¸ºä¸‹ä¸€æ¡å‘½ä»¤çš„ stdinï¼š
ç¤ºä¾‹ï¼š
echo hello world! | tee hello.txt 2. ||ï¼š
å‘½ä»¤è¢« || åˆ†å‰²ï¼Œåªæœ‰å½“å‰é¢çš„å‘½ä»¤å‘ç”Ÿé”™è¯¯ï¼Œæ‰ä¼šæ‰§è¡Œåé¢çš„å‘½ä»¤ã€‚
ç¤ºä¾‹ï¼š
# å¦‚æœåˆ›ä¸šå¤±è´¥ï¼Œé‚£ä¹ˆå°±ç»§ç»­æ‰“å·¥ sh chuangye.sh || sh dagong.sh 3. &amp;amp;&amp;amp;ï¼š
å‘½ä»¤è¢« &amp;amp;&amp;amp; åˆ†å‰²ï¼Œå‘½ä»¤ä¼šè¿ç»­æ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœå‰é¢çš„å‘½ä»¤å‘ç”Ÿé”™è¯¯ï¼Œä¼šå½±å“åé¢çš„å‘½ä»¤ç»§ç»­æ‰§è¡Œã€‚
ç¤ºä¾‹ï¼š
# æ´—äº†æ‰‹æ‰èƒ½åƒé¥­ sh wash_hand.sh &amp;amp;&amp;amp; sh eat.sh 4. ;ï¼š
å‘½ä»¤è¢« ; åˆ†å‰²ï¼Œå‘½ä»¤ä¼šè¿ç»­æ‰§è¡Œï¼Œå³ä½¿å‰é¢çš„å‘½ä»¤å‘ç”Ÿé”™è¯¯ï¼Œä¹Ÿä¸å½±å“åé¢çš„å‘½ä»¤ç»§ç»­æ‰§è¡Œã€‚
ç¤ºä¾‹ï¼š
# ä¸ç®¡æœ‰æ²¡æœ‰èµšåˆ°é’±ï¼Œéƒ½è¦å›å®¶è¿‡å¹´ sh earn_money.sh; sh go_home.sh 5. &amp;gt;ï¼š
è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–‡ä»¶ï¼Œæ–‡ä»¶å­˜åœ¨åˆ™ä¼šè¦†ç›–æ–‡ä»¶å†…å®¹ï¼‰
echo &amp;#34;Hello World&amp;#34; &amp;gt; hello.</description></item><item><title/><link>https://blog.poneding.com/linux/shell/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/shell/</guid><description>ğŸ  é¦–é¡µ / Linux / shell åŸºç¡€
shell åŸºç¡€ # shell æ³¨é‡Š # å•è¡Œæ³¨é‡Šï¼š
# æ³¨é‡Šå†…å®¹ å¤šè¡Œæ³¨é‡Šï¼š
:&amp;lt;&amp;lt;EOF æ³¨é‡Šå†…å®¹ æ³¨é‡Šå†…å®¹ æ³¨é‡Šå†…å®¹ EOF æˆ–
:&amp;lt;&amp;lt;! æ³¨é‡Šå†…å®¹ æ³¨é‡Šå†…å®¹ æ³¨é‡Šå†…å®¹ ! æˆ–
:&amp;lt;&amp;lt;&amp;#39; æ³¨é‡Šå†…å®¹ æ³¨é‡Šå†…å®¹ æ³¨é‡Šå†…å®¹ &amp;#39; shell å˜é‡ # å®šä¹‰å˜é‡ï¼š
my_name=&amp;#34;Ding Peng&amp;#34; ä½¿ç”¨å˜é‡ï¼š
$my_name ${my_name} åªè¯»å˜é‡ï¼š
my_name=&amp;#34;Ding Peng&amp;#34; readonly my_name åˆ é™¤å˜é‡ï¼š
unset my_name å˜é‡ç±»å‹ï¼š
å±€éƒ¨å˜é‡ï¼šåœ¨è„šæœ¬æˆ–å‘½ä»¤ä¸­å®šä¹‰ï¼Œä»…åœ¨å½“å‰shellå®ä¾‹æœ‰æ•ˆ ç¯å¢ƒå˜é‡ï¼šæ‰€æœ‰shellå®ä¾‹æœ‰æ•ˆ shellå˜é‡ï¼šshellç¨‹åºè®¾ç½®çš„ç‰¹æ®Šå˜é‡ shell å­—ç¬¦ä¸² # å•å¼•å·ä¸åŒå¼•å·çš„åŒºåˆ«ï¼š
å•å¼•å·é‡Œçš„ä»»ä½•å­—ç¬¦éƒ½ä¼šåŸæ ·è¾“å‡ºï¼Œå•å¼•å·å­—ç¬¦ä¸²ä¸­çš„å˜é‡æ˜¯æ— æ•ˆçš„ï¼› å•å¼•å·å­—ä¸²ä¸­ä¸èƒ½å‡ºç°å•ç‹¬ä¸€ä¸ªçš„å•å¼•å·ï¼ˆå¯¹å•å¼•å·ä½¿ç”¨è½¬ä¹‰ç¬¦åä¹Ÿä¸è¡Œï¼‰ï¼Œä½†å¯æˆå¯¹å‡ºç°ï¼Œä½œä¸ºå­—ç¬¦ä¸²æ‹¼æ¥ä½¿ç”¨ï¼› åŒå¼•å·é‡Œå¯ä»¥æœ‰å˜é‡ï¼› åŒå¼•å·é‡Œå¯ä»¥å‡ºç°è½¬ä¹‰å­—ç¬¦ my_name=&amp;#34;Ding Peng&amp;#34; hello_string=&amp;#34;Hllo,\&amp;#34;$my_name\&amp;#34;!&amp;#34; echo $hello_string è·å–å­—ç¬¦ä¸²é•¿åº¦ï¼š</description></item><item><title/><link>https://blog.poneding.com/linux/ssh-tunnel-connect-middleware/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/ssh-tunnel-connect-middleware/</guid><description>ğŸ  é¦–é¡µ / Linux / ä½¿ç”¨ SSH Tunnel è¿æ¥ä¸­é—´ä»¶
ä½¿ç”¨ SSH Tunnel è¿æ¥ä¸­é—´ä»¶ # èƒŒæ™¯ # ä¸€èˆ¬çº¿ä¸Šçš„æ•°æ®åº“æ˜¯ä¸å…è®¸æœ¬æœºç›´æ¥è®¿é—®çš„ï¼Œåªèƒ½é€šè¿‡è·³æ¿æœºè®¿é—®ã€‚ä½†æ˜¯è¿™ä¹ˆå¤šçš„å¼€å‘äººå‘˜éƒ½è¦è®¿é—®æ•°æ®åº“çš„è¯ï¼Œè·³æ¿æœºçš„æ•°é‡å°±æœ‰å‹åŠ›äº†ã€‚
æœ¬ç¯‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ SSH Tunnel çš„æ–¹å¼è®¿é—®æ•°æ®åº“ï¼Œæ•°æ®åº“ä¸é™äº Sql Serverã€MySqlã€Mongodbã€Redis ç­‰ã€‚
å‰ææ¡ä»¶ # å·²ç»æ‹¥æœ‰æ•°æ®åº“çš„ç™»å½•ä¿¡æ¯ï¼Œå¦‚æ•°æ®åº“è®¿é—®çš„ hostã€portã€userã€passwordï¼› æ‹¥æœ‰ä¸€å°å¯ä»¥è®¿é—®æ•°æ®åº“çš„è·³æ¿æœºç™»å½•æƒé™ï¼Œå¦‚è·³æ¿æœºçš„ IPã€userã€passwordï¼ˆæˆ–å¯†é’¥æ–‡ä»¶ï¼‰ï¼› æœ¬æœºå®‰è£…äº†æœ‰ SSH Tunnel åŠŸèƒ½çš„æ•°æ®åº“çš„å¯è§†åŒ–å·¥å…·ï¼Œå¦‚ DBeaverï¼ŒNavicateï¼ŒRobo 3T ç­‰ã€‚ RDB # ä½¿ç”¨ DBeaver æˆ– Navicate ç­‰å·¥å…·é€šè¿‡ SSH Tunnel æ–¹å¼è®¿é—®å…³ç³»å‹æ•°æ®åº“ï¼Œä»¥ Sql Server ä¸ºä¾‹ã€‚
æ‰“å¼€DBeaverï¼Œé€‰æ‹© Sql Server è¿æ¥ã€‚
åœ¨è¿æ¥é…ç½®é¡µé¢ Mainï¼Œè¾“å…¥ Sql Server è¿æ¥çš„åŸºæœ¬ä¿¡æ¯ï¼Œè¿™é‡Œ host ç›´æ¥ä½¿ç”¨åŸæœ¬çš„æ•°æ®åº“ host å³å¯ã€‚
åˆ‡è‡³ SSHï¼Œå‹¾é€‰ Use SSH Tunnelï¼Œè¾“å…¥è·³æ¿æœºçš„è¿æ¥é…ç½®å³å¯ã€‚
é…ç½®å®Œæˆï¼ŒOkè¿æ¥å³å¯ã€‚</description></item><item><title/><link>https://blog.poneding.com/linux/tee-keep-stderr/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/tee-keep-stderr/</guid><description>ğŸ  é¦–é¡µ / Linux / tee ä¿å­˜ stderr åˆ°æ–‡ä»¶
tee ä¿å­˜ stderr åˆ°æ–‡ä»¶ # teeå‘½ä»¤æ˜¯å°† stdout å†™å…¥åˆ°æŸæ–‡ä»¶å½“ä¸­ï¼Œä½†æ˜¯å¦‚ä½•å°† stderr ä¹Ÿå†™å…¥åˆ°æ–‡ä»¶å½“ä¸­ï¼Ÿ
ç¤ºä¾‹å¦‚ä¸‹ï¼š
1.sh
echo exec 1.sh start! &amp;amp;&amp;amp; \ cat hello.txt &amp;amp;&amp;amp; \ echo exec 1.sh end! å‡å¦‚ hello.txt æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰§è¡Œ 1.sh æ–‡ä»¶ä¸­çš„ cat å‘½ä»¤å°†æŠ¥é”™ã€‚å¦‚æœæˆ‘ä»¬æƒ³å°†æ‰§è¡Œ 1.sh æ–‡ä»¶çš„è¾“å‡ºå†™å…¥åˆ°ä¸€ä¸ª log æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š
sh 1.sh | tee 1.log æ‰§è¡Œä»¥ä¸Šå‘½ä»¤ï¼Œæ§åˆ¶å°çš„è¾“å‡ºæ˜¯ï¼š
$ sh 1.sh | tee 1.log exec 1.sh start! cat: hello.txt: No such file or directory ä½†æ˜¯å†™å…¥åˆ° 1.</description></item><item><title/><link>https://blog.poneding.com/linux/transfer-files-between-server-and-client/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/transfer-files-between-server-and-client/</guid><description>ğŸ  é¦–é¡µ / Linux / æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¼ è¾“æ–‡ä»¶
æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¼ è¾“æ–‡ä»¶ # scp # # å®¢æˆ·ç«¯ &amp;lt;= æœåŠ¡ç«¯ scp server_user@server_ip:/server_path /client_path # å®¢æˆ·ç«¯ =&amp;gt; æœåŠ¡ç«¯ scp /client_path server_user@server_ip:/server_path # ä¼ è¾“ç›®å½•ï¼šscp -r sftp # å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„è¿œç¨‹æ–‡ä»¶ä¼ è¾“å·¥å…·ã€‚
ç¬¬ä¸€æ­¥ï¼Œè¿æ¥æœåŠ¡ç«¯ï¼š
sftp server_user@server_ip -i ssh_key_file ç¬¬äºŒæ­¥ï¼Œä¼ è¾“æ–‡ä»¶ï¼š
# å®¢æˆ·ç«¯ &amp;lt;= æœåŠ¡ç«¯ get /server_path /client_path # å°†å®¢æˆ·ç«¯æ–‡ä»¶ä¼ è¾“åˆ°æœåŠ¡ç«¯ put /client_/file/_path /server_path # ä¼ è¾“æ–‡ä»¶å¤¹ï¼šget -rï¼Œput -r Â« tee ä¿å­˜ stderr åˆ°æ–‡ä»¶
Â» vim ä½¿ç”¨</description></item><item><title/><link>https://blog.poneding.com/linux/vim-common-commands/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/linux/vim-common-commands/</guid><description>ğŸ  é¦–é¡µ / Linux / vim ä½¿ç”¨
vim ä½¿ç”¨ # è®¾ç½® # vim /etc/vim/vimrc æˆ–è€…å½“å‰ç¯å¢ƒè®¾ç½®
:set paste :set nopaste :set number :set nonumber :set hlsearch :set nohlsearch :set cursorline :set nocursorline vimåˆ é™¤æ‰€æœ‰è¡Œ # ggdG æ’¤é”€ # u ctrl+r æŸ¥æ‰¾ # å¤§å°å†™é—®é¢˜ï¼š
é»˜è®¤å¤§å°å†™æ•æ„Ÿã€‚
å¤§å°å†™ä¸æ•æ„Ÿï¼š/hello\c
å¤§å°å†™æ•æ„Ÿï¼š/hello\C
è®¾ç½®å¤§å°å†™æ•æ„Ÿï¼š
ecs+:set ignorecaseï¼šè®¾ç½®é»˜è®¤å¿½ç•¥å¤§å°å†™æ•æ„Ÿ
ecs+:set smartcaseï¼šå¦‚æœæŸ¥æ‰¾å­—ç¬¦ä¸­å­˜åœ¨å¤§å†™åˆ™è‡ªåŠ¨å¤§å°å†™æ•æ„Ÿ
æŸ¥æ‰¾å½“å‰å­—ç¬¦ï¼š
å…‰æ ‡ç§»åŠ¨ # hï¼šå‘å·¦ jï¼šå‘ä¸‹ kï¼šå‘ä¸Š lï¼šå‘å³ æ›¿æ¢ # :s/jay/dp/g æ›¿æ¢å½“å‰è¡Œä¸­æ‰€æœ‰åŒ¹é… jay =&amp;gt; dp :1,$s/jay/dp/g æ›¿æ¢æ‰€æœ‰ :1,5s/jay/dp/g æ›¿æ¢ 1 åˆ° 5 è¡Œ ç¿»é¡µ # ctrl+fï¼šä¸‹ä¸€é¡µ ctrl+dï¼šä¸‹åŠé¡µ ctrl+bï¼šä¸Šä¸€é¡µ ctrl+uï¼šä¸ŠåŠé¡µ è¡Œæ“ä½œ # dGï¼šåˆ é™¤å½“å‰è¡Œåˆ°å°¾è¡Œ</description></item><item><title/><link>https://blog.poneding.com/middleware/elasticsearch/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/middleware/elasticsearch/</guid><description>ğŸ  é¦–é¡µ / æ•°æ®ä¸­é—´ä»¶ / Elasticsearch
Elasticsearch # å…¨æ–‡æœç´¢
API # é¢˜å¤–è¯ï¼š
å¹‚ç­‰æ€§ï¼šå¤šæ¬¡æ‰§è¡ŒåŒæ ·çš„è¯·æ±‚ï¼Œèµ„æºåªèƒ½åˆ›å»ºæˆ–ä¿®æ”¹ä¸€æ¬¡
POST è¯·æ±‚ä¸æ˜¯å¹‚ç­‰æ€§çš„ï¼ŒåŒæ ·çš„æ•°æ®è¯·æ±‚ï¼Œä¼šé€ æˆä¸åŒçš„å½±å“
PUT æ˜¯å¹‚ç­‰æ€§çš„ï¼ŒåŒæ ·çš„è¯·æ±‚é€ æˆçš„å½±å“æ˜¯ä¸€æ ·çš„
åˆ›å»ºç´¢å¼• # PUT /users æŸ¥è¯¢ç´¢å¼• # è·å–å•ä¸ªç´¢å¼•
GET /users è·å–æ‰€æœ‰ç´¢å¼•
GET /_cat/indices?v åˆ é™¤ç´¢å¼• # DELETE /users åˆ›å»ºæ–‡æ¡£ # è¿™ä¸ªæ“ä½œæ˜¯åœ¨å•ä¸ªç´¢å¼•ä¸‹çš„
POST /users/_doc # ä¸€å®šéœ€è¦bodyï¼Œå¦åˆ™æŠ¥é”™ body: { &amp;#34;name&amp;#34;: &amp;#34;dp&amp;#34;, &amp;#34;age&amp;#34;: 18 } ä¸Šé¢è¿™ä¸ªæ–‡æ¡£åˆ›å»ºæ—¶ä¼šç”Ÿæˆéšæœº IDï¼ˆè¿”å›ç»“æœä¸­çš„ _idï¼‰ï¼Œä¸ä¾¿ç»´æŠ¤ï¼Œä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è‡ªå®šä¹‰æ–‡æ¡£ IDï¼Œæ­¤æ—¶ç”±äº ID è‡ªå®šä¹‰äº†ï¼Œå°±è¦æ±‚å¹‚ç­‰ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ PUT æ–¹æ³•
POST | PUT /users/_doc/1002 PUT /users/_create/1003 # ä¸€å®šéœ€è¦bodyï¼Œå¦åˆ™æŠ¥é”™ body: { &amp;#34;name&amp;#34;: &amp;#34;dp&amp;#34;, &amp;#34;age&amp;#34;: 18 } æŸ¥è¯¢æ–‡æ¡£ # è·å–å•ä¸ªæ–‡æ¡£</description></item><item><title/><link>https://blog.poneding.com/middleware/mongodb/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/middleware/mongodb/</guid><description>ğŸ  é¦–é¡µ / æ•°æ®ä¸­é—´ä»¶ / MongoDB
MongoDB # èµ„æ–™ # http://cw.hubwiz.com/card/c/543b2f3cf86387171814c026/1/1/1/ http://cw.hubwiz.com/card/c/5438c259032c7817c40298b5/1/1/1/ å®‰è£… # æŒ‰ç…§å®˜ç½‘ç»™å‡ºçš„æŒ‡å—åœ¨ ubuntu ç³»ç»Ÿå®‰è£… mongodï¼Œå‚è€ƒ https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/
éªŒè¯ mongo æ˜¯å¦å®‰è£…æˆåŠŸï¼šè¿›å…¥ ubuntu shell çª—å£ï¼Œç›´æ¥è¾“å…¥
mongo --version çª—å£æ­£å¸¸è¾“å‡º mongo ç‰ˆæœ¬å°±è¯´æ˜ mongo å®‰è£…æˆåŠŸ
å¯åŠ¨ mongo æœåŠ¡
sudo systemctl statt mongod #/stop/restart åˆ›å»º dba ç”¨æˆ·å¹¶æ·»åŠ æƒé™éªŒè¯
mongodb æ²¡æœ‰å¼€å¯æƒé™éªŒè¯ä¹‹å‰ï¼Œä½¿ç”¨ mongo å‘½ä»¤å¯ä»¥ç›´æ¥è¿æ¥æœ¬åœ° mongodbï¼›
sudo mongo ä½¿ç”¨ db.createUser å‘½ä»¤åˆ›å»º dba ç”¨æˆ·,ä¸º dba ç”¨æˆ·æ·»åŠ æ‰€æœ‰ database çš„ç®¡ç†å‘˜æƒé™ï¼›
&amp;gt; db.createUser({user:&amp;#34;dba&amp;#34;,pwd:&amp;#34;[your pass]&amp;#34;,roles:[ {role:&amp;#34;readWriteAnyDatabase&amp;#34;,db:&amp;#34;admin&amp;#34;},{role:&amp;#34;dbAdminAnyDatabase&amp;#34;,db:&amp;#34;admin&amp;#34;},{role:&amp;#34;userAdminAnyDatabase&amp;#34;,db:&amp;#34;admin&amp;#34;},{role:&amp;#34;clusterAdmin&amp;#34;,db:&amp;#34;admin&amp;#34;},{role:&amp;#34;restore&amp;#34;,db:&amp;#34;admin&amp;#34;},{role:&amp;#34;backup&amp;#34;,db:&amp;#34;admin&amp;#34;} ]}) Successfully added user: { &amp;#34;user&amp;#34; : &amp;#34;dba&amp;#34;, &amp;#34;roles&amp;#34; : [ // .</description></item><item><title/><link>https://blog.poneding.com/middleware/mysql/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/middleware/mysql/</guid><description>ğŸ  é¦–é¡µ / æ•°æ®ä¸­é—´ä»¶ / MySQL
MySQL # å®‰è£… # Windows å®‰è£… MySQL # ä¸‹è½½ Mysql å®‰è£…åŒ…ï¼š https://dev.mysql.com/downloads/installer/
ä¸‹è½½å®Œæˆåï¼ŒåŒå‡» msi æ–‡ä»¶å®‰è£…ã€‚
Ubuntu å®‰è£… MySQL # sudo apt update sudo apt install mysql-server -y # åªå®‰è£… mysql å®¢æˆ·ç«¯ sudo apt install mysql-client -y Docker å®‰è£… MySQL # docker run -d --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7 Troubleshooting # Q1. root ç”¨æˆ·æœ¬åœ°ç™»å½• # ä½¿ç”¨å‘½ä»¤ mysql -u root -pï¼Œè¾“å…¥å¯†ç åç™»å½•å¤±è´¥ï¼Œæç¤ºå¦‚ä¸‹ï¼š
Access denied for user &amp;#39;root&amp;#39;@&amp;#39;localhost&amp;#39; è§£å†³æ–¹æ¡ˆï¼šï¼š</description></item><item><title/><link>https://blog.poneding.com/middleware/postgres/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/middleware/postgres/</guid><description>ğŸ  é¦–é¡µ / æ•°æ®ä¸­é—´ä»¶ / Postgres
Postgres # è‡ªå¢ Id æ•°æ®æ’å…¥æƒé™
GRANT USAGE, SELECT, UPDATE ON ALL SEQUENCES IN SCHEMA public TO &amp;lt;user_name&amp;gt;; ä¿®æ”¹ç”¨æˆ·å¯†ç 
alter user postgres with password &amp;#39;admin123&amp;#39;; Â« MySQL
Â» Redis</description></item><item><title/><link>https://blog.poneding.com/middleware/redis/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/middleware/redis/</guid><description>ğŸ  é¦–é¡µ / æ•°æ®ä¸­é—´ä»¶ / Redis
Redis # å®‰è£… # Docker å®‰è£… redis # sudo docker run --name redis-01 \ -p 2501:6379 \ -v /home/dp/apps/redis/redis-01/conf/redis.conf:/etc/redis/redis.conf \ -v /home/dp/apps/redis/redis-01/data:/data \ -d \ redis:6.0 redis-server /etc/redis/redis.conf --appendonly yes redis.conf æ˜¯é…ç½®æ–‡ä»¶ redis-server /etc/redis/redis.confï¼Œå¯ç”¨é…ç½®ï¼Œå¦‚æœæ²¡æœ‰ redis-server åˆ™ redis é»˜è®¤æ˜¯æ— é…ç½®å¯åŠ¨ &amp;ndash;appendonly yes å¯ç”¨æ•°æ®æŒä¹…åŒ– redis.conf å‚ç…§ï¼š
bind 127.0.0.1 # æ³¨é‡Šæ‰è¿™éƒ¨åˆ†ï¼Œä½¿ redis å¯ä»¥å¤–éƒ¨è®¿é—® daemonize no # ç”¨å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ requirepass your_pwd # ç»™ redis è®¾ç½®å¯†ç  appendonly yes # redis æŒä¹…åŒ–ã€€é»˜è®¤æ˜¯ no tcp-keepalive 300 # é˜²æ­¢å‡ºç°è¿œç¨‹ä¸»æœºå¼ºè¿«å…³é—­äº†ä¸€ä¸ªç°æœ‰çš„è¿æ¥çš„é”™è¯¯ é»˜è®¤æ˜¯ 300 Â« Postgres</description></item><item><title/><link>https://blog.poneding.com/os/macos/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/os/macos/</guid><description>ğŸ  é¦–é¡µ / æ“ä½œç³»ç»Ÿ / MacOS
MacOS # é™æ€å£çº¸ä½ç½® # å†å²ç³»ç»Ÿå£çº¸: /Users/dp/Library/Application Support/com.apple.mobileAssetDesktop å½“å‰ç³»ç»Ÿå£çº¸ï¼š/System/Library/Desktop Pictures åŠ¨æ€å£çº¸ï¼š/Library/Application Support/com.apple.idleassetsd/Customer/4KSDR240FPS
Git å¿½ç•¥ .DS_Store æ–‡ä»¶ # # é…ç½®å…¨å±€å¿½ç•¥æ–‡ä»¶ git config --global core.excludesfile ~/.gitignore_global # æ·»åŠ  .DS_Store æ–‡ä»¶åˆ°å…¨å±€å¿½ç•¥æ–‡ä»¶ echo .DS_Store &amp;gt;&amp;gt; ~/.gitignore_global echo ._.DS_Store &amp;gt;&amp;gt; ~/.gitignore_global echo **/.DS_Store &amp;gt;&amp;gt; ~/.gitignore_global echo **/._.DS_Store &amp;gt;&amp;gt; ~/.gitignore_global é…ç½® PATH # åœ¨ç»ˆç«¯ä½¿ç”¨ export å‘½ä»¤è®¾ç½® PATH å¹¶ä¸èƒ½å…¨å±€ç”Ÿæ•ˆï¼Œå¦‚æœä½ æƒ³è®¾ç½®å…¨å±€ PATH ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¿™ä¸ªæ–¹æ³•ï¼š
sudo mkdir /etc/paths.d/mypath vim /etc/paths.d/mypath /your/path æŸ¥çœ‹ç«¯å£å ç”¨å¹¶é€€å‡ºç¨‹åº # æœ‰æ—¶å€™ä½¿ç”¨ VSCode è°ƒè¯•æˆ–è¿è¡Œç¨‹åºåï¼Œæ— æ³•æˆåŠŸæ¨å‡ºç¨‹åºï¼Œç«¯å£ä¸€ç›´å ç”¨ã€‚</description></item><item><title/><link>https://blog.poneding.com/os/ohmyzsh/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/os/ohmyzsh/</guid><description>ğŸ  é¦–é¡µ / æ“ä½œç³»ç»Ÿ / ohmyzsh
ohmyzsh # macos # echo $SHELL /bin/zsh å®‰è£… ohmyzsh sh -c &amp;#34;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&amp;#34; å®‰è£… zsh-autosuggestions git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions é…ç½® .zshrc æ–‡ä»¶æ·»åŠ  ohmyzsh æ’ä»¶ï¼š plugins=(git docker docker-compose kubectl autojump zsh-autosuggestions) linux # å®‰è£… zshï¼š sudo apt update sudo apt install zsh -y ä¿®æ”¹ shellï¼š chsh -s /usr/bin/zsh æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼Œå°†ä½¿ç”¨ zsh
echo $SHELL /usr/bin/zsh å®‰è£… ohmyzshï¼š sh -c &amp;#34;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)&amp;#34; å®‰è£… zsh-autosuggestionsï¼š git clone https://github.</description></item><item><title/><link>https://blog.poneding.com/os/openssl/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/os/openssl/</guid><description>ğŸ  é¦–é¡µ / æ“ä½œç³»ç»Ÿ / openssl
openssl # openssl å¸¸ç”¨äºç”Ÿæˆè¯ä¹¦ã€ç­¾åã€åŠ å¯†ç­‰æ“ä½œã€‚å®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„å·¥å…·ï¼Œå¯ä»¥åœ¨ Linuxã€Windowsã€MacOS ç­‰æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œã€‚
åŒ…å«ä¸‰ä¸ªç»„ä»¶ï¼š
opensslï¼šå‘½ä»¤è¡Œå·¥å…· libcryptoï¼šåŠ å¯†ç®—æ³•åº“ libsslï¼šåŠ å¯†æ¨¡å—åº”ç”¨åº“ï¼Œå®ç°äº† SSL å’Œ TLS åè®® å¯¹ç§°åŠ å¯† # echo test &amp;gt; test.txt # åŠ å¯† openssl enc -e -des3 -a -salt -in test.txt -out test.txt.enc # è§£å¯† openssl enc -d -des3 -a -salt -in test.txt.enc -out test.txt.dec -saltï¼šåŠ ç›ï¼Œå¢åŠ ç ´è§£éš¾åº¦ï¼Œä½¿ç”¨ openssl é»˜è®¤ç›å€¼ -S [salt]ï¼šæŒ‡å®šç›å€¼
éå¯¹ç§°åŠ å¯† # ç”Ÿæˆå¯†é’¥å¯¹
openssl genrsa -out rsa_private_key.pem 2048 openssl rsa -in rsa_private_key.pem -pubout -out rsa_public_key.</description></item><item><title/><link>https://blog.poneding.com/os/ubuntu/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/os/ubuntu/</guid><description>ğŸ  é¦–é¡µ / æ“ä½œç³»ç»Ÿ / Ubuntu
Ubuntu # ç»ˆç«¯é»˜è®¤ä½¿ç”¨è‹±æ–‡ # LANG=en_US.UTF-8 LANGUAGE=en_US:en LC_ALL=en_US.UTF-8 ä¸‹è½½ arm64 æ¡Œé¢é•œåƒ # https://cdimage.ubuntu.com/jammy/daily-live/current/jammy-desktop-arm64.iso å…³é—­é˜²ç«å¢™ # sudo ufw disable sudo ufw status ä¿®æ”¹æ—¶åŒº # sudo cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime sudo timedatectl set-timezone Asia/Shanghai date # åŒæ­¥æ—¶é—´ sudo apt install ntpdate -y sudo ntpdate cn.pool.ntp.org è§£å†³è‹±æ–‡ç³»ç»Ÿä¸‹ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜ # ä¿®æ”¹å­—ä½“ä¼˜å…ˆçº§
sudo vim /etc/fonts/conf.avail/64-language-selector-prefer.conf æ³¨æ„ï¼šåœ¨ Ubuntu 23.10 æˆ–æ›´æ–°ç‰ˆæœ¬çš„ç³»ç»Ÿä¸Šä¿®æ”¹æ–‡ä»¶ï¼š
sudo vim /etc/fonts/conf.d/64-language-selector-cjk-prefer.conf å°† `JP` å’Œ `KR` æ‰€åœ¨è¡Œå¾€ä¸‹è°ƒæ•´å³å¯ï¼Œè°ƒæ•´æˆå¦‚ä¸‹æ‰€ç¤ºï¼š ```xml &amp;lt;?xml version=&amp;#34;1.0&amp;#34;?&amp;gt; &amp;lt;!DOCTYPE fontconfig SYSTEM &amp;#34;fonts.</description></item><item><title/><link>https://blog.poneding.com/os/windows/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/os/windows/</guid><description>ğŸ  é¦–é¡µ / æ“ä½œç³»ç»Ÿ / Windows ä½¿ç”¨å§¿åŠ¿
Windows ä½¿ç”¨å§¿åŠ¿ # 0. æ¿€æ´» windows # ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œå‘½ä»¤è¡Œï¼Œè¾“å…¥ä»¥ä¸‹ä¸‰è¡Œå‘½ä»¤ï¼š
slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX # ç­‰å¾…å¼¹çª—å‡ºç°ï¼Œç‚¹å‡»ç¡®å®šä¹‹åï¼Œå†ç»§ç»­æ‰§è¡Œä¸‹ä¸€è¡Œå‘½ä»¤ slmgr /skms kms.loli.best # slmgr /skms kms.03k.org # åŒæ ·éœ€è¦ç­‰å¾…å¼¹çª—å‡ºç°ï¼Œç‚¹å‡»ç¡®å®šä¹‹åï¼Œå†ç»§ç»­æ‰§è¡Œ slmgr /ato # æ­£å¸¸æƒ…å†µä¸‹åº”è¯¥ä¼šå‡ºç°æ¿€æ´»æˆåŠŸçš„å¼¹çª— 1. Windows Terminal SSH è¿æ¥è¶…æ—¶è‡ªåŠ¨æ–­å¼€ # ä½¿ç”¨ Windows Terminal SSH è¿æ¥ linux æœåŠ¡å™¨ï¼Œæ¯è¿‡ä¸€æ®µæ—¶é—´åï¼Œå°±ä¼šè‡ªåŠ¨æ–­å¼€ã€‚
è§£å†³æ–¹æ¡ˆï¼š
æ‰“å¼€é…ç½®æ–‡ä»¶ %USERPROFILE%/.ssh/configï¼Œåœ¨è¯¥é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®è¡Œï¼š
ServerAliveInterval 60 2. VSCode æ­é… Remote-SSH # é…ç½®è¿œç¨‹è®¿é—®æ–‡ä»¶ %USERPROFILE%/.ssh/configï¼š
å¯†é’¥æ–‡ä»¶è¿›è¡ŒSSHè¿æ¥ # Host aliyun HostName 11.11.11.11 User root IdentityFile ~/.ssh/aliyun_key ç”¨æˆ·å¯†ç è¿›è¡ŒSSHè¿æ¥ # Host ubuntu HostName 192.</description></item><item><title/><link>https://blog.poneding.com/reading/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91Operator%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/reading/%E4%BA%91%E5%8E%9F%E7%94%9F%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91Operator%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5/</guid><description>ğŸ  é¦–é¡µ / é˜…è¯» / äº‘åŸç”Ÿåº”ç”¨å¼€å‘ï¼šOperatoråŸç†ä¸å®è·µ
äº‘åŸç”Ÿåº”ç”¨å¼€å‘ï¼šOperatoråŸç†ä¸å®è·µ # 2. OperatoråŸç† # 2.2 client-goåŸç† # client-goä¸»è¦ç”¨åœ¨Kubernetesçš„Controllerä¸­ï¼ŒåŒ…æ‹¬å†…ç½®Controllerï¼ˆå¦‚kube-controller-managerï¼‰å’ŒCRDæ§åˆ¶å™¨ï¼›
å®ç°å¯¹å„ç±»K8s APIèµ„æºçš„å¢åˆ æ”¹æŸ¥æ“ä½œï¼›
åŒ…å«Reflectorï¼ŒInformerï¼ŒIndexrç­‰ç»„ä»¶ã€‚
2.2.1 client-goä»‹ç» # æ˜¯æ“ä½œk8sé›†ç¾¤èµ„æºçš„ç¼–ç¨‹å¼äº¤äº’å®¢æˆ·ç«¯ï¼Œåˆ©ç”¨å¯¹kube-apiserverçš„äº¤äº’è®¿é—®ï¼Œå®ç°å¯¹å„ç±»K8s APIèµ„æºçš„å¢åˆ æ”¹æŸ¥æ“ä½œï¼›
client-goä¸ä»…è¢«k8sé¡¹ç›®æœ¬èº«ä½¿ç”¨ï¼ˆå¦‚kubectlï¼‰ï¼Œè¿˜åœ¨åŸºäºk8sçš„äºŒæ¬¡å¼€å‘ä¸­è¢«å¤–éƒ¨ç”¨æˆ·å¹¿æ³›ä½¿ç”¨ï¼šè‡ªå®šä¹‰æ§åˆ¶å™¨ï¼ŒOperatorç­‰ã€‚
ä½¿ç”¨ï¼š
client-goåº“æŠ½è±¡å°è£…äº†ä¸k8s reset apiçš„äº¤äº’ï¼Œä¾¿äºå¼€å‘è€…åŸºäºk8såšäºŒæ¬¡å¼€å‘ã€‚åˆ©ç”¨client-goæ“ä½œk8sèµ„æºçš„æµç¨‹åŸºæœ¬å¦‚ä¸‹ï¼š
é€šè¿‡kubeconfigä¿¡æ¯æ„é€ Configå®ä¾‹ï¼Œè¯¥å®ä¾‹è®°å½•äº†é›†ç¾¤è¯ä¹¦ï¼Œk8s apiserveråœ°å€ç­‰ä¿¡æ¯ï¼› æ ¹æ®Configå®ä¾‹æºå¸¦çš„ä¿¡æ¯æ„å»ºç‰¹å®šçš„å®¢æˆ·ç«¯ï¼ˆclientsetï¼Œdynamicsetç­‰ï¼‰ï¼› åˆ©ç”¨å®¢æˆ·ç«¯å‘k8s apiserverå‘èµ·è¯·æ±‚ï¼Œæ“ä½œk8sèµ„æºã€‚ ä»¥ä¸‹æ˜¯ä½¿ç”¨ client-go è·å– pod çš„ä»£ç æ¸…å•ï¼š
func main() { var kubernetes *string if home := homeDir(); home != &amp;#34;&amp;#34; { kubeconfig := flag.String( &amp;#34;kubeconfig&amp;#34;, filePath.Join(home, &amp;#34;.kube&amp;#34;, &amp;#34;config&amp;#34;), &amp;#34;(optional) absolute path to the kubeconfig file&amp;#34;, ) } else { kubeconfig := flag.</description></item><item><title/><link>https://blog.poneding.com/reading/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E6%9C%AC%E7%AE%97%E6%B3%95%E4%B9%A6/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/reading/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E6%9C%AC%E7%AE%97%E6%B3%95%E4%B9%A6/</guid><description>ğŸ  é¦–é¡µ / é˜…è¯» / æˆ‘çš„ç¬¬ä¸€æœ¬ç®—æ³•ä¹¦
æˆ‘çš„ç¬¬ä¸€æœ¬ç®—æ³•ä¹¦ # ä½œè€…ï¼šçŸ³ç”°ä¿è¾‰ï¼Œå®«å´ä¿®ä¸€
1. ç®—æ³•çš„åŸºç¡€çŸ¥è¯† # 1.1 ä»€ä¹ˆæ˜¯ç®—æ³• # ç®—æ³•æ˜¯è®¡ç®—æœºè®¡ç®—å’Œè§£å†³é—®é¢˜çš„æ­¥éª¤ã€‚
é€‰æ‹©æ’åºï¼š
func selectionSort(nums []int) []int { for i := 0; i &amp;lt; len(nums); i++ { min := i for j := i + 1; j &amp;lt; len(nums); j++ { if nums[j] &amp;lt; nums[min] { min = j } } nums[i], nums[min] = nums[min], nums[i] } return nums } Â« äº‘åŸç”Ÿåº”ç”¨å¼€å‘ï¼šOperatoråŸç†ä¸å®è·µ
Â» æ·±å…¥ç†è§£è®¡ç®—æœºç½‘ç»œ.md</description></item><item><title/><link>https://blog.poneding.com/reading/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/reading/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</guid><description>ğŸ  é¦–é¡µ / é˜…è¯» / æ·±å…¥ç†è§£è®¡ç®—æœºç½‘ç»œ.md
äºŒè¿›åˆ¶æ•°çš„å››ç§è¡¨ç¤ºæ–¹æ³• # åŸç  # äºŒè¿›åˆ¶æ•°ç¬¬ä¸€ä½ç”¨æ¥è¡¨ç¤ºæ­£è´Ÿç¬¦å·ï¼Œ0 è¡¨ç¤º +ï¼Œ1 è¡¨ç¤º -ã€‚ åŸç å°±æ˜¯å¸¦æ­£è´Ÿç¬¦å·çš„äºŒè¿›åˆ¶æ•°ï¼Œä¾‹å¦‚ï¼Œ+3 åŸç ä¸º 00000011ï¼Œ-3 åŸç ä¸º 10000011ã€‚ åŸç è¡¨ç¤ºæ–¹æ³•ä¸­ï¼Œ0 æœ‰ +0 å’Œ -0 è¡¨ç°å½¢å¼ã€‚
åç  # è¡¥ç  # åŸç åœ¨åŠ å‡æ³•è¿ç®—ä¸­çš„ä¸ä¾¿ï¼Œ
ç§»ç  # Â« æˆ‘çš„ç¬¬ä¸€æœ¬ç®—æ³•ä¹¦</description></item><item><title/><link>https://blog.poneding.com/rust/01-getting-started/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/rust/01-getting-started/</guid><description>ğŸ  é¦–é¡µ / Rust ç¼–ç¨‹ / Rust å…¥é—¨
Rust å…¥é—¨ # å®‰è£… # Linux &amp;amp; Macï¼š
curl --proto &amp;#39;=https&amp;#39; --tlsv1.2 https://sh.rustup.rs -sSf | sh ä¸€äº›å¸¸ç”¨çš„ Rust åŒ…ä¾èµ–äº C ä»£ç ï¼Œå› æ­¤å¯èƒ½éœ€è¦é¢å¤–å®‰è£… C ç¼–è¯‘å™¨ï¼Œåœ¨ Mac ä¸Šé€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯ä»¥è·å¾— C ç¼–è¯‘å™¨ï¼š
xcode-select --install Ubuntu ä¸Šé€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯ä»¥è·å¾— C ç¼–è¯‘å™¨ï¼š
sudo apt install build-essential Windowsï¼š
Windows ç”¨æˆ·å¯ä»¥åœ¨ Rust å®˜ç½‘ ä¸‹è½½å®‰è£…ç¨‹åºã€‚
é…ç½®å‘½ä»¤è¡¥å…¨ # ç¬¬ä¸€ç§æ–¹å¼ï¼Œzsh æ·»åŠ  rust æ’ä»¶ï¼š
vim ~/.zshrc æ‰¾åˆ° plugins é…ç½®ä½ç½®ï¼Œè¿½åŠ  rust:
plugins=(... rust) ç¬¬äºŒç§æ–¹å¼ï¼š
æŸ¥çœ‹å¸®åŠ©ï¼š
rustup completions --help ä»¥ Ubuntu ä¸ºä¾‹ï¼Œåˆ›å»ºç›®å½•ï¼š</description></item><item><title/><link>https://blog.poneding.com/rust/02-cargo/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/rust/02-cargo/</guid><description>ğŸ  é¦–é¡µ / Rust ç¼–ç¨‹ / Cargo ç®¡ç†å·¥å…·
Cargo ç®¡ç†å·¥å…· # cargo æ˜¯ Rust çš„æ„å»ºç³»ç»Ÿå’ŒåŒ…ç®¡ç†å™¨ã€‚
é…ç½®å›½å†… rsproxy æº # vim ~/.cargo/config.toml [source.crates-io] replace-with = &amp;#39;rsproxy-sparse&amp;#39; [source.rsproxy] registry = &amp;#34;https://rsproxy.cn/crates.io-index&amp;#34; [source.rsproxy-sparse] registry = &amp;#34;sparse+https://rsproxy.cn/index/&amp;#34; [registries.rsproxy] index = &amp;#34;https://rsproxy.cn/crates.io-index&amp;#34; [net] git-fetch-with-cli = true åˆ›å»ºé¡¹ç›® # cargo new hello-world cd hello-world å¯ä»¥ä½¿ç”¨ cargo new --vcs git hello-world åˆ›å»ºé¡¹ç›®å¹¶åˆå§‹åŒ– git ä»“åº“ï¼Œå®ƒå°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª .gitignore æ–‡ä»¶ã€‚
ç¼–è¯‘é¡¹ç›® # cargo build # ç¼–è¯‘ä¹‹åå°†åœ¨ target/debug ç›®å½•ä¸‹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ # å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿è¡Œ .</description></item><item><title/><link>https://blog.poneding.com/rust/03-vscode-debugging/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/rust/03-vscode-debugging/</guid><description>ğŸ  é¦–é¡µ / Rust ç¼–ç¨‹ / VSCode è°ƒè¯•
VSCode è°ƒè¯• # 1. å®‰è£…æ’ä»¶ # CodeLLDB rust-analyzer 2. é…ç½® # é¡¹ç›®æ ¹ç›®å½•é…ç½® .vscode/launch.jsonï¼Œè°ƒè¯•è¿è¡Œæ—¶æ‰“å¼€ main.rs æ–‡ä»¶ã€‚
{ &amp;#34;version&amp;#34;: &amp;#34;0.2.0&amp;#34;, &amp;#34;configurations&amp;#34;: [ { &amp;#34;type&amp;#34;: &amp;#34;lldb&amp;#34;, &amp;#34;request&amp;#34;: &amp;#34;launch&amp;#34;, &amp;#34;name&amp;#34;: &amp;#34;Debug Rust Project&amp;#34;, &amp;#34;cargo&amp;#34;: { &amp;#34;args&amp;#34;: [ &amp;#34;build&amp;#34;, &amp;#34;--target-dir=${fileDirname}/../target&amp;#34;, &amp;#34;--manifest-path=${fileDirname}/../Cargo.toml&amp;#34; ] }, &amp;#34;args&amp;#34;: [], &amp;#34;cwd&amp;#34;: &amp;#34;${workspaceFolder}&amp;#34; }, { &amp;#34;type&amp;#34;: &amp;#34;lldb&amp;#34;, &amp;#34;request&amp;#34;: &amp;#34;launch&amp;#34;, &amp;#34;name&amp;#34;: &amp;#34;Debug Rust Unit Tests&amp;#34;, &amp;#34;cargo&amp;#34;: { &amp;#34;args&amp;#34;: [ &amp;#34;test&amp;#34;, &amp;#34;--no-run&amp;#34;, &amp;#34;--target-dir=${fileDirname}/../target&amp;#34;, &amp;#34;--manifest-path=${fileDirname}/../Cargo.toml&amp;#34; ] }, &amp;#34;args&amp;#34;: [], &amp;#34;cwd&amp;#34;: &amp;#34;${workspaceFolder}&amp;#34; } ] } æ”¯æŒ Wrokspace ä¸‹å¤š Rust é¡¹ç›®è°ƒè¯•ã€‚</description></item><item><title/><link>https://blog.poneding.com/rust/04-wasm-programming/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/rust/04-wasm-programming/</guid><description>ğŸ  é¦–é¡µ / Rust ç¼–ç¨‹ / Rust WASM ç¼–ç¨‹
Rust WASM ç¼–ç¨‹ # 1. åˆå§‹åŒ–é¡¹ç›® # cargo new hello-wasm cd hello-wasm 2. å®‰è£… wasm-pack # cargo install wasm-pack 3. ç¼–å†™ä»£ç  # ç¼–è¾‘ src/main.rs æ–‡ä»¶ï¼š
// ä½¿ç”¨ wasm-bindgen åœ¨ Rust ä¸ JavaScript ä¹‹é—´é€šä¿¡ extern crate wasm_bindgen; use wasm_bindgen::prelude::*; #[wasm_bindgen] extern { pub fn alert(s: &amp;amp;str); } #[wasm_bindgen] pub fn greet(name: &amp;amp;str){ alert(&amp;amp;format!(&amp;#34;Hello, {}!&amp;#34;,name)); } ç¼–è¾‘ Cargo.toml æ–‡ä»¶ï¼š
[package] name = &amp;#34;hello-wasm&amp;#34; version = &amp;#34;0.</description></item></channel></rss>