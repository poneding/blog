<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ç§‹æ²³è½å¶</title><link>https://blog.poneding.com/go/</link><description>Recent content on ç§‹æ²³è½å¶</description><generator>Hugo</generator><language>cn</language><atom:link href="https://blog.poneding.com/go/index.xml" rel="self" type="application/rss+xml"/><item><title/><link>https://blog.poneding.com/go/dev-env-config/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/dev-env-config/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Go å¼€å‘ç¯å¢ƒé…ç½®
Go å¼€å‘ç¯å¢ƒé…ç½® # cobra-cli # å®‰è£…ï¼š
go install github.com/spf13/cobra-cli@latest è‡ªåŠ¨è¡¥å…¨ï¼š
cobra-cli completion zsh &amp;gt; .zfunc/_cobra-cli åœ¨ .zshrc æ–‡ä»¶ä¸­æ·»åŠ å†…å®¹ï¼ˆå¦‚æœå·²æ·»åŠ ï¼Œåˆ™å¿½ç•¥ï¼‰ï¼š
fpath+=~/.zfunc autoload -Uz compinit &amp;amp;&amp;amp; compinit Â» Golang å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼</description></item><item><title/><link>https://blog.poneding.com/go/function-optional-pattern/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/function-optional-pattern/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼
Golang å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼ # å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼ # type Server struct { Addr string Timeout time.Duration } type Option func(*Server) func newServer(addr string, options ...Option) (*Server, error) { s := &amp;amp;Server{ Addr: addr, } for _, opt := range options { opt(s) } // ... return s, nil } func WithTimeout(timeout time.Duration) Option { return func(s *Server) { s.Timeout = timeout } } é€šç”¨å‡½æ•°å¯é€‰å‚æ•°æ¨¡å¼ # type BasicService struct { redisClient string } type ServiceOption func(*BasicService) func WithRedisClient(redisClient string) ServiceOption { return func(s *BasicService) { s.</description></item><item><title/><link>https://blog.poneding.com/go/go-cert-management/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-cert-management/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å¯†é’¥å¯¹ã€æ•°å­—ç­¾åå’Œè¯ä¹¦ç®¡ç†
Golang å¯†é’¥å¯¹ã€æ•°å­—ç­¾åå’Œè¯ä¹¦ç®¡ç† # Golang å®ç°å¯†é’¥å¯¹ç”Ÿæˆ ç›¸å½“äºä½¿ç”¨ openssl ç”Ÿæˆç§é’¥å’Œå…¬é’¥ï¼š
openssl genrsa -out pri.key 2048 openssl rsa -in pri.key -pubout -out pub.key package main import ( &amp;#34;crypto/rand&amp;#34; &amp;#34;crypto/rsa&amp;#34; ) func GenerateKeyPair() (*rsa.PrivateKey, *rsa.PublicKey, error) { prikey, err := rsa.GenerateKey(rand.Reader, 2048) if err != nil { return nil, nil, err } return prikey, &amp;amp;prikey.PublicKey, nil } å®ç°åŠ å¯†å’Œè§£å¯† åŠ å¯†è§£å¯†ï¼šå…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†
package main import ( &amp;#34;crypto/rand&amp;#34; &amp;#34;crypto/rsa&amp;#34; ) func Encrypt(data []byte, publicKey *rsa.</description></item><item><title/><link>https://blog.poneding.com/go/go-cross-complie/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-cross-complie/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang ä¸åŒå¹³å°æ¶æ„ç¼–è¯‘
Golang ä¸åŒå¹³å°æ¶æ„ç¼–è¯‘ # åœ¨ MacOS å¹³å°ç¼–è¯‘æˆ Windowsã€Linux å¯æ‰§è¡Œæ–‡ä»¶ï¼š
CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go CGO_ENABLED=0 GOOS=linux GOARCH=arm64 go build main.go CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build main.go CGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build main.go åœ¨ Windows å¹³å°ç¼–è¯‘æˆ Linuxã€MacOS å¯æ‰§è¡Œæ–‡ä»¶ï¼š
$env:GOOS = &amp;#34;linux&amp;#34;;$env:CGO_ENABLED = &amp;#34;0&amp;#34;;$env:GOARCH = &amp;#34;amd64&amp;#34;;go build carbon/carbon.go $env:GOOS = &amp;#34;linux&amp;#34;;$env:CGO_ENABLED = &amp;#34;0&amp;#34;;$env:GOARCH = &amp;#34;arm64&amp;#34;;go build carbon/carbon.go $env:GOOS = &amp;#34;darwin&amp;#34;;$env:CGO_ENABLED = &amp;#34;0&amp;#34;;$env:GOARCH = &amp;#34;amd64&amp;#34;;go build carbon/carbon.</description></item><item><title/><link>https://blog.poneding.com/go/go-gen-cert/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-gen-cert/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang ç”Ÿæˆè¯ä¹¦
Golang ç”Ÿæˆè¯ä¹¦ # ä»£ç å®ç° # package certutil import ( &amp;#34;bytes&amp;#34; &amp;#34;crypto/rand&amp;#34; &amp;#34;crypto/rsa&amp;#34; &amp;#34;crypto/x509&amp;#34; &amp;#34;crypto/x509/pkix&amp;#34; &amp;#34;encoding/pem&amp;#34; &amp;#34;math/big&amp;#34; &amp;#34;net&amp;#34; &amp;#34;time&amp;#34; ) // CA ca type CA struct { caInfo *x509.Certificate caPrivKey *rsa.PrivateKey caPem, caKeyPem []byte } // GetCAPem get ca pem bytes func (c *CA) GetCAPem() ([]byte, error) { if c.caPem == nil { // create the CA caBytes, err := x509.CreateCertificate(rand.Reader, c.caInfo, c.</description></item><item><title/><link>https://blog.poneding.com/go/go-linkname/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-linkname/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / go:linkname æŒ‡ä»¤
go:linkname æŒ‡ä»¤ # èƒŒæ™¯ # é˜…è¯» Golang æºç æ—¶ï¼Œå‘ç°åœ¨æ ‡å‡†åº“ time.Sleep æ–¹æ³•æ²¡æœ‰æ²¡æœ‰æ–¹æ³•ä½“ã€‚å¦‚ä¸‹ï¼š
// Sleep pauses the current goroutine for at least the duration d. // A negative or zero duration causes Sleep to return immediately. func Sleep(d Duration) å½“æˆ‘ä»¬ç›´æ¥åœ¨ä»£ç ä¸­å†™ä¸€ä¸ªç©ºæ–¹æ³• func Foo()ï¼Œç¼–è¯‘æ—¶ä¼šæŠ¥é”™ï¼šmissing function bodyã€‚æ‰€ä»¥æ ‡å‡†åº“ä½¿ç”¨äº†ä»€ä¹ˆé­”æ³•æ¥å®ç°ç©ºæ–¹æ³•çš„å‘¢ï¼Ÿ è¿›ä¸€æ­¥ç ”ç©¶ï¼Œå¾—çŸ¥ time.Sleep è¿è¡Œæ—¶å®é™…è°ƒç”¨äº† runtime.timeSleepæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š
// timeSleep puts the current goroutine to sleep for at least ns nanoseconds. // //go:linkname timeSleep time.</description></item><item><title/><link>https://blog.poneding.com/go/go-list-to-tree/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-list-to-tree/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang åˆ—è¡¨è½¬æ ‘
Golang åˆ—è¡¨è½¬æ ‘ # åœºæ™¯ä»‹ç» # ä»æ•°æ®åº“è·å–åˆ°äº†èœå•åˆ—è¡¨æ•°æ®ï¼Œè¿™äº›èœå•æ•°æ®é€šè¿‡å­—æ®µ ParentID è¡¨ç¤ºçˆ¶å­å±‚çº§å…³ç³»ï¼Œç°åœ¨éœ€è¦å°†èœå•åˆ—è¡¨æ•°æ®è½¬æˆæ ‘çŠ¶çš„å®ä¾‹å¯¹è±¡ã€‚
æ•°æ®åº“å–å‡ºçš„åˆå§‹æ•°æ®ï¼š
raw := []Menu{ {Name: &amp;#34;ä¸€çº§èœå• 1&amp;#34;, ID: 1, PID: 0}, {Name: &amp;#34;ä¸€çº§èœå• 2&amp;#34;, ID: 2, PID: 0}, {Name: &amp;#34;ä¸€çº§èœå• 3&amp;#34;, ID: 3, PID: 0}, {Name: &amp;#34;äºŒçº§èœå• 1-1&amp;#34;, ID: 11, PID: 1}, {Name: &amp;#34;äºŒçº§èœå• 1-2&amp;#34;, ID: 12, PID: 1}, {Name: &amp;#34;äºŒçº§èœå• 1-3&amp;#34;, ID: 13, PID: 1}, {Name: &amp;#34;äºŒçº§èœå• 2-1&amp;#34;, ID: 21, PID: 2}, {Name: &amp;#34;äºŒçº§èœå• 2-2&amp;#34;, ID: 22, PID: 2}, {Name: &amp;#34;äºŒçº§èœå• 2-3&amp;#34;, ID: 23, PID: 2}, } éœ€è¦å¾—åˆ°çš„ç›®æ ‡æ•°æ®ï¼š</description></item><item><title/><link>https://blog.poneding.com/go/go-mtls/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-mtls/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å®ç°åŒå‘è®¤è¯
Golang å®ç°åŒå‘è®¤è¯ # TLS # ä¼ è¾“å±‚å®‰å…¨åè®®ï¼ˆTLSï¼‰ï¼Œåœ¨äº’è”ç½‘ä¸Šï¼Œé€šå¸¸æ˜¯ç”±æœåŠ¡å™¨å•å‘çš„å‘å®¢æˆ·ç«¯æä¾›è¯ä¹¦ï¼Œä»¥è¯æ˜å…¶èº«ä»½ã€‚
mTLS # åŒå‘ TLS è®¤è¯ï¼Œæ˜¯æŒ‡åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä½¿ç”¨åŒè¡ŒåŠ å¯†é€šé“ï¼ŒmTLS æ˜¯äº‘åŸç”Ÿåº”ç”¨ä¸­å¸¸ç”¨çš„é€šä¿¡å®‰å…¨åè®®ã€‚
ä½¿ç”¨åŒå‘TLSè¿æ¥çš„ä¸»è¦ç›®çš„æ˜¯å½“æœåŠ¡å™¨åº”è¯¥åªæ¥å—æ¥è‡ªæœ‰é™çš„å…è®¸çš„å®¢æˆ·ç«¯çš„ TLS è¿æ¥æ—¶ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç»„ç»‡å¸Œæœ›å°†æœåŠ¡å™¨çš„ TLS è¿æ¥é™åˆ¶ä¸ºåªæ¥è‡ªè¯¥ç»„ç»‡çš„åˆæ³•åˆä½œä¼™ä¼´æˆ–å®¢æˆ·ã€‚æ˜¾ç„¶ï¼Œä¸ºå®¢æˆ·ç«¯æ·»åŠ IPç™½åå•ä¸æ˜¯ä¸€ä¸ªå¥½çš„å®‰å…¨å®è·µï¼Œå› ä¸ºIPå¯èƒ½è¢«æ¬ºéª—ã€‚
ä¸ºäº†ç®€åŒ– mTLS æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¿™æ ·ç®€å•æ¢³ç†ï¼š
å®¢æˆ·ç«¯å‘é€è®¿é—®æœåŠ¡å™¨ä¸Šå—ä¿æŠ¤ä¿¡æ¯çš„è¯·æ±‚ï¼› æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æä¾›å…¬é’¥è¯ä¹¦ï¼› å®¢æˆ·ç«¯é€šè¿‡ä½¿ç”¨ CA çš„å…¬é’¥æ¥éªŒè¯æœåŠ¡å™¨å…¬é’¥è¯ä¹¦çš„æ•°å­—ç­¾åï¼Œä»¥éªŒè¯æœåŠ¡å™¨çš„è¯ä¹¦ï¼› å¦‚æœæ­¥éª¤ 3 æˆåŠŸï¼Œå®¢æˆ·æœºå°†å…¶å®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦å‘é€åˆ°æœåŠ¡å™¨ï¼› æœåŠ¡å™¨ä½¿ç”¨æ­¥éª¤ 3 ä¸­ç›¸åŒçš„æ–¹æ³•éªŒè¯å®¢æˆ·æœºçš„è¯ä¹¦ï¼› å¦‚æœæˆåŠŸï¼ŒæœåŠ¡å™¨å°†å¯¹å—ä¿æŠ¤ä¿¡æ¯çš„è®¿é—®æƒæˆäºˆå®¢æˆ·æœºã€‚ ä»£ç å®ç° # éœ€è¦å®ç°å®¢æˆ·ç«¯éªŒè¯æœåŠ¡ç«¯çš„å…¬é’¥è¯ä¹¦ï¼ŒæœåŠ¡ç«¯éªŒè¯å®¢æˆ·ç«¯çš„å…¬é’¥è¯ä¹¦ã€‚
ç”Ÿæˆè¯ä¹¦ # echo &amp;#39;æ¸…ç†å¹¶ç”Ÿæˆç›®å½•&amp;#39; OUT=./certs DAYS=365 RSALEN=2048 CN=poneding rm -rf ${OUT}/* mkdir ${OUT} &amp;gt;&amp;gt; /dev/null 2&amp;gt;&amp;amp;1 cd ${OUT} echo &amp;#39;ç”ŸæˆCAçš„ç§é’¥&amp;#39; openssl genrsa -out ca.key ${RSALEN} &amp;gt;&amp;gt; /dev/null 2&amp;gt;&amp;amp;1 echo &amp;#39;ç”ŸæˆCAçš„ç­¾åè¯ä¹¦&amp;#39; openssl req -new \ -x509 \ -key ca.</description></item><item><title/><link>https://blog.poneding.com/go/go-publish-package-01/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-publish-package-01/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å‘å¸ƒç±»åº“ - 1
Golang å‘å¸ƒç±»åº“ - 1 # æœ¬é¡µä»‹ç»å¦‚ä½•åœ¨ Github ä¸Šå‘å¸ƒæˆ‘ä»¬è‡ªå·±çš„ Golang ç±»åº“ã€‚
1ã€åˆ›å»º github ä»“åº“æ‰˜ç®¡ go ç±»åº“ä»£ç ï¼Œä¾‹å¦‚ common-goï¼šï¼š
2ã€å°†ä»“åº“å…‹éš†è‡³æœ¬åœ°ï¼šï¼š
git clone https://github.com/poneding/common-go.git 3ã€åˆå§‹åŒ–goç±»åº“çš„moduleï¼šï¼š
cd common-go go mod init github.com/poneding/common-go mkdir hello æ³¨æ„ï¼š
ä½¿ç”¨ go env å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å¼€å¯ go-module åŠŸèƒ½ï¼Œå¦‚æœæ²¡å¼€å¯éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ï¼šgo env -w GO111MODULE=onï¼›
module åç§°éœ€è¦ä¸ github ä»“åº“ä¸€è‡´ï¼Œè¿™æ ·å…¶ä»–äººæ‰èƒ½é€šè¿‡ go get github.com/poneding/commmon-go ä¸‹è½½åˆ°ä½ çš„ç±»åº“ã€‚
4ã€ç¼–å†™ go ç±»åº“ä»£ç ï¼Œä¾‹å¦‚ï¼šï¼š
hell/hello.goï¼š
package hello import &amp;#34;fmt&amp;#34; func Say(name string) { fmt.</description></item><item><title/><link>https://blog.poneding.com/go/go-publish-package-02/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-publish-package-02/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang å‘å¸ƒç±»åº“ - 2
Golang å‘å¸ƒç±»åº“ - 2 # æœ¬é¡µä»‹ç»å¦‚ä½•åœ¨ Github ä¸Šå‡çº§æˆ‘ä»¬å·²å‘å¸ƒçš„ Golang ç±»åº“ã€‚
Go ç±»åº“ç‰ˆæœ¬è§„åˆ™ # go ç±»åº“ç‰ˆæœ¬çš„è§„åˆ™ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·ï¼Œå…¶ä¸­ï¼š
ä¸»ç‰ˆæœ¬å·ï¼šç±»åº“è¿›è¡Œäº†ä¸å¯å‘ä¸‹å…¼å®¹çš„ä¿®æ”¹ï¼Œä¾‹å¦‚åŠŸèƒ½é‡æ„ï¼Œè¿™æ—¶å€™ä¸»ç‰ˆæœ¬å·å¾€ä¸Šè¿½åŠ ï¼› æ¬¡ç‰ˆæœ¬å·ï¼šç±»åº“è¿›è¡Œäº†å¯å‘ä¸‹å…¼å®¹çš„ä¿®æ”¹ï¼Œä¾‹å¦‚æ–°å¢åŠŸèƒ½ï¼Œè¿™æ—¶å€™æ¬¡ç‰ˆæœ¬å·å¾€ä¸Šè¿½åŠ ï¼› ä¿®è®¢å·ï¼šç±»åº“è¿›è¡Œäº†å¯å‘ä¸‹å…¼å®¹çš„ä¿®æ”¹ï¼ˆä¿®æ”¹çš„è§„æ¨¡æ›´å°ï¼‰ï¼Œä¾‹å¦‚ä¿®å¤æˆ–ä¼˜åŒ–åŠŸèƒ½ï¼Œè¿™æ—¶å€™ä¿®è®¢å¥½å¾€ä¸Šè¿½åŠ ã€‚ Go ç±»åº“å‘ç‰ˆç¤ºä¾‹ # åŒæ ·ä»¥ github.com/poneding/common-go ç±»åº“ä¸ºç¤ºä¾‹ã€‚
å°ç‰ˆæœ¬å‡çº§ # ä¸»ç‰ˆæœ¬ä¸å‡çº§ï¼Œæ¬¡ç‰ˆæœ¬æˆ–ä¿®è®¢ç‰ˆæœ¬å‡çº§ã€‚
v0.x.x ç‰ˆæœ¬å‡çº§è‡³ v1.x.x ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥å‡çº§çš„ã€‚
å½“å‰ç‰ˆæœ¬æ˜¯ v1.0.0ï¼Œç°å¯¹è¯¥ç±»åº“è¿›è¡Œäº†åŠŸèƒ½ä¿®æ”¹ï¼Œå‘å¸ƒ v1.0.1 ç‰ˆæœ¬ï¼š
1ã€åˆ‡æ¢è‡³ v1 åˆ†æ”¯ï¼š
git checkout v1 2ã€ä¿®æ”¹ç±»åº“ä»£ç ï¼š
hello/hello.goï¼š
package hello import &amp;#34;fmt&amp;#34; func Say(name string) { fmt.Printf(&amp;#34;Hello, %s\n&amp;#34;, name) fmt.Println(&amp;#34;common-go version: v1.0.1&amp;#34;) } 3ã€æäº¤ä»£ç å¹¶å‘å¸ƒï¼š</description></item><item><title/><link>https://blog.poneding.com/go/go-solid/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-solid/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Go ç¨‹åº SOLID è®¾è®¡åŸåˆ™
Go ç¨‹åº SOLID è®¾è®¡åŸåˆ™ # å¯é‡ç”¨è½¯ä»¶è®¾è®¡çš„äº”ä¸ªåŸåˆ™ï¼ŒSOLID åŸåˆ™ï¼š
å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principleï¼‰ å¼€æ”¾ / å°é—­åŸåˆ™ï¼ˆOpen / Closed Principleï¼‰ é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼‰ æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼‰ ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversion Principleï¼‰ å•ä¸€èŒè´£åŸåˆ™ # SOLID çš„ç¬¬ä¸€ä¸ªåŸåˆ™ï¼ŒSï¼Œæ˜¯å•ä¸€è´£ä»»åŸåˆ™ã€‚
A class should have one, and only one, reason to change. â€“ Robert C Martin
ç°åœ¨ Go æ˜¾ç„¶æ²¡æœ‰ classses - ç›¸åï¼Œæˆ‘ä»¬æœ‰æ›´å¼ºå¤§çš„ç»„åˆæ¦‚å¿µ - ä½†æ˜¯å¦‚æœä½ èƒ½å›é¡¾ä¸€ä¸‹ class è¿™ä¸ªè¯çš„ç”¨æ³•ï¼Œæˆ‘è®¤ä¸ºæ­¤æ—¶ä¼šæœ‰ä¸€å®šä»·å€¼ã€‚
ä¸ºä»€ä¹ˆä¸€æ®µä»£ç åªæœ‰ä¸€ä¸ªæ”¹å˜çš„åŸå› å¾ˆé‡è¦ï¼Ÿå—¯ï¼Œå°±åƒä½ è‡ªå·±çš„ä»£ç å¯èƒ½ä¼šæ”¹å˜ä¸€æ ·ä»¤äººæ²®ä¸§ï¼Œå‘ç°æ‚¨çš„ä»£ç æ‰€ä¾èµ–çš„ä»£ç åœ¨æ‚¨è„šä¸‹å‘ç”Ÿå˜åŒ–æ›´ç—›è‹¦ã€‚å½“ä½ çš„ä»£ç å¿…é¡»æ”¹å˜æ—¶ï¼Œå®ƒåº”è¯¥å“åº”ç›´æ¥åˆºæ¿€ä½œå‡ºæ”¹å˜ï¼Œè€Œä¸åº”è¯¥æˆä¸ºé™„å¸¦æŸå®³çš„å—å®³è€…ã€‚
å› æ­¤ï¼Œå…·æœ‰å•ä¸€è´£ä»»çš„ä»£ç ä¿®æ”¹çš„åŸå› æœ€å°‘ã€‚
è€¦åˆå’Œå†…èš # æè¿°æ”¹å˜ä¸€ä¸ªè½¯ä»¶æ˜¯å¤šä¹ˆå®¹æ˜“æˆ–å›°éš¾çš„ä¸¤ä¸ªè¯æ˜¯ï¼šè€¦åˆå’Œå†…èšã€‚</description></item><item><title/><link>https://blog.poneding.com/go/go-stdlib/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-stdlib/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang æ ‡å‡†åº“
Golang æ ‡å‡†åº“ # fmt # æ ¼å¼åŒ–æ‰“å°
%v åŸæ ·è¾“å‡º %T æ‰“å°ç±»å‹ %t bool %s string %f float %d 10è¿›åˆ¶æ•´æ•° %b 2è¿›åˆ¶æ•´æ•° %o 8è¿›åˆ¶æ•´æ•° %x 16è¿›åˆ¶æ•´æ•° 0-9ï¼Œa-f %X 16è¿›åˆ¶æ•´æ•° 0-9ï¼ŒA-F %c char %p pointer %.2f float ä¿ç•™ä¸¤ä½ path # file := &amp;#34;./logs/2021-01-25/error.log&amp;#34; fileName := path.Base(file) # è¿”å›æ–‡ä»¶åï¼šerror.log fileExt := path.Ext(file) # è¿”å›æ–‡ä»¶åç¼€ï¼š.log fileDir := path.Dir(file) # è¿”å›æ–‡ä»¶è·¯å¾„ï¼š ./logs/2021-01-25 os/exec # Golangè¯­è¨€æœ‰ä¸€ä¸ªåŒ…å«åš os/execï¼Œä½¿ç”¨è¯¥åŒ…å¯ä»¥ç›´æ¥åœ¨ç¨‹åºä¸­è°ƒç”¨ä¸»æœºçš„å‘½ä»¤ï¼Œä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š
func OsExecUsage() error { fmt.</description></item><item><title/><link>https://blog.poneding.com/go/go-testing/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go-testing/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / testing
testing # å‘½ä»¤ # æµ‹è¯•
go test -run=TestCompare -v . è¿è¡Œæµ‹è¯•ï¼Œæµ‹è¯•å‡½æ•°åç§°ä¸­ä»…åŒ…å« TestCompare å‰ç¼€ã€‚
åˆ—å‡ºåŒ…å†…æµ‹è¯•æ–‡ä»¶
go list -f={{.GoTestFiles}} . åˆ—å‡ºåŒ…å¤–æµ‹è¯•æ–‡ä»¶
go list -f={{.XTestGoFiles}} . åŒ…å†…æµ‹è¯•ï¼šæµ‹è¯•æ–‡ä»¶çš„åŒ…åç§°ä¸è¢«æµ‹åŒ…ä¸€è‡´ï¼Œå¯ä»¥è®¿é—®è¢«æµ‹åŒ…å†…æ‰€æœ‰æˆå‘˜ï¼Œç›¸å½“äºç™½ç›’æµ‹è¯•ï¼›
åŒ…å¤–æµ‹è¯•ï¼šæµ‹è¯•æ–‡ä»¶çš„åŒ…åç§°ä¸è¢«æµ‹åŒ…ä¸ä¸€è‡´ï¼Œä¸€èˆ¬åœ¨è¢«æµ‹åŒ…åç§°åé¢æ·»åŠ  _test åç¼€ï¼Œåªèƒ½è®¿é—®è¢«æµ‹åŒ…å†…å…¬å¼€æˆå‘˜ï¼Œç›¸å½“äºé»‘ç›’æµ‹è¯•ã€‚
Â« Golang æ ‡å‡†åº“
Â» Golang</description></item><item><title/><link>https://blog.poneding.com/go/go/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/go/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Golang
Golang # èµ„æ–™ # Go å®‰å…¨æŒ‡å— Go è¯­è¨€ç¼–ç¨‹è§„èŒƒ Golang channel # golang å®ç°å¹¶å‘æ˜¯é€šè¿‡é€šä¿¡å…±äº«å†…å­˜ï¼Œchannel æ˜¯ go è¯­è¨€ä¸­goroutine çš„é€šä¿¡ç®¡é“ï¼Œé€šè¿‡ channel å°†å€¼ä»ä¸€ä¸ª goroutine å‘é€åˆ°å¦ä¸€ä¸ª goroutineã€‚
è¯­æ³• # åˆ›å»º channelï¼š
ä½¿ç”¨ make() å‡½æ•°åˆ›å»ºï¼š
ch := make(chan int) é»˜è®¤åˆ›å»ºä¸€ä¸ªæ— ç¼“å­˜ channelã€‚
å‘é€æ•°æ®åˆ° channelï¼š
ch &amp;lt;- x ä» channel è¯»å–æ•°æ®ï¼š
x := &amp;lt;-ch å…³é—­ channelï¼š
ä½¿ç”¨ close() å‡½æ•°å…³é—­ï¼š
close(ch) å½“ä½ çš„ç¨‹åºä¸å†éœ€è¦å¾€ channel ä¸­å‘é€æ•°æ®æ—¶ï¼Œå¯ä»¥å…³é—­ channelã€‚
å¦‚æœå¾€å·²ç»å…³é—­çš„ channal å‘é€æ•°æ®ï¼Œç¨‹åºå‘ç”Ÿå¼‚å¸¸ã€‚
æ— ç¼“å†² channel # å¦‚æœå½“å‰æ²¡æœ‰ä¸€ä¸ª goroutine å¯¹æ— ç¼“å†² channel æ¥æ”¶æ•°æ®ï¼Œé‚£ä¹ˆæ— ç¼“å†² channel ä¼šé˜»æ­¢å‘é€æ•°æ®ã€‚</description></item><item><title/><link>https://blog.poneding.com/go/gopkg-errors/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/gopkg-errors/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / gopkg-errors.md
title: Go åŒ… - errors date: 2022-10-19T14:44:06+08:00 lastmod: 2022-11-03T03:32:31.646Z tags:
Golang gopkg keywords: Golang gopkg errors weight: 1 errors åŒ…ä¸ºä½ çš„ Go ç¨‹åºæä¾›ä¸€ç§å¯¹ç¨‹åºå‘˜è°ƒè¯•ã€æŸ¥çœ‹æ—¥å¿—æ›´å‹å¥½çš„é”™è¯¯å¤„ç†æ–¹å¼ã€‚
Go ç¨‹åºä¸­ä¼ ç»Ÿçš„é”™è¯¯å¤„ç†æ–¹æ³•ï¼š
if err != nil { return err } é€’å½’çš„å‘ä¸Šä¼ é€’é”™è¯¯ï¼Œè¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªç¼ºé™·ï¼šæœ€ç»ˆå¤„ç†é”™è¯¯çš„ä½ç½®æ— æ³•è·å–é”™è¯¯çš„è°ƒç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚
errors åŒ…ä»¥ä¸ç ´åé”™è¯¯çš„åŸå§‹å€¼çš„æ–¹å¼å‘é”™è¯¯ä¸­çš„æ·»åŠ è°ƒç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚
è·å–åŒ… # go get github.com/pkg/errors é”™è¯¯æ·»åŠ ä¸Šä¸‹æ–‡ # The errors.Wrap function returns a new error that adds context to the original error. For example
_, err := ioutil.ReadAll(r) if err !</description></item><item><title/><link>https://blog.poneding.com/go/goreleaser/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/goreleaser/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Goreleaser
Goreleaser # Go ç¨‹åºé¡¹ç›®çš„è‡ªåŠ¨åŒ–å‘å¸ƒå·¥å…·ï¼Œç®€å•çš„å‘å¸ƒå‘½ä»¤å¸®åŠ©æˆ‘ä»¬çœå»å¤§é‡çš„é‡å¤å·¥ä½œã€‚
å®‰è£… # MacOsï¼š
brew install goreleaser/tap/goreleaser æºç ç¼–è¯‘ï¼š
git clone https://github.com/goreleaser/goreleaser cd goreleaser go get ./... go build -o goreleaser . ./goreleaser --version åˆå§‹åŒ– # åœ¨goé¡¹ç›®ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç”Ÿæˆ.goreleaser.ymlæ–‡ä»¶ï¼š
goreleaser init ç”Ÿæˆæ–‡ä»¶åï¼Œè‡ªè¡Œé…ç½®ï¼Œç›¸ä¿¡ä½ èƒ½çœ‹çš„æ‡‚ã€‚
éªŒè¯ .goreleaser.yml # goreleaser check ä½¿ç”¨æœ¬åœ°ç¯å¢ƒæ„å»º
goreleaser build --single-target é…ç½® github token # token å¿…é¡»è‡³å°‘åŒ…å« write:package æƒé™ï¼Œæ‰èƒ½ä¸Šä¼ åˆ°å‘å¸ƒèµ„æºä¸­ã€‚
ä»githubç”Ÿæˆtokenï¼Œå†™å…¥æ–‡ä»¶ï¼š
mkdir ~/.config/goreleaser vim ~/.config/goreleaser/github_token æˆ–è€…ç›´æ¥åœ¨ç»ˆç«¯å¯¼å…¥ç¯å¢ƒé…ç½®ï¼š
export GITHUB_TOKEN=&amp;#34;YOUR_GITHUB_TOKEN&amp;#34; ä¸ºé¡¹ç›®æ‰“ä¸Š tag # git tag v0.</description></item><item><title/><link>https://blog.poneding.com/go/mac-appl-silicon-cross-compile-cgo/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/mac-appl-silicon-cross-compile-cgo/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / Mac M1 äº¤å‰ç¼–è¯‘ CGO
Mac M1 äº¤å‰ç¼–è¯‘ CGO # æ–¹æ³•ä¸€ # 1ã€å®‰è£…ä¾èµ–
brew tap messense/macos-cross-toolchains brew install x86_64-unknown-linux-gnu brew install aarch64-unknown-linux-gnu 2ã€æ·»åŠ åˆ° PATH
export PATH=$PATH:/opt/homebrew/Cellar/x86_64-unknown-linux-gnu/11.2.0_1/bin::/opt/homebrew/Cellar/aarch64-unknown-linux-gnu/11.2.0_1/bin 3ã€ç¼–è¯‘ CGO ç¨‹åº
CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-unknown-linux-gnu-gcc CXX=x86_64-unknown-linux-gnu-g++ go build CGO_ENABLED=1 GOOS=linux GOARCH=arm64 CC=aarch64-unknown-linux-gnu-gcc CXX=aarch64-unknown-linux-gnu-g++ go build æ–¹æ³•äºŒ # 1ã€å®‰è£…ä¾èµ–
brew install FiloSottile/musl-cross/musl-cross 2ã€æ·»åŠ åˆ° PATH
export PATH=$PATH:/opt/homebrew/Cellar/musl-cross/0.9.9_1/bin 3ã€ç¼–è¯‘ CGO ç¨‹åº
# -tags=musl ä¸èƒ½çœç•¥ä¸ç„¶ä¼šå‡ºç°å…¶ä»–é”™è¯¯ CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-linux-musl-gcc CXX=x86_64-linux-musl-g++ go build -tags=musl # å¦‚æœlinuxä¸æƒ³å®‰è£…muslæ”¯æŒ CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-linux-musl-gcc CXX=x86_64-linux-musl-g++ CGO_LDFLAGS=&amp;#34;-static&amp;#34; go build -tags=musl CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-linux-musl-gcc CGO_LDFLAGS=&amp;#34;-static&amp;#34; go build CGO_ENABLED=1 GOOS=linux GOARCH=arm64 CC=x86_64-linux-musl-gcc CGO_LDFLAGS=&amp;#34;-static&amp;#34; go build å‚è€ƒ # https://blog.</description></item><item><title/><link>https://blog.poneding.com/go/pprof/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/pprof/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / pprof
pprof # pprof æ˜¯æ€§èƒ½è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥ç”Ÿæˆç±»ä¼¼ç«ç„°å›¾ã€å †æ ˆå›¾ï¼Œå†…å­˜åˆ†æå›¾ç­‰ã€‚
package main import ( &amp;#34;fmt&amp;#34; &amp;#34;math/rand&amp;#34; &amp;#34;net/http&amp;#34; &amp;#34;time&amp;#34; _ &amp;#34;net/http/pprof&amp;#34; ) // åƒå†…å­˜ type Eater struct { Name string Buffer [][]int } var e Eater func main() { e = Eater{Name: &amp;#34;eater&amp;#34;} http.HandleFunc(&amp;#34;/go&amp;#34;, goHandler) http.ListenAndServe(&amp;#34;:8080&amp;#34;, nil) // å¦‚æœä¸ä½¿ç”¨é»˜è®¤çš„ muxï¼ˆhttp.DefaultServeMuxï¼‰ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼é›†æˆ pprof // mux := http.NewServeMux() // mux.HandleFunc(&amp;#34;/go&amp;#34;, goHandler) // mux.HandleFunc(&amp;#34;/debug/pprof/&amp;#34;, pprof.Index) // mux.HandleFunc(&amp;#34;/debug/pprof/cmdline&amp;#34;, pprof.Cmdline) // mux.HandleFunc(&amp;#34;/debug/pprof/profile&amp;#34;, pprof.Profile) // mux.HandleFunc(&amp;#34;/debug/pprof/symbol&amp;#34;, pprof.</description></item><item><title/><link>https://blog.poneding.com/go/ssh-keygen-with-go/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://blog.poneding.com/go/ssh-keygen-with-go/</guid><description>ğŸ  é¦–é¡µ / Golang ç¼–ç¨‹ / ä½¿ç”¨ Go ç”Ÿæˆ OpenSSH å…¼å®¹çš„ RSA å¯†é’¥å¯¹
ä½¿ç”¨ Go ç”Ÿæˆ OpenSSH å…¼å®¹çš„ RSA å¯†é’¥å¯¹ # æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ssh-keygen å‘½ä»¤ç”Ÿæˆä¸€å¯¹ç”¨äº SSH è®¿é—®çš„ç§é’¥å’Œå…¬é’¥ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Go ç”Ÿæˆä¸€å¯¹ OpenSSH å…¼å®¹çš„ RSA å¯†é’¥å¯¹ã€‚
ä»¥ä¸‹ä»£ç ä¸­ GenOpenSSHKeyPair æ–¹æ³•ç”¨äºç”Ÿæˆä¸€å¯¹ç”¨äº SSH è®¿é—®çš„ç§é’¥å’Œå…¬é’¥ã€‚ç”Ÿæˆçš„ç§é’¥ä»¥ PEM ç¼–ç ï¼Œå…¬é’¥ä»¥ OpenSSH authorized_keys æ–‡ä»¶ä¸­åŒ…å«çš„æ ¼å¼è¿›è¡Œç¼–ç ã€‚
package util import ( &amp;#34;crypto/rand&amp;#34; &amp;#34;crypto/rsa&amp;#34; &amp;#34;crypto/x509&amp;#34; &amp;#34;encoding/pem&amp;#34; &amp;#34;golang.org/x/crypto/ssh&amp;#34; ) // GenOpenSSHKeyPair make a pair of private and public keys for SSH access. // Private Key generated is PEM encoded // Public key is encoded in the format for inclusion in an OpenSSH authorized_keys file.</description></item></channel></rss>